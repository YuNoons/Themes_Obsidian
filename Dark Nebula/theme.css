/* ==========================================================================
   Расширенная цветовая система Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

:root {
  /* ==================== ОСНОВНЫЕ ЦВЕТА ФОНА ==================== */
  --background-primary: #1a0b1f !important;
  --background-primary-alt: #160916 !important;
  --background-secondary: #250b0b !important;
  --background-secondary-alt: #1f0814 !important;
  
  /* ==================== ДИНАМИЧЕСКИЕ ЦВЕТОВЫЕ СХЕМЫ ==================== */
  
  /* Основная неоновая схема (по умолчанию) */
  --color-scheme-primary: neon !important;
  --accent-hue-primary: 335 !important;  /* Розовый */
  --accent-hue-secondary: 190 !important; /* Голубой */
  --accent-hue-tertiary: 270 !important;  /* Фиолетовый */
  
  /* Теплая схема */
  [data-color-scheme="warm"] {
    --accent-hue-primary: 25 !important;   /* Оранжевый */
    --accent-hue-secondary: 45 !important;  /* Желтый */
    --accent-hue-tertiary: 350 !important;  /* Красный */
  }
  
  /* Холодная схема */
  [data-color-scheme="cool"] {
    --accent-hue-primary: 200 !important;   /* Синий */
    --accent-hue-secondary: 160 !important;  /* Бирюзовый */
    --accent-hue-tertiary: 280 !important;   /* Пурпурный */
  }
  
  /* Монохромная схема для фокуса */
  [data-color-scheme="monochrome"] {
    --accent-hue-primary: 0 !important;
    --accent-hue-secondary: 0 !important;
    --accent-hue-tertiary: 0 !important;
    --accent-saturation: 0% !important;
  }
}

/* ==================== ДИНАМИЧЕСКАЯ ГЕНЕРАЦИЯ ЦВЕТОВ ==================== */

:root {
  /* Основные акцентные цвета на основе HSL */
  --accent-primary: hsl(var(--accent-hue-primary), 100%, 65%) !important;
  --accent-secondary: hsl(var(--accent-hue-secondary), 100%, 75%) !important;
  --accent-tertiary: hsl(var(--accent-hue-tertiary), 80%, 70%) !important;
  
  /* Полутона акцентных цветов */
  --accent-primary-10: hsl(var(--accent-hue-primary), 100%, 10%) !important;
  --accent-primary-20: hsl(var(--accent-hue-primary), 100%, 20%) !important;
  --accent-primary-40: hsl(var(--accent-hue-primary), 100%, 40%) !important;
  --accent-primary-60: hsl(var(--accent-hue-primary), 100%, 60%) !important;
  --accent-primary-80: hsl(var(--accent-hue-primary), 100%, 80%) !important;
  
  /* Адаптивные цвета текста */
  --text-dynamic-normal: oklch(95% 0.02 var(--accent-hue-primary)) !important;
  --text-dynamic-muted: oklch(75% 0.03 var(--accent-hue-primary)) !important;
  --text-dynamic-faint: oklch(55% 0.03 var(--accent-hue-primary)) !important;
}

/* ==================== СЕМАНТИЧЕСКИЕ ЦВЕТА ==================== */

:root {
  /* Система статусов */
  --semantic-success: #6bff8e !important;
  --semantic-warning: #ffd16b !important;
  --semantic-error: #ff6b6b !important;
  --semantic-info: #a3eeff !important;
  
  /* Состояния интерактивных элементов */
  --state-hover: color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  --state-active: color-mix(in oklch, var(--accent-primary), transparent 60%) !important;
  --state-focus: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  --state-disabled: color-mix(in oklch, var(--text-normal), transparent 70%) !important;
}

/* ==================== ГРАДИЕНТЫ И ЭФФЕКТЫ ==================== */

:root {
  /* Основные градиенты */
  --gradient-primary: linear-gradient(
    135deg,
    var(--accent-primary),
    var(--accent-secondary),
    var(--accent-tertiary)
  ) !important;
  
  --gradient-background: linear-gradient(
    135deg,
    var(--background-primary),
    var(--background-primary-alt),
    var(--background-secondary)
  ) !important;
  
  /* Неоновые эффекты */
  --neon-glow-primary: 
    0 0 5px color-mix(in oklch, var(--accent-primary), transparent 50%),
    0 0 10px color-mix(in oklch, var(--accent-primary), transparent 70%),
    0 0 15px color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
    
  --neon-glow-secondary: 
    0 0 3px color-mix(in oklch, var(--accent-secondary), transparent 60%),
    0 0 6px color-mix(in oklch, var(--accent-secondary), transparent 70%) !important;
}

/* ==================== АДАПТИВНЫЕ ЦВЕТА ДЛЯ РАЗНЫХ РЕЖИМОВ ==================== */

/* Режим чтения */
[data-mode="reading"] {
  --background-primary: oklch(15% 0.02 var(--accent-hue-primary)) !important;
  --text-normal: oklch(95% 0.01 var(--accent-hue-primary)) !important;
  --accent-primary: oklch(75% 0.1 var(--accent-hue-primary)) !important;
}

/* Ночной режим с красным смещением */
[data-mode="night"] {
  --background-primary: #0f0515 !important;
  --accent-primary: hsl(15, 80%, 60%) !important; /* Теплый красный */
  filter: sepia(0.3) hue-rotate(-10deg) !important;
}

/* Режим высокой контрастности */
[data-contrast="high"] {
  --background-primary: #000000 !important;
  --background-primary-alt: #111111 !important;
  --text-normal: #ffffff !important;
  --accent-primary: #ffff00 !important;
}

/* ==================== СИСТЕМА ЦВЕТОВ ДЛЯ ТИПОВ КОНТЕНТА ==================== */

:root {
  /* Цвета для разных типов заметок */
  --content-type-note: var(--accent-primary) !important;
  --content-type-research: var(--accent-secondary) !important;
  --content-type-project: var(--accent-tertiary) !important;
  --content-type-reference: var(--semantic-info) !important;
  --content-type-archive: var(--text-muted) !important;
  
  /* Цвета для тегов */
  --tag-color-default: var(--accent-primary) !important;
  --tag-color-important: var(--semantic-error) !important;
  --tag-color-in-progress: var(--semantic-warning) !important;
  --tag-color-completed: var(--semantic-success) !important;
  --tag-color-idea: var(--semantic-info) !important;
}

/* ==================== ДИНАМИЧЕСКАЯ АДАПТАЦИЯ К ОКРУЖЕНИЮ ==================== */

/* Адаптация к времени суток */
@media (prefers-color-scheme: light) {
  :root {
    --background-primary: oklch(95% 0.02 var(--accent-hue-primary)) !important;
    --text-normal: oklch(15% 0.05 var(--accent-hue-primary)) !important;
  }
}

/* Адаптация к окружающему освещению */
@media (prefers-contrast: more) {
  :root {
    --background-primary: #000000 !important;
    --text-normal: #ffffff !important;
  }
}

@media (prefers-contrast: less) {
  :root {
    --background-primary: oklch(25% 0.02 var(--accent-hue-primary)) !important;
    --text-normal: oklch(85% 0.02 var(--accent-hue-primary)) !important;
  }
}

/* ==================== УТИЛИТЫ ДЛЯ ЦВЕТОВ ==================== */

/* Утилитарные классы для цветов */
.color-primary { color: var(--accent-primary) !important; }
.color-secondary { color: var(--accent-secondary) !important; }
.color-tertiary { color: var(--accent-tertiary) !important; }

.bg-primary { background-color: var(--accent-primary) !important; }
.bg-secondary { background-color: var(--accent-secondary) !important; }
.bg-tertiary { background-color: var(--accent-tertiary) !important; }

.bg-gradient-primary { background: var(--gradient-primary) !important; }
.bg-gradient-background { background: var(--gradient-background) !important; }

/* Состояния */
.text-hover:hover { color: color-mix(in oklch, currentColor, var(--accent-primary) 30%) !important; }
.bg-hover:hover { background-color: var(--state-hover) !important; }

/* Семантические утилиты */
.text-success { color: var(--semantic-success) !important; }
.text-warning { color: var(--semantic-warning) !important; }
.text-error { color: var(--semantic-error) !important; }
.text-info { color: var(--semantic-info) !important; }

.bg-success { background-color: color-mix(in oklch, var(--semantic-success), transparent 90%) !important; }
.bg-warning { background-color: color-mix(in oklch, var(--semantic-warning), transparent 90%) !important; }
.bg-error { background-color: color-mix(in oklch, var(--semantic-error), transparent 90%) !important; }
.bg-info { background-color: color-mix(in oklch, var(--semantic-info), transparent 90%) !important; }

/* ==================== АНИМАЦИИ ЦВЕТОВ ==================== */

@keyframes color-cycle {
  0% { color: var(--accent-primary); }
  33% { color: var(--accent-secondary); }
  66% { color: var(--accent-tertiary); }
  100% { color: var(--accent-primary); }
}

@keyframes background-pulse {
  0%, 100% { background-color: var(--background-primary); }
  50% { background-color: color-mix(in oklch, var(--background-primary), var(--accent-primary) 5%); }
}

.color-cycle {
  animation: color-cycle 6s ease-in-out infinite !important;
}

.background-pulse {
  animation: background-pulse 4s ease-in-out infinite !important;
}

/* ==================== МАСШТАБИРУЕМОСТЬ ДЛЯ БУДУЩИХ ОБНОВЛЕНИЙ ==================== */

/* CSS-переменные для будущих расширений */
:root {
  /* Поддержка новых цветовых пространств */
  --color-space: oklch !important;
  --color-gamut: p3 !important;
  
  /* Подготовка для будущих функций CSS */
  --color-mix-amount: 20% !important;
  --color-contrast-ratio: 4.5 !important;
  
  /* Система версионирования цветов */
  --color-schema-version: 2.1 !important;
}

/* Миксины для будущих улучшений */
@property --accent-hue-primary {
  syntax: '<number>';
  inherits: true;
  initial-value: 335;
}

@property --accent-saturation {
  syntax: '<percentage>';
  inherits: true;
  initial-value: 100%;
}

/* Поддержка HDR цветов */
@media (dynamic-range: high) {
  :root {
    --accent-primary: color(display-p3 1 0.4 0.6) !important;
    --accent-secondary: color(display-p3 0.4 0.9 1) !important;
  }
}

/* ==========================================================================
   Конец расширенной цветовой системы
   ========================================================================== */
   
   /* ==========================================================================
   Умная рабочая область Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== АДАПТИВНАЯ СИСТЕМА МАКЕТОВ ==================== */

.workspace {
  /* Базовые переменные макета */
  --layout-spacing: 8px !important;
  --layout-border-radius: 8px !important;
  --layout-transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  
  /* Система z-index для слоев */
  --z-index-background: 0 !important;
  --z-index-content: 10 !important;
  --z-index-overlay: 100 !important;
  --z-index-modal: 1000 !important;
  --z-index-tooltip: 10000 !important;
}

/* ==================== УМНОЕ СКРЫТИЕ ИНТЕРФЕЙСА ==================== */

/* Авто-скрытие панелей при бездействии */
.workspace:not(.cursor-moving) .workspace-tabs:not(:hover) {
  opacity: 0.3 !important;
  transform: translateX(-5px) !important;
  transition: var(--layout-transition) !important;
}

.workspace:not(.cursor-moving) .workspace-leaf:not(:hover) .view-header {
  opacity: 0.5 !important;
  transform: translateY(-10px) !important;
}

/* Режим глубокой фокусировки */
[data-focus-mode="deep"] {
  --sidebar-opacity: 0.1 !important;
  --header-opacity: 0.2 !important;
}

[data-focus-mode="deep"] .workspace-tabs,
[data-focus-mode="deep"] .status-bar {
  opacity: var(--sidebar-opacity) !important;
  transition: opacity 0.5s ease !important;
}

[data-focus-mode="deep"] .workspace-tabs:hover,
[data-focus-mode="deep"] .status-bar:hover {
  opacity: 1 !important;
}

/* ==================== РЕЖИМЫ РАБОЧЕЙ ОБЛАСТИ ==================== */

/* Режим письма */
[data-workspace-mode="writing"] {
  --sidebar-width: 0px !important;
  --header-height: 0px !important;
}

[data-workspace-mode="writing"] .workspace-split.mod-root > .workspace-leaf {
  max-width: 800px !important;
  margin: 0 auto !important;
  padding: 40px 20px !important;
}

/* Режим чтения */
[data-workspace-mode="reading"] {
  --background-primary: oklch(98% 0.01 var(--accent-hue-primary)) !important;
  --text-normal: oklch(15% 0.02 var(--accent-hue-primary)) !important;
}

[data-workspace-mode="reading"] .workspace-leaf-content {
  font-family: "Georgia", "Times New Roman", serif !important;
  line-height: 1.8 !important;
  font-size: 18px !important;
}

/* Режим презентации */
[data-workspace-mode="presentation"] {
  --background-primary: #000000 !important;
  --text-normal: #ffffff !important;
}

[data-workspace-mode="presentation"] .workspace-leaf {
  background: transparent !important;
}

[data-workspace-mode="presentation"] .markdown-preview-view {
  text-align: center !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: center !important;
  min-height: 100vh !important;
}

/* ==================== УЛУЧШЕННАЯ СИСТЕМА ВКЛАДОК ==================== */

.workspace-tab-header {
  /* Базовые стили */
  background: color-mix(in oklch, var(--background-primary), var(--accent-primary) 5%) !important;
  border: 1px solid transparent !important;
  border-radius: var(--layout-border-radius) var(--layout-border-radius) 0 0 !important;
  padding: 12px 20px !important;
  margin: 0 2px !important;
  position: relative !important;
  transition: var(--layout-transition) !important;
  
  /* Индикатор состояния */
  &::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 2px !important;
    background: var(--gradient-primary) !important;
    opacity: 0 !important;
    transition: opacity 0.3s ease !important;
  }
}

.workspace-tab-header:hover {
  background: color-mix(in oklch, var(--background-primary), var(--accent-primary) 10%) !important;
  border-color: color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  transform: translateY(-2px) !important;
  
  &::before {
    opacity: 1 !important;
  }
}

.workspace-tab-header.is-active {
  background: color-mix(in oklch, var(--background-primary), var(--accent-primary) 15%) !important;
  border-color: var(--accent-primary) !important;
  color: var(--accent-primary) !important;
  
  &::before {
    opacity: 1 !important;
    animation: tab-glow 2s ease-in-out infinite !important;
  }
}

@keyframes tab-glow {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

/* ==================== АДАПТИВНЫЕ ПАНЕЛИ ИНСТРУМЕНТОВ ==================== */

.workspace-leaf-resize-handle {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  transition: all 0.3s ease !important;
  position: relative !important;
  
  &:hover {
    background: var(--accent-primary) !important;
    box-shadow: var(--neon-glow-primary) !important;
  }
  
  &::after {
    content: '' !important;
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 4px !important;
    height: 20px !important;
    background: currentColor !important;
    border-radius: 2px !important;
    opacity: 0.5 !important;
  }
}

/* ==================== СИСТЕМА БЫСТРЫХ КОМАНД ==================== */

.quick-access-panel {
  background: color-mix(in oklch, var(--background-primary), black 10%) !important;
  backdrop-filter: blur(20px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: 16px !important;
  box-shadow: 
    0 20px 40px rgba(0, 0, 0, 0.5),
    var(--neon-glow-primary) !important;
}

.quick-access-item {
  padding: 12px 16px !important;
  margin: 4px !important;
  border-radius: 8px !important;
  transition: var(--layout-transition) !important;
  border: 1px solid transparent !important;
  
  &:hover {
    background: var(--state-hover) !important;
    border-color: color-mix(in oklch, var(--accent-primary), transparent 50%) !important;
    transform: translateX(8px) !important;
  }
  
  &.is-selected {
    background: var(--state-active) !important;
    border-color: var(--accent-primary) !important;
    box-shadow: var(--neon-glow-secondary) !important;
  }
}

/* ==================== РАСШИРЕННАЯ НАВИГАЦИЯ ==================== */

.view-header {
  background: color-mix(in oklch, var(--background-primary), transparent 30%) !important;
  backdrop-filter: blur(10px) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  padding: 12px 20px !important;
  transition: var(--layout-transition) !important;
}

.view-header-title-container {
  font-weight: 600 !important;
  font-size: 1.1em !important;
  color: var(--accent-primary) !important;
}

.view-actions {
  gap: 8px !important;
}

.view-action {
  width: 32px !important;
  height: 32px !important;
  border-radius: 6px !important;
  transition: var(--layout-transition) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  
  &:hover {
    background: var(--state-hover) !important;
    transform: scale(1.1) !important;
    box-shadow: var(--neon-glow-secondary) !important;
  }
}

/* ==================== СИСТЕМА ЖЕСТОВ И АНИМАЦИЙ ==================== */

/* Анимации переключения вкладок */
.workspace-tab-container {
  animation: slideInUp 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Параллакс эффекты */
.workspace-leaf-content {
  transform-style: preserve-3d !important;
  perspective: 1000px !important;
}

.workspace-leaf:not(.mod-active) .workspace-leaf-content {
  transform: translateZ(-10px) scale(0.98) !important;
  opacity: 0.8 !important;
  transition: var(--layout-transition) !important;
}

/* ==================== АДАПТИВНЫЕ МАКЕТЫ ДЛЯ РАЗНЫХ ЭКРАНОВ ==================== */

@media (max-width: 768px) {
  .workspace-tab-header {
    padding: 8px 12px !important;
    font-size: 14px !important;
    margin: 0 1px !important;
  }
  
  .view-header {
    padding: 8px 12px !important;
    flex-wrap: wrap !important;
  }
  
  .view-actions {
    order: -1 !important;
    width: 100% !important;
    justify-content: center !important;
    margin-bottom: 8px !important;
  }
}

@media (max-width: 480px) {
  .workspace-split.mod-horizontal {
    flex-direction: column !important;
  }
  
  .workspace-leaf {
    min-height: 50vh !important;
  }
  
  .workspace-tab-header {
    font-size: 12px !important;
    padding: 6px 8px !important;
  }
}

/* ==================== СИСТЕМА СОСТОЯНИЙ И ИНДИКАТОРОВ ==================== */

/* Индикатор загрузки */
.workspace-loading::before {
  content: '' !important;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  height: 3px !important;
  background: var(--gradient-primary) !important;
  z-index: var(--z-index-tooltip) !important;
  animation: loading-bar 2s ease-in-out infinite !important;
}

@keyframes loading-bar {
  0% { transform: translateX(-100%); }
  50% { transform: translateX(0); }
  100% { transform: translateX(100%); }
}

/* Индикатор изменений */
.workspace-leaf.mod-dirty .view-header-icon::after {
  content: '●' !important;
  color: var(--semantic-warning) !important;
  font-size: 12px !important;
  position: absolute !important;
  top: -2px !important;
  right: -2px !important;
  animation: pulse 2s infinite !important;
}

/* ==================== КОНТЕКСТНЫЕ РАБОЧИЕ ПРОСТРАНСТВА ==================== */

[data-workspace-context="research"] {
  --accent-primary: var(--accent-secondary) !important;
}

[data-workspace-context="development"] {
  --accent-primary: var(--semantic-info) !important;
}

[data-workspace-context="planning"] {
  --accent-primary: var(--semantic-warning) !important;
}

[data-workspace-context="writing"] {
  --accent-primary: var(--accent-tertiary) !important;
}

/* ==================== МАСШТАБИРУЕМОСТЬ ДЛЯ БУДУЩИХ ОБНОВЛЕНИЙ ==================== */

/* CSS-переменные для будущих функций */
.workspace {
  --layout-grid: 8px !important;
  --layout-breakpoint-sm: 640px !important;
  --layout-breakpoint-md: 768px !important;
  --layout-breakpoint-lg: 1024px !important;
  --layout-breakpoint-xl: 1280px !important;
  
  /* Подготовка для контейнерных запросов */
  --container-type: inline-size !important;
}

/* Контейнерные запросы для адаптивных макетов */
@container (max-width: 400px) {
  .workspace-tab-header {
    padding: 6px 8px !important;
    font-size: 12px !important;
  }
}

/* Поддержка будущих CSS-функций */
@supports (scroll-timeline: --workspace-scroll) {
  .workspace {
    scroll-timeline: --workspace-scroll !important;
    animation-timeline: --workspace-scroll !important;
  }
}

/* Система тем для рабочих пространств */
.workspace[data-theme-version="2.1"] {
  --compatibility-mode: true !important;
}

/* ==================== УТИЛИТЫ ДЛЯ РАБОЧЕЙ ОБЛАСТИ ==================== */

/* Утилиты скрытия */
.hide-ui .workspace-tabs,
.hide-ui .status-bar,
.hide-ui .view-header {
  opacity: 0.1 !important;
  transition: opacity 0.3s ease !important;
}

.hide-ui .workspace-tabs:hover,
.hide-ui .status-bar:hover,
.hide-ui .view-header:hover {
  opacity: 1 !important;
}

/* Утилиты макета */
.layout-vertical { flex-direction: column !important; }
.layout-horizontal { flex-direction: row !important; }
.layout-grid { display: grid !important; }

/* Утилиты анимаций */
.animate-slide-in { animation: slideInUp 0.3s ease !important; }
.animate-fade-in { animation: fadeIn 0.3s ease !important; }
.animate-scale-in { animation: scaleIn 0.3s ease !important; }

/* ==========================================================================
   Конец умной рабочей области
   ========================================================================== */
   
   /* ==========================================================================
   Умный редактор и система просмотра Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== АДАПТИВНАЯ СИСТЕМА РЕДАКТОРА ==================== */

.cm-editor {
  /* Базовые переменные редактора */
  --editor-font-size: 15px !important;
  --editor-line-height: 1.7 !important;
  --editor-max-width: 800px !important;
  --editor-gutter-width: 60px !important;
  
  /* Система состояний редактора */
  --editor-state-normal: var(--background-primary) !important;
  --editor-state-focus: color-mix(in oklch, var(--background-primary), var(--accent-primary) 3%) !important;
  --editor-state-active: color-mix(in oklch, var(--background-primary), var(--accent-primary) 5%) !important;
  
  background: var(--editor-state-normal) !important;
  transition: background-color 0.3s ease !important;
}

.cm-editor.cm-focused {
  background: var(--editor-state-focus) !important;
}

/* ==================== УМНАЯ ТИПОГРАФИКА ДЛЯ ЧТЕНИЯ ==================== */

.markdown-preview-view,
.cm-content {
  /* Научно обоснованная типографика */
  font-size: var(--editor-font-size) !important;
  line-height: var(--editor-line-height) !important;
  max-width: var(--editor-max-width) !important;
  margin: 0 auto !important;
  padding: 40px 20px !important;
  
  /* Оптимальная длина строки для чтения */
  text-wrap: pretty !important;
  hyphenate-limit-chars: 6 3 3 !important;
  hyphenate-limit-lines: 2 !important;
  hyphenate-limit-zone: 8% !important;
}

/* Режим оптимального чтения */
[data-reading-mode="optimal"] .markdown-preview-view {
  font-family: "Inter", "SF Pro Text", system-ui !important;
  font-size: 17px !important;
  line-height: 1.75 !important;
  letter-spacing: -0.01em !important;
}

/* ==================== ДИНАМИЧЕСКАЯ СЕТКА ДОКУМЕНТА ==================== */

.cm-content,
.markdown-preview-section {
  /* CSS Grid для структуры документа */
  display: grid !important;
  grid-template-columns: 
    [full-start] minmax(20px, 1fr)
    [content-start] min(100%, var(--editor-max-width))
    [content-end] minmax(20px, 1fr)
    [full-end] !important;
}

.cm-line,
.markdown-preview-view > * {
  grid-column: content !important;
}

/* Широкие элементы (код, таблицы) */
.cm-codeBlock,
.markdown-preview-view pre,
.markdown-preview-view table {
  grid-column: full !important;
  width: 100% !important;
}

/* ==================== УЛУЧШЕННАЯ ПОДСВЕТКА СИНТАКСИСА ==================== */

.cm-editor {
  /* Расширенная система токенов для CodeMirror 6 */
  --token-comment: color-mix(in oklch, var(--text-muted), transparent 30%) !important;
  --token-keyword: color-mix(in oklch, var(--accent-primary), white 20%) !important;
  --token-string: color-mix(in oklch, var(--semantic-success), white 10%) !important;
  --token-number: color-mix(in oklch, var(--accent-tertiary), white 15%) !important;
  --token-function: color-mix(in oklch, var(--accent-secondary), white 10%) !important;
  --token-operator: color-mix(in oklch, var(--text-normal), transparent 20%) !important;
}

/* Кастомные темы для разных языков */
[data-code-theme="dark-nebula"] .cm-token {
  transition: all 0.2s ease !important;
}

.cm-comment { color: var(--token-comment) !important; font-style: italic !important; }
.cm-keyword { color: var(--token-keyword) !important; font-weight: 600 !important; }
.cm-string { color: var(--token-string) !important; }
.cm-string2 { color: color-mix(in oklch, var(--token-string), white 20%) !important; }
.cm-number { color: var(--token-number) !important; font-weight: 600 !important; }
.cm-def { color: var(--token-function) !important; }
.cm-property { color: var(--token-function) !important; }
.cm-operator { color: var(--token-operator) !important; }

/* ==================== ИНТЕЛЛЕКТУАЛЬНЫЕ СТИЛИ ДЛЯ ЭЛЕМЕНТОВ ==================== */

/* Адаптивные заголовки с прогресс-индикаторами */
.cm-header-1,
.markdown-preview-view h1 {
  color: var(--accent-primary) !important;
  font-size: 2.2em !important;
  font-weight: 800 !important;
  line-height: 1.2 !important;
  margin: 1.8em 0 0.6em 0 !important;
  padding-bottom: 0.4em !important;
  border-bottom: 2px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  position: relative !important;
  
  &::after {
    content: '' !important;
    position: absolute !important;
    bottom: -2px !important;
    left: 0 !important;
    width: var(--scroll-progress, 0%) !important;
    height: 2px !important;
    background: var(--gradient-primary) !important;
    transition: width 0.3s ease !important;
  }
}

/* Умные блоки кода с определением языка */
.cm-codeBlock,
.markdown-preview-view pre {
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: 12px !important;
  padding: 24px !important;
  margin: 28px 0 !important;
  position: relative !important;
  overflow: hidden !important;
  
  &::before {
    content: attr(data-language) !important;
    position: absolute !important;
    top: 0 !important;
    right: 0 !important;
    background: var(--accent-primary) !important;
    color: white !important;
    padding: 4px 12px !important;
    font-size: 0.7em !important;
    font-weight: 600 !important;
    border-bottom-left-radius: 8px !important;
    text-transform: uppercase !important;
    letter-spacing: 0.05em !important;
  }
}

/* ==================== СИСТЕМА ФОКУСА И ВНИМАНИЯ ==================== */

/* Режим "лазерного фокуса" для текущего элемента */
.cm-activeLine {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  border-left: 3px solid var(--accent-primary) !important;
  margin-left: -3px !important;
  transition: all 0.3s ease !important;
}

/* Подсветка текущего структурного блока */
.cm-foldPlaceholder {
  background: color-mix(in oklch, var(--accent-secondary), transparent 90%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-secondary), transparent 70%) !important;
  border-radius: 6px !important;
  color: var(--accent-secondary) !important;
}

/* ==================== АДАПТИВНЫЕ РЕЖИМЫ ПРОСМОТРА ==================== */

/* Режим черновика - только сырой текст */
[data-view-mode="draft"] .cm-editor {
  --editor-font-size: 16px !important;
  --editor-line-height: 1.8 !important;
  font-family: "SF Mono", "Monaco", monospace !important;
}

[data-view-mode="draft"] .cm-formatting {
  opacity: 0.3 !important;
}

/* Режим редактуры - выделение структуры */
[data-view-mode="editing"] .cm-header {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  border-radius: 4px !important;
  padding: 2px 4px !important;
}

[data-view-mode="editing"] .cm-link {
  border-bottom: 2px dotted color-mix(in oklch, var(--accent-secondary), transparent 50%) !important;
}

/* ==================== ИНТЕЛЛЕКТУАЛЬНЫЕ ИНСТРУМЕНТЫ ПРОСМОТРА ==================== */

/* Система навигации по заголовкам */
.markdown-preview-view {
  scroll-behavior: smooth !important;
  scroll-padding-top: 80px !important;
}

/* Интерактивные оглавления */
.outline .tree-item {
  position: relative !important;
  padding-left: 20px !important;
  transition: all 0.2s ease !important;
  
  &::before {
    content: '' !important;
    position: absolute !important;
    left: 0 !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    width: 4px !important;
    height: 4px !important;
    background: var(--accent-primary) !important;
    border-radius: 50% !important;
    opacity: 0.5 !important;
    transition: all 0.2s ease !important;
  }
  
  &:hover::before {
    opacity: 1 !important;
    transform: translateY(-50%) scale(1.5) !important;
  }
}

/* ==================== РАСШИРЕННАЯ СИСТЕМА КОДОВЫХ БЛОКОВ ==================== */

/* Интерактивные блоки кода */
.markdown-preview-view pre {
  position: relative !important;
  
  &::after {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 1px !important;
    background: var(--gradient-primary) !important;
    opacity: 0.7 !important;
  }
}

/* Кнопка копирования кода */
.code-block-copy-button {
  position: absolute !important;
  top: 12px !important;
  right: 12px !important;
  background: color-mix(in oklch, var(--background-primary), white 10%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: 6px !important;
  padding: 6px 12px !important;
  font-size: 0.8em !important;
  color: var(--text-normal) !important;
  cursor: pointer !important;
  opacity: 0 !important;
  transition: all 0.3s ease !important;
  z-index: 10 !important;
  
  &:hover {
    background: var(--accent-primary) !important;
    color: white !important;
    transform: translateY(-1px) !important;
  }
}

.markdown-preview-view pre:hover .code-block-copy-button {
  opacity: 1 !important;
}

/* ==================== АДАПТИВНЫЕ ТАБЛИЦЫ И СЛОЖНЫЕ СТРУКТУРЫ ==================== */

.markdown-preview-view table {
  background: color-mix(in oklch, var(--background-primary), transparent 20%) !important;
  backdrop-filter: blur(10px) !important;
  border-radius: 12px !important;
  overflow: hidden !important;
  box-shadow: 
    0 4px 20px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 color-mix(in oklch, white, transparent 95%) !important;
}

.markdown-preview-view th {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  font-weight: 700 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
  font-size: 0.85em !important;
}

/* ==================== СИСТЕМА АНИМАЦИЙ И ПЕРЕХОДОВ ==================== */

/* Плавные переходы между режимами */
.cm-editor,
.markdown-preview-view {
  view-transition-name: document-content !important;
}

@view-transition {
  navigation: auto !important;
}

/* Анимации появления контента */
.cm-line,
.markdown-preview-view > * {
  animation: fadeInUp 0.6s ease-out var(--stagger-delay, 0ms) both !important;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ==================== МАСШТАБИРУЕМОСТЬ ДЛЯ БУДУЩИХ ВЕРСИЙ ==================== */

/* Подготовка для будущих CSS-функций */
.cm-editor {
  --css-nesting: true !important;
  --css-cascade: true !important;
  --text-wrap-balance: experimental !important;
}

/* Поддержка Container Queries для адаптивного редактора */
@container editor (max-width: 600px) {
  .cm-content {
    --editor-font-size: 16px !important;
    --editor-line-height: 1.8 !important;
    padding: 20px 10px !important;
  }
  
  .cm-codeBlock,
  .markdown-preview-view pre {
    padding: 16px !important;
    margin: 20px -10px !important;
    border-radius: 8px !important;
  }
}

/* Подготовка для CSS Modules будущего */
.cm-editor {
  --module-editor: true !important;
  --module-preview: true !important;
}

/* Система тем для разных типов контента */
[data-content-type="code"] .cm-editor {
  --accent-primary: var(--semantic-info) !important;
}

[data-content-type="writing"] .cm-editor {
  --accent-primary: var(--accent-tertiary) !important;
}

[data-content-type="research"] .cm-editor {
  --accent-primary: var(--accent-secondary) !important;
}

/* ==================== ПРОИЗВОДИТЕЛЬНОСТЬ И ОПТИМИЗАЦИЯ ==================== */

/* Оптимизация для больших документов */
.cm-editor .cm-line {
  content-visibility: auto !important;
  contain-intrinsic-size: 1px 1.7em !important;
}

.markdown-preview-view > * {
  content-visibility: auto !important;
  contain-intrinsic-size: 1px 4em !important;
}

/* Отложенная загрузка тяжелых стилей */
@media (prefers-reduced-motion: no-preference) {
  .cm-editor {
    scroll-behavior: smooth !important;
  }
}

/* ==================== УТИЛИТЫ ДЛЯ РАЗРАБОТЧИКОВ ==================== */

/* Режим отладки стилей */
[data-debug-styles="true"] .cm-line {
  outline: 1px solid color-mix(in oklch, red, transparent 80%) !important;
}

[data-debug-styles="true"] .markdown-preview-view > * {
  outline: 1px solid color-mix(in oklch, blue, transparent 80%) !important;
}

/* Утилиты для тестирования */
.test-content-warning {
  background: color-mix(in oklch, var(--semantic-warning), transparent 90%) !important;
  border: 1px solid var(--semantic-warning) !important;
  border-radius: 6px !important;
  padding: 8px 12px !important;
  margin: 16px 0 !important;
}

/* ==========================================================================
   Конец умного редактора и системы просмотра
   ========================================================================== */
   
   /* ==========================================================================
   Универсальная система интеграции плагинов Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== УНИВЕРСАЛЬНАЯ СИСТЕМА ПЛАГИНОВ ==================== */

:root {
  /* Стандартизированные переменные для плагинов */
  --plugin-spacing: 12px !important;
  --plugin-border-radius: 8px !important;
  --plugin-shadow: 0 4px 20px rgba(0, 0, 0, 0.15) !important;
  --plugin-background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  
  /* Система нейминга для плагинов */
  --plugin-namespace: 'dn-plugin' !important;
  --plugin-version: '2.1' !important;
}

/* ==================== CALENDAR ПЛАГИН - РАСШИРЕННАЯ ИНТЕГРАЦИЯ ==================== */

.calendar {
  --calendar-primary: var(--accent-primary) !important;
  --calendar-background: var(--plugin-background) !important;
  --calendar-border: color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
}

.workspace-leaf-content[data-type="calendar"] {
  background: var(--calendar-background) !important;
  backdrop-filter: blur(10px) !important;
  border-radius: var(--plugin-border-radius) !important;
}

.calendar .day {
  border: 1px solid var(--calendar-border) !important;
  border-radius: 6px !important;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  position: relative !important;
  overflow: hidden !important;
  
  &::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background: var(--gradient-primary) !important;
    opacity: 0 !important;
    transition: opacity 0.3s ease !important;
  }
}

.calendar .day.today {
  border-color: var(--calendar-primary) !important;
  box-shadow: var(--neon-glow-secondary) !important;
  
  &::before {
    opacity: 0.1 !important;
  }
}

.calendar .day.has-note {
  background: color-mix(in oklch, var(--calendar-primary), transparent 95%) !important;
  
  &::after {
    content: '' !important;
    position: absolute !important;
    bottom: 2px !important;
    right: 2px !important;
    width: 4px !important;
    height: 4px !important;
    background: var(--calendar-primary) !important;
    border-radius: 50% !important;
  }
}

/* Умная интеграция с ежедневными заметками */
.calendar .day.active {
  background: color-mix(in oklch, var(--calendar-primary), transparent 90%) !important;
  transform: scale(1.05) !important;
  z-index: 2 !important;
}

/* ==================== KANBAN ПЛАГИН - ПРОДВИНУТАЯ СТИЛИЗАЦИЯ ==================== */

.kanban-plugin {
  --kanban-board-bg: var(--plugin-background) !important;
  --kanban-column-bg: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  --kanban-card-bg: color-mix(in oklch, var(--background-primary), white 3%) !important;
  --kanban-accent: var(--accent-primary) !important;
}

.kanban-plugin__board {
  background: var(--kanban-board-bg) !important;
  backdrop-filter: blur(15px) !important;
  border-radius: 16px !important;
  padding: 20px !important;
  gap: 16px !important;
}

.kanban-plugin__lane {
  background: var(--kanban-column-bg) !important;
  border: 1px solid color-mix(in oklch, var(--kanban-accent), transparent 90%) !important;
  border-radius: 12px !important;
  padding: 16px !important;
  min-width: 280px !important;
  transition: all 0.3s ease !important;
  
  &:hover {
    border-color: color-mix(in oklch, var(--kanban-accent), transparent 70%) !important;
    transform: translateY(-2px) !important;
  }
}

.kanban-plugin__lane-header {
  color: var(--kanban-accent) !important;
  font-weight: 700 !important;
  font-size: 1.1em !important;
  margin-bottom: 12px !important;
  padding-bottom: 8px !important;
  border-bottom: 2px solid color-mix(in oklch, var(--kanban-accent), transparent 80%) !important;
}

.kanban-plugin__item {
  background: var(--kanban-card-bg) !important;
  border: 1px solid color-mix(in oklch, var(--kanban-accent), transparent 95%) !important;
  border-radius: 8px !important;
  padding: 12px !important;
  margin-bottom: 8px !important;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  cursor: grab !important;
  
  &:hover {
    border-color: color-mix(in oklch, var(--kanban-accent), transparent 80%) !important;
    box-shadow: var(--plugin-shadow) !important;
    transform: translateY(-1px) !important;
  }
  
  &:active {
    cursor: grabbing !important;
    transform: rotate(2deg) !important;
  }
}

/* Drag-and-drop визуальные улучшения */
.kanban-plugin__item.is-dragging {
  transform: rotate(5deg) scale(1.02) !important;
  box-shadow: 
    0 10px 30px rgba(0, 0, 0, 0.3),
    var(--neon-glow-primary) !important;
  z-index: 1000 !important;
}

.kanban-plugin__lane.drop-zone {
  background: color-mix(in oklch, var(--kanban-accent), transparent 95%) !important;
  border: 2px dashed var(--kanban-accent) !important;
}

/* ==================== DATAVIEW ПЛАГИН - УМНЫЕ ТАБЛИЦЫ И СПИСКИ ==================== */

.dataview {
  --dataview-table-bg: var(--plugin-background) !important;
  --dataview-row-alt: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  --dataview-accent: var(--accent-secondary) !important;
}

.dataview.table-view-table {
  background: var(--dataview-table-bg) !important;
  backdrop-filter: blur(10px) !important;
  border-radius: 12px !important;
  overflow: hidden !important;
  box-shadow: var(--plugin-shadow) !important;
}

.dataview.table-view-table > thead > tr > th {
  background: color-mix(in oklch, var(--dataview-accent), transparent 95%) !important;
  color: var(--dataview-accent) !important;
  font-weight: 700 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
  font-size: 0.85em !important;
  border-bottom: 2px solid color-mix(in oklch, var(--dataview-accent), transparent 70%) !important;
}

.dataview.table-view-table > tbody > tr:nth-child(even) {
  background: var(--dataview-row-alt) !important;
}

.dataview.table-view-table > tbody > tr:hover {
  background: color-mix(in oklch, var(--dataview-accent), transparent 98%) !important;
  transform: scale(1.01) !important;
  transition: all 0.2s ease !important;
}

/* Карточки Dataview */
.dataview.list-view-ul {
  display: grid !important;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)) !important;
  gap: 16px !important;
}

.dataview.list-view-li {
  background: var(--plugin-background) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: 12px !important;
  padding: 16px !important;
  transition: all 0.3s ease !important;
  
  &:hover {
    border-color: color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
    transform: translateY(-2px) !important;
    box-shadow: var(--plugin-shadow) !important;
  }
}

/* ==================== TASKS ПЛАГИН - ИНТЕЛЛЕКТУАЛЬНОЕ УПРАВЛЕНИЕ ==================== */

.tasks-plugin {
  --task-priority-high: var(--semantic-error) !important;
  --task-priority-medium: var(--semantic-warning) !important;
  --task-priority-low: var(--semantic-info) !important;
  --task-completed: var(--semantic-success) !important;
}

.tasks-list-item {
  padding: 8px 12px !important;
  margin: 4px 0 !important;
  border-radius: 6px !important;
  border-left: 3px solid transparent !important;
  transition: all 0.3s ease !important;
  
  &:hover {
    background: color-mix(in oklch, var(--accent-primary), transparent 97%) !important;
    transform: translateX(4px) !important;
  }
}

/* Приоритеты задач */
.tasks-list-item[data-task-priority="high"] {
  border-left-color: var(--task-priority-high) !important;
  background: color-mix(in oklch, var(--task-priority-high), transparent 98%) !important;
}

.tasks-list-item[data-task-priority="medium"] {
  border-left-color: var(--task-priority-medium) !important;
}

.tasks-list-item[data-task-priority="low"] {
  border-left-color: var(--task-priority-low) !important;
}

/* Выполненные задачи */
.tasks-list-item[data-task-status="done"] {
  opacity: 0.7 !important;
  text-decoration: line-through !important;
  border-left-color: var(--task-completed) !important;
  
  &::before {
    content: "✓ " !important;
    color: var(--task-completed) !important;
    font-weight: bold !important;
  }
}

/* ==================== EXCALIDRAW ПЛАГИН - ТЕМНАЯ ТЕМА ДЛЯ РИСОВАНИЯ ==================== */

.workspace-leaf-content[data-type="excalidraw"] {
  background: #1a1a1a !important; /* Темный фон для рисования */
}

.excalidraw-wrapper {
  --theme-filter: invert(0.9) hue-rotate(180deg) contrast(1.2) !important;
}

.excalidraw .App-menu_top .Stack .Island {
  background: color-mix(in oklch, #1a1a1a, white 5%) !important;
  backdrop-filter: blur(10px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
}

/* ==================== VARIOUS COMPLEMENTS - НЕНАВЯЗЧИВЫЕ ПОДСКАЗКИ ==================== */

.suggest-box {
  background: color-mix(in oklch, var(--background-primary), black 10%) !important;
  backdrop-filter: blur(20px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 60%) !important;
  border-radius: 12px !important;
  box-shadow: 
    0 20px 40px rgba(0, 0, 0, 0.3),
    var(--neon-glow-primary) !important;
}

.suggest-item {
  padding: 8px 16px !important;
  border-radius: 6px !important;
  transition: all 0.2s ease !important;
  
  &:hover, &.selected {
    background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
    transform: translateX(4px) !important;
  }
}

/* ==================== УНИВЕРСАЛЬНАЯ СИСТЕМА ДЛЯ НОВЫХ ПЛАГИНОВ ==================== */

/* Автоматическое применение стилей к неизвестным плагинам */
.workspace-leaf-content:not([data-type="markdown"]):not([data-type="file-explorer"]):not([data-type*="known"]) {
  background: var(--plugin-background) !important;
  backdrop-filter: blur(5px) !important;
  border-radius: var(--plugin-border-radius) !important;
  
  & .view-header {
    background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
    border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  }
}

/* Система нейминга для кастомных плагинов */
[class*="plugin-"] {
  /* Автоматическое применение базовых стилей */
  background: var(--plugin-background) !important;
  border-radius: var(--plugin-border-radius) !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ПЛАГИНОВ ==================== */

/* CSS-переменные для будущих расширений */
:root {
  --plugin-api-version: '2.1' !important;
  --plugin-stylesheet-version: '1.0' !important;
  --plugin-compatibility-mode: true !important;
}

/* Система регистрации стилей плагинов */
@layer plugins {
  /* Базовые стили для всех плагинов */
  .plugin-base {
    --plugin-version: var(--plugin-api-version) !important;
    --plugin-compatible: true !important;
  }
  
  /* Темы для разных категорий плагинов */
  .plugin-category-productivity {
    --plugin-accent: var(--accent-primary) !important;
  }
  
  .plugin-category-visualization {
    --plugin-accent: var(--accent-secondary) !important;
  }
  
  .plugin-category-development {
    --plugin-accent: var(--semantic-info) !important;
  }
}

/* Поддержка будущих CSS-функций для плагинов */
@supports (selector(:has(*))) {
  .workspace-leaf:has(.plugin-outdated) {
    border: 2px solid var(--semantic-warning) !important;
  }
}

/* Container Queries для адаптивных плагинов */
@container plugin-panel (max-width: 400px) {
  .kanban-plugin__lane {
    min-width: 100% !important;
  }
  
  .dataview.list-view-ul {
    grid-template-columns: 1fr !important;
  }
}

/* ==================== СИСТЕМА ОБНОВЛЕНИЙ И СОВМЕСТИМОСТИ ==================== */

/* Индикатор устаревших плагинов */
.plugin-outdated {
  position: relative !important;
  
  &::before {
    content: '⚠️' !important;
    position: absolute !important;
    top: 8px !important;
    right: 8px !important;
    font-size: 12px !important;
    z-index: 10 !important;
  }
}

/* Режим совместимости для старых плагинов */
[data-plugin-compatibility="legacy"] {
  --plugin-background: var(--background-primary) !important;
  backdrop-filter: none !important;
}

/* ==================== УТИЛИТЫ ДЛЯ РАЗРАБОТЧИКОВ ПЛАГИНОВ ==================== */

/* Режим отладки стилей плагинов */
[data-debug-plugins="true"] [class*="plugin-"] {
  outline: 2px dashed color-mix(in oklch, var(--accent-primary), transparent 50%) !important;
}

/* Визуальные подсказки для разработки */
.plugin-dev-helper {
  background: color-mix(in oklch, var(--semantic-info), transparent 95%) !important;
  border: 1px solid var(--semantic-info) !important;
  border-radius: 6px !important;
  padding: 8px 12px !important;
  margin: 8px 0 !important;
  font-family: monospace !important;
  font-size: 0.9em !important;
}

/* ==================== ПРОИЗВОДИТЕЛЬНОСТЬ И ОПТИМИЗАЦИЯ ==================== */

/* Оптимизация для плагинов с тяжелой графикой */
.workspace-leaf-content[data-type="excalidraw"],
.workspace-leaf-content[data-type*="graph"] {
  contain: layout paint !important;
}

/* Ленивая загрузка стилей для редко используемых плагинов */
.workspace-leaf:not(.mod-active) .plugin-heavy {
  opacity: 0.8 !important;
  filter: blur(0.5px) !important;
  transition: all 0.3s ease !important;
}

/* ==========================================================================
   Конец универсальной системы интеграции плагинов
   ========================================================================== */
   
   /* ==========================================================================
   Универсальная мобильная и адаптивная система Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== АДАПТИВНАЯ СИСТЕМА ПЕРЕМЕННЫХ ==================== */

:root {
  /* Адаптивные единицы измерения */
  --fluid-min-width: 320px !important;
  --fluid-max-width: 1440px !important;
  --fluid-screen: 100vw !important;
  
  /* Адаптивная типографика */
  --fluid-text-min: 14px !important;
  --fluid-text-max: 18px !important;
  --fluid-text-ratio: 1.2 !important;
  
  /* Адаптивные отступы */
  --fluid-space-min: 8px !important;
  --fluid-space-max: 24px !important;
  --fluid-space-ratio: 1.5 !important;
}

/* ==================== FLUID TYPOGRAPHY SYSTEM ==================== */

.cm-editor,
.markdown-preview-view {
  /* Fluid font-size с clamp() */
  font-size: clamp(
    var(--fluid-text-min),
    calc(var(--fluid-text-min) * var(--fluid-text-ratio) + (var(--fluid-text-max) - var(--fluid-text-min)) * ((100vw - var(--fluid-min-width)) / (var(--fluid-max-width) - var(--fluid-min-width)))),
    var(--fluid-text-max)
  ) !important;
  
  /* Fluid line-height */
  line-height: clamp(
    1.5,
    calc(1.5 + (1.8 - 1.5) * ((100vw - 320px) / (1440 - 320))),
    1.8
  ) !important;
}

/* ==================== MOBILE-FIRST BREAKPOINT SYSTEM ==================== */

@custom-media --mobile (width < 480px);
@custom-media --tablet (480px <= width < 768px);
@custom-media --laptop (768px <= width < 1024px);
@custom-media --desktop (width >= 1024px);

/* ==================== MOBILE-OPTIMIZED WORKSPACE ==================== */

/* Мобильная панель навигации */
.mobile-navbar {
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  backdrop-filter: blur(20px) !important;
  border-top: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  padding: 12px 16px !important;
  position: fixed !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  z-index: 1000 !important;
  display: flex !important;
  justify-content: space-around !important;
  align-items: center !important;
}

.mobile-navbar-button {
  background: transparent !important;
  border: none !important;
  color: var(--text-muted) !important;
  padding: 12px !important;
  border-radius: 12px !important;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  position: relative !important;
  min-width: 60px !important;
  
  &:active {
    background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
    transform: scale(0.95) !important;
  }
  
  &.active {
    color: var(--accent-primary) !important;
    
    &::after {
      content: '' !important;
      position: absolute !important;
      bottom: -12px !important;
      left: 50% !important;
      transform: translateX(-50%) !important;
      width: 4px !important;
      height: 4px !important;
      background: var(--accent-primary) !important;
      border-radius: 50% !important;
    }
  }
}

/* ==================== TOUCH-OPTIMIZED INTERFACE ==================== */

/* Увеличенные touch targets */
.mobile-optimized * {
  --touch-target-min: 44px !important;
  min-height: var(--touch-target-min) !important;
  min-width: var(--touch-target-min) !important;
}

/* Touch-friendly кнопки */
.button-touch {
  padding: 16px 24px !important;
  border-radius: 12px !important;
  font-size: 17px !important;
  font-weight: 600 !important;
  
  &:active {
    transform: scale(0.96) !important;
    transition: transform 0.1s ease !important;
  }
}

/* Улучшенная навигация жестами */
.workspace-leaf-content {
  overscroll-behavior: contain !important;
  scroll-snap-type: y proximity !important;
}

.view-header {
  scroll-snap-align: start !important;
}

/* ==================== ADAPTIVE LAYOUT SYSTEM ==================== */

/* Контейнерные запросы для адаптивных компонентов */
.workspace-split {
  container-type: inline-size !important;
  container-name: workspace !important;
}

@container workspace (max-width: 600px) {
  .workspace-split.mod-horizontal {
    flex-direction: column !important;
  }
  
  .workspace-leaf {
    min-height: 50vh !important;
    max-height: 50vh !important;
  }
}

@container workspace (max-width: 400px) {
  .workspace-tab-header {
    padding: 8px 12px !important;
    font-size: 14px !important;
  }
  
  .view-header {
    padding: 8px 12px !important;
    flex-wrap: wrap !important;
  }
}

/* ==================== MOBILE-SPECIFIC ENHANCEMENTS ==================== */

/* Виртуальная клавиатура оптимизация */
.cm-editor.mobile-keyboard-open {
  padding-bottom: 300px !important; /* Space for keyboard */
  transition: padding-bottom 0.3s ease !important;
}

/* Safe area insets для современных устройств */
.mobile-safe {
  padding-top: env(safe-area-inset-top) !important;
  padding-bottom: env(safe-area-inset-bottom) !important;
  padding-left: env(safe-area-inset-left) !important;
  padding-right: env(safe-area-inset-right) !important;
}

/* ==================== ADAPTIVE CONTENT LAYOUT ==================== */

.cm-content,
.markdown-preview-view {
  /* Адаптивная ширина контента */
  max-width: min(100%, 800px) !important;
  margin: 0 auto !important;
  
  /* Адаптивные отступы */
  padding: 
    max(env(safe-area-inset-top), 20px)
    max(env(safe-area-inset-right), 20px)
    max(env(safe-area-inset-bottom), 20px)
    max(env(safe-area-inset-left), 20px) !important;
}

/* Адаптивные таблицы для мобильных */
.markdown-preview-view table {
  display: block !important;
  overflow-x: auto !important;
  white-space: nowrap !important;
  
  @container (max-width: 480px) {
    font-size: 14px !important;
    
    th, td {
      padding: 8px 12px !important;
      min-width: 120px !important;
    }
  }
}

/* ==================== MOBILE-SPECIFIC ANIMATIONS ==================== */

/* Оптимизированные анимации для мобильных */
@media (prefers-reduced-motion: no-preference) {
  .mobile-optimized {
    /* Быстрые переходы для лучшего восприятия */
    transition-duration: 0.2s !important;
    animation-duration: 0.3s !important;
  }
}

/* Haptic feedback simulation */
.button-touch:active {
  animation: haptic-pulse 0.1s ease !important;
}

@keyframes haptic-pulse {
  0% { transform: scale(1); }
  50% { transform: scale(0.98); }
  100% { transform: scale(1); }
}

/* ==================== ADAPTIVE PLUGIN SUPPORT ==================== */

/* Мобильная адаптация плагинов */
@container (max-width: 768px) {
  .kanban-plugin__board {
    grid-template-columns: 1fr !important;
    gap: 12px !important;
    padding: 16px !important;
  }
  
  .kanban-plugin__lane {
    min-width: 100% !important;
  }
  
  .dataview.list-view-ul {
    grid-template-columns: 1fr !important;
  }
  
  .calendar .month {
    grid-template-columns: repeat(7, 1fr) !important;
    gap: 2px !important;
  }
}

/* ==================== ORIENTATION AWARE STYLES ==================== */

/* Портретная ориентация */
@media (orientation: portrait) {
  .workspace-split.mod-horizontal {
    flex-direction: column !important;
  }
  
  .markdown-preview-view {
    font-size: 16px !important;
    line-height: 1.7 !important;
  }
}

/* Ландшафтная ориентация */
@media (orientation: landscape) and (max-height: 500px) {
  .view-header {
    position: sticky !important;
    top: 0 !important;
    z-index: 100 !important;
  }
  
  .mobile-navbar {
    padding: 8px 12px !important;
  }
}

/* ==================== PERFORMANCE OPTIMIZATIONS ==================== */

/* Оптимизация для медленных устройств */
@media (prefers-reduced-motion: reduce) {
  .mobile-optimized * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Оптимизация рендеринга для мобильных */
.mobile-optimized {
  contain: layout style paint !important;
  will-change: transform !important;
}

/* Оптимизация скролла */
.workspace-leaf-content {
  scroll-behavior: smooth !important;
  -webkit-overflow-scrolling: touch !important;
}

/* ==================== ACCESSIBILITY ENHANCEMENTS ==================== */

/* Увеличение контрастности для мобильных */
@media (max-width: 768px) {
  :root {
    --text-normal: oklch(95% 0.02 var(--accent-hue-primary)) !important;
    --text-muted: oklch(75% 0.03 var(--accent-hue-primary)) !important;
  }
}

/* Увеличение размера текста для доступности */
@media (prefers-contrast: more) {
  .mobile-optimized {
    font-size: 18px !important;
    line-height: 1.8 !important;
  }
}

/* ==================== FUTURE-PROOF SCALABILITY ==================== */

/* Подготовка для будущих CSS-функций */
@supports (height: 100dvh) {
  .mobile-optimized {
    height: 100dvh !important;
    width: 100dvw !important;
  }
}

@supports (scroll-timeline: --mobile-scroll) {
  .workspace-leaf-content {
    scroll-timeline: --mobile-scroll !important;
  }
}

/* CSS Nesting для будущей поддержки */
.mobile-optimized {
  & .workspace-tab-header {
    @media (max-width: 480px) {
      padding: 6px 8px !important;
      font-size: 13px !important;
    }
  }
  
  & .view-action {
    @media (max-width: 480px) {
      width: 36px !important;
      height: 36px !important;
    }
  }
}

/* Система тем для разных устройств */
[data-device-type="phone"] {
  --layout-density: compact !important;
  --font-scale: 0.9 !important;
}

[data-device-type="tablet"] {
  --layout-density: comfortable !important;
  --font-scale: 1 !important;
}

[data-device-type="desktop"] {
  --layout-density: spacious !important;
  --font-scale: 1.1 !important;
}

/* ==================== ADAPTIVE UTILITY CLASSES ==================== */

/* Fluid spacing utilities */
.fluid-padding {
  padding: clamp(
    var(--fluid-space-min),
    calc(var(--fluid-space-min) + (var(--fluid-space-max) - var(--fluid-space-min)) * ((100vw - 320px) / (1440 - 320))),
    var(--fluid-space-max)
  ) !important;
}

.fluid-margin {
  margin: clamp(
    var(--fluid-space-min),
    calc(var(--fluid-space-min) + (var(--fluid-space-max) - var(--fluid-space-min)) * ((100vw - 320px) / (1440 - 320))),
    var(--fluid-space-max)
  ) !important;
}

/* Responsive visibility */
.show-mobile { display: none !important; }
.show-tablet { display: none !important; }
.show-desktop { display: block !important; }

@media (max-width: 768px) {
  .show-mobile { display: block !important; }
  .show-desktop { display: none !important; }
}

@media (max-width: 1024px) {
  .show-tablet { display: block !important; }
}

/* Touch interaction states */
.touch-active:active {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  transform: scale(0.98) !important;
}

.touch-hover:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

/* ==================== PROGRESSIVE ENHANCEMENT ==================== */

/* Базовая функциональность для всех устройств */
.mobile-fallback {
  /* Гарантированная работоспособность */
}

/* Улучшения для современных устройств */
@supports (backdrop-filter: blur(10px)) {
  .mobile-enhanced {
    backdrop-filter: blur(20px) !important;
    background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  }
}

/* ==========================================================================
   Конец универсальной мобильной и адаптивной системы
   ========================================================================== */
   
   /* ==========================================================================
   Продвинутая система анимаций и интерактивности Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== АДАПТИВНАЯ СИСТЕМА АНИМАЦИЙ ==================== */

:root {
  /* Система длительностей анимаций */
  --animation-duration-instant: 50ms !important;
  --animation-duration-fast: 150ms !important;
  --animation-duration-normal: 300ms !important;
  --animation-duration-slow: 500ms !important;
  --animation-duration-deliberate: 1000ms !important;
  
  /* Кривые Безье для разных целей */
  --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1) !important;
  --ease-out: cubic-bezier(0, 0, 0.2, 1) !important;
  --ease-in: cubic-bezier(0.4, 0, 1, 1) !important;
  --ease-elastic: cubic-bezier(0.68, -0.55, 0.265, 1.55) !important;
  --ease-bounce: cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
  
  /* Система слоев анимаций */
  --animation-layer-base: 1 !important;
  --animation-layer-content: 10 !important;
  --animation-layer-overlay: 100 !important;
  --animation-layer-modal: 1000 !important;
}

/* ==================== СИСТЕМА МИКРО-ИНТЕРАКЦИЙ ==================== */

/* Умные hover-эффекты */
.interactive-element {
  position: relative !important;
  transition: all var(--animation-duration-fast) var(--ease-out) !important;
  
  &::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background: var(--accent-primary) !important;
    border-radius: inherit !important;
    opacity: 0 !important;
    transition: opacity var(--animation-duration-normal) var(--ease-out) !important;
    z-index: -1 !important;
  }
  
  &:hover::before {
    opacity: 0.05 !important;
  }
  
  &:active::before {
    opacity: 0.1 !important;
    transition-duration: var(--animation-duration-instant) !important;
  }
}

/* Продвинутые focus-состояния */
.focus-enhanced:focus-visible {
  outline: 2px solid var(--accent-primary) !important;
  outline-offset: 2px !important;
  border-radius: 4px !important;
  animation: focus-pulse 0.5s var(--ease-out) !important;
}

@keyframes focus-pulse {
  0% { outline-offset: 2px; }
  50% { outline-offset: 4px; }
  100% { outline-offset: 2px; }
}

/* ==================== АДАПТИВНЫЕ АНИМАЦИИ КОНТЕНТА ==================== */

/* Появление контента с stagger-эффектом */
.content-entrance > * {
  opacity: 0 !important;
  transform: translateY(20px) !important;
  animation: slideInUp var(--animation-duration-normal) var(--ease-out) forwards !important;
}

@keyframes slideInUp {
  to {
    opacity: 1 !important;
    transform: translateY(0) !important;
  }
}

/* Stagger-анимации для списков */
.stagger-list > *:nth-child(1) { animation-delay: 0ms !important; }
.stagger-list > *:nth-child(2) { animation-delay: 50ms !important; }
.stagger-list > *:nth-child(3) { animation-delay: 100ms !important; }
.stagger-list > *:nth-child(4) { animation-delay: 150ms !important; }
.stagger-list > *:nth-child(5) { animation-delay: 200ms !important; }

/* ==================== ИНТЕЛЛЕКТУАЛЬНЫЕ АНИМАЦИИ НАВИГАЦИИ ==================== */

/* View Transitions API для навигации */
@view-transition {
  navigation: auto !important;
}

.view-transition-container {
  view-transition-name: main-content !important;
}

/* Анимации перехода между страницами */
.page-transition-enter {
  animation: pageEnter var(--animation-duration-normal) var(--ease-out) !important;
}

.page-transition-exit {
  animation: pageExit var(--animation-duration-fast) var(--ease-in) !important;
}

@keyframes pageEnter {
  from {
    opacity: 0;
    transform: translateX(30px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes pageExit {
  to {
    opacity: 0;
    transform: translateX(-30px);
  }
}

/* ==================== ИНТЕРАКТИВНЫЕ ВИЗУАЛЬНЫЕ ЭФФЕКТЫ ==================== */

/* Magnetic buttons */
.magnetic-button {
  position: relative !important;
  overflow: hidden !important;
  
  &::after {
    content: '' !important;
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    width: 0 !important;
    height: 0 !important;
    background: radial-gradient(circle, var(--accent-primary) 0%, transparent 70%) !important;
    transition: all var(--animation-duration-slow) var(--ease-out) !important;
    transform: translate(-50%, -50%) !important;
    opacity: 0 !important;
  }
  
  &:hover::after {
    width: 300% !important;
    height: 300% !important;
    opacity: 0.1 !important;
  }
}

/* Floating action elements */
.floating-element {
  animation: float 3s var(--ease-in-out) infinite !important;
}

@keyframes float {
  0%, 100% {
    transform: translateY(0px) rotate(0deg);
  }
  33% {
    transform: translateY(-5px) rotate(1deg);
  }
  66% {
    transform: translateY(3px) rotate(-1deg);
  }
}

/* ==================== СИСТЕМА СОСТОЯНИЙ ЗАГРУЗКИ ==================== */

/* Skeleton loading animations */
.skeleton-loader {
  background: linear-gradient(
    90deg,
    color-mix(in oklch, var(--background-primary), transparent 80%) 25%,
    color-mix(in oklch, var(--background-primary), transparent 90%) 50%,
    color-mix(in oklch, var(--background-primary), transparent 80%) 75%
  ) !important;
  background-size: 200% 100% !important;
  animation: skeleton-loading 2s infinite !important;
  border-radius: 4px !important;
}

@keyframes skeleton-loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* Progress indicators */
.progress-indicator {
  position: relative !important;
  overflow: hidden !important;
  
  &::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: -100% !important;
    width: 100% !important;
    height: 100% !important;
    background: linear-gradient(
      90deg,
      transparent,
      color-mix(in oklch, var(--accent-primary), transparent 80%),
      transparent
    ) !important;
    animation: progress-shine 2s var(--ease-in-out) infinite !important;
  }
}

@keyframes progress-shine {
  0% { left: -100%; }
  100% { left: 100%; }
}

/* ==================== ИНТЕРАКТИВНЫЕ ВИЗУАЛИЗАЦИИ ДАННЫХ ==================== */

/* Animated charts and graphs */
.data-bar {
  transform-origin: left center !important;
  animation: bar-grow 0.8s var(--ease-out) backwards !important;
}

@keyframes bar-grow {
  from {
    transform: scaleX(0);
    opacity: 0.5;
  }
  to {
    transform: scaleX(1);
    opacity: 1;
  }
}

/* Interactive heatmaps */
.heatmap-cell {
  transition: all var(--animation-duration-normal) var(--ease-out) !important;
  
  &:hover {
    transform: scale(1.2) !important;
    z-index: var(--animation-layer-content) !important;
    box-shadow: var(--neon-glow-primary) !important;
  }
}

/* ==================== СИСТЕМА ПАРАЛЛАКСА И 3D-ЭФФЕКТОВ ==================== */

/* Параллакс scrolling */
.parallax-container {
  perspective: 1000px !important;
  transform-style: preserve-3d !important;
}

.parallax-layer {
  transform-style: preserve-3d !important;
}

.parallax-layer[data-depth="0"] {
  transform: translateZ(0);
}

.parallax-layer[data-depth="1"] {
  transform: translateZ(100px) scale(0.9);
}

.parallax-layer[data-depth="2"] {
  transform: translateZ(200px) scale(0.8);
}

/* 3D transform effects */
.card-3d {
  transform-style: preserve-3d !important;
  transition: transform var(--animation-duration-normal) var(--ease-out) !important;
  
  &:hover {
    transform: rotateY(10deg) rotateX(5deg) translateZ(20px) !important;
  }
}

/* ==================== АДАПТИВНЫЕ АНИМАЦИИ ДЛЯ РАЗНЫХ УСТРОЙСТВ ==================== */

/* Оптимизация для мобильных устройств */
@media (max-width: 768px) {
  .mobile-optimized {
    --animation-duration-normal: 200ms !important;
    --animation-duration-slow: 300ms !important;
  }
}

/* Reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ==================== СИСТЕМА ТРИГГЕРОВ И СЦЕНАРИЕВ АНИМАЦИЙ ==================== */

/* Scroll-driven animations */
@keyframes reveal-on-scroll {
  from {
    opacity: 0;
    transform: translateY(50px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.scroll-reveal {
  animation: reveal-on-scroll linear both !important;
  animation-timeline: view() !important;
  animation-range: entry 0% cover 40% !important;
}

/* Intersection Observer-based animations */
.observe-animate {
  opacity: 0 !important;
  transform: translateY(30px) !important;
  transition: all var(--animation-duration-normal) var(--ease-out) !important;
}

.observe-animate.visible {
  opacity: 1 !important;
  transform: translateY(0) !important;
}

/* ==================== ИНТЕРАКТИВНЫЕ ФИЗИЧЕСКИЕ ЭФФЕКТЫ ==================== */

/* Spring physics simulations */
.spring-physics {
  animation: spring-bounce 0.6s var(--ease-elastic) !important;
}

@keyframes spring-bounce {
  0% { transform: scale(0.8); opacity: 0; }
  60% { transform: scale(1.05); }
  100% { transform: scale(1); opacity: 1; }
}

/* Particle effect simulations */
.particle-container {
  position: relative !important;
  overflow: hidden !important;
}

.particle {
  position: absolute !important;
  background: var(--accent-primary) !important;
  border-radius: 50% !important;
  animation: particle-explode 1s var(--ease-out) forwards !important;
}

@keyframes particle-explode {
  0% {
    transform: translate(0, 0) scale(0);
    opacity: 1;
  }
  100% {
    transform: translate(var(--tx, 100px), var(--ty, 100px)) scale(1);
    opacity: 0;
  }
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА АНИМАЦИЙ ==================== */

/* CSS Properties для динамических анимаций */
@property --animation-progress {
  syntax: '<number>';
  initial-value: 0;
  inherits: false;
}

/* Система регистрации анимаций */
@layer animations {
  /* Базовые анимации */
  .animation-fade-in {
    animation: fadeIn var(--animation-duration-normal) var(--ease-out) !important;
  }
  
  .animation-slide-in {
    animation: slideInUp var(--animation-duration-normal) var(--ease-out) !important;
  }
  
  .animation-scale-in {
    animation: scaleIn var(--animation-duration-normal) var(--ease-out) !important;
  }
}

/* Подготовка для будущих CSS-функций */
@supports (animation-timeline: scroll()) {
  .scroll-animated {
    animation-timeline: scroll() !important;
  }
}

@supports (animation-composition: accumulate) {
  .complex-animation {
    animation-composition: accumulate !important;
  }
}

/* Система тем для анимаций */
[data-animation-theme="subtle"] {
  --animation-duration-normal: 200ms !important;
  --ease-default: var(--ease-out) !important;
}

[data-animation-theme="expressive"] {
  --animation-duration-normal: 400ms !important;
  --ease-default: var(--ease-elastic) !important;
}

/* ==================== ПРОИЗВОДИТЕЛЬНОСТЬ И ОПТИМИЗАЦИЯ ==================== */

/* Оптимизация анимаций */
.will-animate {
  will-change: transform, opacity !important;
}

.animation-optimized {
  contain: layout style paint !important;
  transform: translateZ(0) !important; /* GPU acceleration */
}

/* Ленивая загрузка тяжелых анимаций */
@media (prefers-reduced-motion: no-preference) {
  .heavy-animation {
    animation: complexAnimation 2s var(--ease-out) !important;
  }
}

/* ==================== УТИЛИТЫ ДЛЯ РАЗРАБОТЧИКОВ ==================== */

/* Анимационные утилиты */
.animate-on-hover:hover {
  animation: hover-pulse 0.3s var(--ease-out) !important;
}

.animate-on-click:active {
  animation: click-scale 0.1s var(--ease-in) !important;
}

.animate-on-load {
  animation: load-fade-in 0.5s var(--ease-out) !important;
}

/* Отладка анимаций */
[data-debug-animations="true"] * {
  outline: 1px solid rgba(255, 0, 0, 0.3) !important;
  animation-duration: 2s !important;
}

/* ==================== БУДУЩИЕ СТАНДАРТЫ И ЭКСПЕРИМЕНТАЛЬНЫЕ ФУНКЦИИ ==================== */

/* Подготовка для CSS Animation Level 4 */
@supports (animation-timeline: view()) {
  .view-timeline-animation {
    animation-timeline: view() !important;
    animation-range: entry 0% cover 50% !important;
  }
}

/* Поддержка Scroll-driven Animations */
@scroll-timeline --page-scroll {
  source: auto;
  orientation: vertical;
  time-range: 1s;
}

.scroll-driven-element {
  animation: progress linear !important;
  animation-timeline: --page-scroll !important;
}

/* CSS Houdini подготовка */
@property --custom-progress {
  syntax: '<number>';
  initial-value: 0;
  inherits: false;
}

@supports (background: paint(something)) {
  .houdini-enhanced {
    --animation-engine: houdini !important;
  }
}

/* ==========================================================================
   Конец продвинутой системы анимаций и интерактивности
   ========================================================================== */
   
   /* ==========================================================================
   Универсальная система утилит и компонентов Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ДИЗАЙН-ТОКЕНОВ ==================== */

:root {
  /* Глобальные дизайн-токены */
  --design-version: '2.1.0' !important;
  --design-system: 'dark-nebula' !important;
  
  /* Система размеров (8px grid system) */
  --size-scale: 0.25rem !important; /* 4px */
  --size-1: calc(var(--size-scale) * 1) !important;  /* 4px */
  --size-2: calc(var(--size-scale) * 2) !important;  /* 8px */
  --size-3: calc(var(--size-scale) * 3) !important;  /* 12px */
  --size-4: calc(var(--size-scale) * 4) !important;  /* 16px */
  --size-5: calc(var(--size-scale) * 5) !important;  /* 20px */
  --size-6: calc(var(--size-scale) * 6) !important;  /* 24px */
  --size-8: calc(var(--size-scale) * 8) !important;  /* 32px */
  --size-10: calc(var(--size-scale) * 10) !important; /* 40px */
  --size-12: calc(var(--size-scale) * 12) !important; /* 48px */
  --size-16: calc(var(--size-scale) * 16) !important; /* 64px */
  
  /* Система скруглений */
  --radius-scale: 0.25rem !important;
  --radius-xs: calc(var(--radius-scale) * 1) !important;  /* 4px */
  --radius-sm: calc(var(--radius-scale) * 2) !important;  /* 8px */
  --radius-md: calc(var(--radius-scale) * 3) !important;  /* 12px */
  --radius-lg: calc(var(--radius-scale) * 4) !important;  /* 16px */
  --radius-xl: calc(var(--radius-scale) * 6) !important;  /* 24px */
  --radius-2xl: calc(var(--radius-scale) * 8) !important; /* 32px */
  --radius-full: 50% !important;
  
  /* Система теней */
  --shadow-color: 0 0% 0% !important;
  --shadow-strength: 0.25 !important;
  --shadow-1: 0 1px 2px -1px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 0.05)) !important;
  --shadow-2: 
    0 3px 5px -2px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 0.05)),
    0 2px 3px -2px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 0.05)) !important;
  --shadow-3: 
    0 6px 10px -4px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 0.05)),
    0 4px 6px -4px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 0.05)) !important;
  --shadow-4: 
    0 12px 16px -6px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 0.05)),
    0 8px 12px -6px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 0.05)) !important;
  
  /* Система типографики */
  --font-family-sans: 'Inter', 'SF Pro Text', system-ui, sans-serif !important;
  --font-family-mono: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', monospace !important;
  --font-family-serif: 'Georgia', 'Times New Roman', serif !important;
  
  --font-scale: 1.2 !important;
  --font-size-xs: 0.75rem !important;   /* 12px */
  --font-size-sm: 0.875rem !important;  /* 14px */
  --font-size-base: 1rem !important;    /* 16px */
  --font-size-lg: 1.125rem !important;  /* 18px */
  --font-size-xl: 1.25rem !important;   /* 20px */
  --font-size-2xl: 1.5rem !important;   /* 24px */
  --font-size-3xl: 1.875rem !important; /* 30px */
  --font-size-4xl: 2.25rem !important;  /* 36px */
  
  --font-weight-light: 300 !important;
  --font-weight-normal: 400 !important;
  --font-weight-medium: 500 !important;
  --font-weight-semibold: 600 !important;
  --font-weight-bold: 700 !important;
  --font-weight-extrabold: 800 !important;
  
  --line-height-tight: 1.25 !important;
  --line-height-normal: 1.5 !important;
  --line-height-relaxed: 1.75 !important;
  --line-height-loose: 2 !important;
  
  /* Система z-index */
  --z-index-auto: auto !important;
  --z-index-0: 0 !important;
  --z-index-10: 10 !important;
  --z-index-20: 20 !important;
  --z-index-30: 30 !important;
  --z-index-40: 40 !important;
  --z-index-50: 50 !important;
  --z-index-dropdown: 1000 !important;
  --z-index-sticky: 1020 !important;
  --z-index-fixed: 1030 !important;
  --z-index-modal-backdrop: 1040 !important;
  --z-index-modal: 1050 !important;
  --z-index-popover: 1060 !important;
  --z-index-tooltip: 1070 !important;
  --z-index-toast: 1080 !important;
}

/* ==================== УТИЛИТАРНЫЕ КЛАССЫ ==================== */

/* Система отображения */
.d-block { display: block !important; }
.d-inline { display: inline !important; }
.d-inline-block { display: inline-block !important; }
.d-flex { display: flex !important; }
.d-inline-flex { display: inline-flex !important; }
.d-grid { display: grid !important; }
.d-inline-grid { display: inline-grid !important; }
.d-none { display: none !important; }

/* Flexbox утилиты */
.flex-row { flex-direction: row !important; }
.flex-col { flex-direction: column !important; }
.flex-wrap { flex-wrap: wrap !important; }
.flex-nowrap { flex-wrap: nowrap !important; }
.flex-1 { flex: 1 1 0% !important; }
.flex-auto { flex: 1 1 auto !important; }
.flex-none { flex: none !important; }

/* Выравнивание flex элементов */
.items-start { align-items: flex-start !important; }
.items-end { align-items: flex-end !important; }
.items-center { align-items: center !important; }
.items-baseline { align-items: baseline !important; }
.items-stretch { align-items: stretch !important; }

.justify-start { justify-content: flex-start !important; }
.justify-end { justify-content: flex-end !important; }
.justify-center { justify-content: center !important; }
.justify-between { justify-content: space-between !important; }
.justify-around { justify-content: space-around !important; }
.justify-evenly { justify-content: space-evenly !important; }

/* Grid утилиты */
.grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)) !important; }
.grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)) !important; }
.grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)) !important; }
.grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)) !important; }
.grid-cols-auto { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)) !important; }

.gap-1 { gap: var(--size-1) !important; }
.gap-2 { gap: var(--size-2) !important; }
.gap-3 { gap: var(--size-3) !important; }
.gap-4 { gap: var(--size-4) !important; }
.gap-6 { gap: var(--size-6) !important; }
.gap-8 { gap: var(--size-8) !important; }

/* Отступы */
.p-0 { padding: 0 !important; }
.p-1 { padding: var(--size-1) !important; }
.p-2 { padding: var(--size-2) !important; }
.p-3 { padding: var(--size-3) !important; }
.p-4 { padding: var(--size-4) !important; }
.p-6 { padding: var(--size-6) !important; }
.p-8 { padding: var(--size-8) !important; }

.px-0 { padding-left: 0 !important; padding-right: 0 !important; }
.px-1 { padding-left: var(--size-1) !important; padding-right: var(--size-1) !important; }
.px-2 { padding-left: var(--size-2) !important; padding-right: var(--size-2) !important; }
.px-3 { padding-left: var(--size-3) !important; padding-right: var(--size-3) !important; }
.px-4 { padding-left: var(--size-4) !important; padding-right: var(--size-4) !important; }

.py-0 { padding-top: 0 !important; padding-bottom: 0 !important; }
.py-1 { padding-top: var(--size-1) !important; padding-bottom: var(--size-1) !important; }
.py-2 { padding-top: var(--size-2) !important; padding-bottom: var(--size-2) !important; }
.py-3 { padding-top: var(--size-3) !important; padding-bottom: var(--size-3) !important; }
.py-4 { padding-top: var(--size-4) !important; padding-bottom: var(--size-4) !important; }

/* Внешние отступы */
.m-0 { margin: 0 !important; }
.m-1 { margin: var(--size-1) !important; }
.m-2 { margin: var(--size-2) !important; }
.m-3 { margin: var(--size-3) !important; }
.m-4 { margin: var(--size-4) !important; }
.m-6 { margin: var(--size-6) !important; }
.m-8 { margin: var(--size-8) !important; }

.mx-0 { margin-left: 0 !important; margin-right: 0 !important; }
.mx-1 { margin-left: var(--size-1) !important; margin-right: var(--size-1) !important; }
.mx-2 { margin-left: var(--size-2) !important; margin-right: var(--size-2) !important; }
.mx-3 { margin-left: var(--size-3) !important; margin-right: var(--size-3) !important; }
.mx-4 { margin-left: var(--size-4) !important; margin-right: var(--size-4) !important; }
.mx-auto { margin-left: auto !important; margin-right: auto !important; }

.my-0 { margin-top: 0 !important; margin-bottom: 0 !important; }
.my-1 { margin-top: var(--size-1) !important; margin-bottom: var(--size-1) !important; }
.my-2 { margin-top: var(--size-2) !important; margin-bottom: var(--size-2) !important; }
.my-3 { margin-top: var(--size-3) !important; margin-bottom: var(--size-3) !important; }
.my-4 { margin-top: var(--size-4) !important; margin-bottom: var(--size-4) !important; }

/* Размеры */
.w-auto { width: auto !important; }
.w-full { width: 100% !important; }
.w-screen { width: 100vw !important; }
.w-min { width: min-content !important; }
.w-max { width: max-content !important; }

.h-auto { height: auto !important; }
.h-full { height: 100% !important; }
.h-screen { height: 100vh !important; }
.h-min { height: min-content !important; }
.h-max { height: max-content !important; }

.min-w-0 { min-width: 0 !important; }
.min-w-full { min-width: 100% !important; }
.min-w-min { min-width: min-content !important; }
.min-w-max { min-width: max-content !important; }

.min-h-0 { min-height: 0 !important; }
.min-h-full { min-height: 100% !important; }
.min-h-screen { min-height: 100vh !important; }

.max-w-full { max-width: 100% !important; }
.max-w-screen { max-width: 100vw !important; }
.max-w-prose { max-width: 65ch !important; }

.max-h-full { max-height: 100% !important; }
.max-h-screen { max-height: 100vh !important; }

/* ==================== СИСТЕМА КОМПОНЕНТОВ ==================== */

/* Карточки */
.card {
  background: var(--plugin-background) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-md) !important;
  padding: var(--size-4) !important;
  box-shadow: var(--shadow-2) !important;
  transition: all var(--animation-duration-normal) var(--ease-out) !important;
}

.card:hover {
  border-color: color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  box-shadow: var(--shadow-3) !important;
  transform: translateY(-2px) !important;
}

.card-header {
  margin-bottom: var(--size-3) !important;
  padding-bottom: var(--size-2) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.card-title {
  color: var(--accent-primary) !important;
  font-weight: var(--font-weight-semibold) !important;
  font-size: var(--font-size-lg) !important;
  margin: 0 !important;
}

/* Кнопки */
.btn {
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: var(--size-2) !important;
  padding: var(--size-2) var(--size-4) !important;
  border: 1px solid transparent !important;
  border-radius: var(--radius-md) !important;
  font-weight: var(--font-weight-medium) !important;
  font-size: var(--font-size-sm) !important;
  text-decoration: none !important;
  cursor: pointer !important;
  transition: all var(--animation-duration-fast) var(--ease-out) !important;
  user-select: none !important;
}

.btn:focus-visible {
  outline: 2px solid var(--accent-primary) !important;
  outline-offset: 2px !important;
}

.btn-primary {
  background: var(--accent-primary) !important;
  color: white !important;
  border-color: var(--accent-primary) !important;
}

.btn-primary:hover {
  background: color-mix(in oklch, var(--accent-primary), black 15%) !important;
  border-color: color-mix(in oklch, var(--accent-primary), black 15%) !important;
  transform: translateY(-1px) !important;
}

.btn-secondary {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  color: var(--accent-primary) !important;
  border-color: color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
}

.btn-secondary:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-color: color-mix(in oklch, var(--accent-primary), transparent 60%) !important;
}

/* Badges */
.badge {
  display: inline-flex !important;
  align-items: center !important;
  padding: var(--size-1) var(--size-2) !important;
  border-radius: var(--radius-full) !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-medium) !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
}

.badge-primary {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  color: var(--accent-primary) !important;
}

.badge-success {
  background: color-mix(in oklch, var(--semantic-success), transparent 90%) !important;
  color: var(--semantic-success) !important;
}

.badge-warning {
  background: color-mix(in oklch, var(--semantic-warning), transparent 90%) !important;
  color: var(--semantic-warning) !important;
}

.badge-error {
  background: color-mix(in oklch, var(--semantic-error), transparent 90%) !important;
  color: var(--semantic-error) !important;
}

/* Alerts */
.alert {
  padding: var(--size-4) !important;
  border-radius: var(--radius-md) !important;
  border-left: 4px solid transparent !important;
  margin: var(--size-4) 0 !important;
}

.alert-info {
  background: color-mix(in oklch, var(--semantic-info), transparent 95%) !important;
  border-left-color: var(--semantic-info) !important;
  color: var(--text-normal) !important;
}

.alert-warning {
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
  border-left-color: var(--semantic-warning) !important;
  color: var(--text-normal) !important;
}

.alert-error {
  background: color-mix(in oklch, var(--semantic-error), transparent 95%) !important;
  border-left-color: var(--semantic-error) !important;
  color: var(--text-normal) !important;
}

.alert-success {
  background: color-mix(in oklch, var(--semantic-success), transparent 95%) !important;
  border-left-color: var(--semantic-success) !important;
  color: var(--text-normal) !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ==================== */

/* CSS Layers для организации */
@layer base, components, utilities;

@layer base {
  /* Базовые стили системы */
  .design-system-base {
    --system-version: var(--design-version) !important;
  }
}

@layer components {
  /* Компоненты системы */
  .card,
  .btn,
  .badge,
  .alert {
    --component-version: '1.0' !important;
  }
}

@layer utilities {
  /* Утилитарные классы */
  .d-flex { display: flex !important; }
  .items-center { align-items: center !important; }
  /* ... остальные утилиты */
}

/* Container Queries для компонентов */
@container (min-width: 400px) {
  .card {
    padding: var(--size-6) !important;
  }
}

/* Система тем для компонентов */
[data-component-theme="minimal"] {
  --radius-md: var(--radius-sm) !important;
  --shadow-2: none !important;
}

[data-component-theme="elevated"] {
  --shadow-2: var(--shadow-3) !important;
  --border-opacity: 0.3 !important;
}

/* ==================== БУДУЩИЕ СТАНДАРТЫ И МАСШТАБИРУЕМОСТЬ ==================== */

/* CSS Nesting поддержка */
.component-system {
  & .card {
    margin: var(--size-4) 0;
    
    & .card-header {
      border-bottom: 1px solid currentColor;
    }
  }
}

/* Подготовка для CSS Scope */
@scope (.component-scope) {
  .card {
    background: var(--background-primary);
  }
}

/* CSS Anchor Positioning подготовка */
.anchor-component {
  position: absolute;
  position-anchor: --anchor;
}

.anchor-target {
  anchor-name: --anchor;
}

/* Система версионирования компонентов */
[data-component-version="2.1"] {
  --compatibility-mode: true;
}

/* ==================== УТИЛИТЫ ДЛЯ РАЗРАБОТЧИКОВ ==================== */

/* Отладочные утилиты */
.debug-border * {
  outline: 1px solid red !important;
}

.debug-grid {
  background-image: 
    linear-gradient(rgba(255,0,0,0.1) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,0,0,0.1) 1px, transparent 1px) !important;
  background-size: 8px 8px !important;
}

/* Утилиты для тестирования */
.test-highlight {
  background: yellow !important;
  color: black !important;
}

.test-outline {
  outline: 2px dashed lime !important;
}

/* ==================== ПРОИЗВОДИТЕЛЬНОСТЬ И ОПТИМИЗАЦИЯ ==================== */

/* Оптимизация утилит */
.util-optimized {
  contain: layout style !important;
}

/* Ленивая загрузка тяжелых компонентов */
@media (prefers-reduced-motion: no-preference) {
  .component-heavy {
    animation: fadeIn var(--animation-duration-normal) ease-out;
  }
}

/* ==========================================================================
   Конец универсальной системы утилит и компонентов
   ========================================================================== */
   
   /* ==========================================================================
   Универсальная система доступности и инклюзивного дизайна Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ДОСТУПНОСТИ ==================== */

:root {
  /* Переменные доступности */
  --a11y-version: '2.1.0' !important;
  --a11y-min-tap-target: 44px !important;
  --a11y-focus-ring: 2px solid var(--accent-primary) !important;
  --a11y-focus-offset: 2px !important;
  --a11y-contrast-ratio: 4.5 !important;
  --a11y-large-contrast-ratio: 3 !important;
  
  /* Цвета с гарантированной контрастностью */
  --a11y-text-primary: oklch(95% 0.02 var(--accent-hue-primary)) !important;
  --a11y-text-secondary: oklch(75% 0.03 var(--accent-hue-primary)) !important;
  --a11y-background-primary: oklch(15% 0.02 var(--accent-hue-primary)) !important;
  
  /* Размеры для доступности */
  --a11y-font-size-min: 16px !important;
  --a11y-line-height-min: 1.5 !important;
  --a11y-letter-spacing-min: 0.0125em !important;
  --a11y-word-spacing-min: 0.16em !important;
}

/* ==================== HIGH CONTRAST MODES ==================== */

/* Принудительная высокая контрастность */
@media (prefers-contrast: high) {
  :root {
    --background-primary: #000000 !important;
    --background-primary-alt: #111111 !important;
    --text-normal: #ffffff !important;
    --text-muted: #cccccc !important;
    --accent-primary: #ffff00 !important;
    --border-width: 2px !important;
  }
  
  * {
    color-scheme: dark !important;
  }
  
  .workspace-leaf {
    border: 1px solid var(--text-normal) !important;
  }
}

/* Режим повышенной контрастности */
[data-a11y-contrast="high"] {
  --background-primary: #000000 !important;
  --text-normal: #ffffff !important;
  --accent-primary: #00ff00 !important;
  --shadow-strength: 0.8 !important;
}

/* Инвертированный режим */
[data-a11y-contrast="inverted"] {
  filter: invert(1) hue-rotate(180deg) !important;
}

/* ==================== REDUCED MOTION SUPPORT ==================== */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  
  .cm-editor .cm-cursor {
    animation: none !important;
  }
}

/* Альтернативы для анимаций */
.reduced-motion-alternative {
  opacity: 1 !important;
  transform: none !important;
}

/* ==================== SCREEN READER OPTIMIZATIONS ==================== */

/* Screen reader only content */
.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

.sr-only-focusable:focus,
.sr-only-focusable:active {
  position: static !important;
  width: auto !important;
  height: auto !important;
  overflow: visible !important;
  clip: auto !important;
  white-space: normal !important;
}

/* ARIA live regions */
.aria-live-polite {
  aria-live: polite !important;
}

.aria-live-assertive {
  aria-live: assertive !important;
}

.aria-live-off {
  aria-live: off !important;
}

/* ==================== FOCUS MANAGEMENT SYSTEM ==================== */

/* Универсальные focus стили */
.focus-visible {
  outline: var(--a11y-focus-ring) !important;
  outline-offset: var(--a11y-focus-offset) !important;
  border-radius: var(--radius-sm) !important;
}

/* Кастомный focus indicator */
.focus-indicator {
  position: relative !important;
}

.focus-indicator::after {
  content: '' !important;
  position: absolute !important;
  top: -4px !important;
  left: -4px !important;
  right: -4px !important;
  bottom: -4px !important;
  border: 2px solid var(--accent-primary) !important;
  border-radius: calc(var(--radius-md) + 2px) !important;
  opacity: 0 !important;
  transition: opacity var(--animation-duration-fast) var(--ease-out) !important;
  pointer-events: none !important;
}

.focus-indicator:focus-visible::after {
  opacity: 1 !important;
}

/* Focus trapping для модальных окон */
.focus-trap {
  outline: none !important;
}

.focus-trap:focus {
  outline: 3px solid var(--accent-primary) !important;
  outline-offset: 2px !important;
}

/* ==================== KEYBOARD NAVIGATION ENHANCEMENTS ==================== */

/* Skip links */
.skip-link {
  position: absolute !important;
  top: -40px !important;
  left: 6px !important;
  background: var(--accent-primary) !important;
  color: white !important;
  padding: 8px 12px !important;
  border-radius: var(--radius-md) !important;
  text-decoration: none !important;
  font-weight: var(--font-weight-bold) !important;
  z-index: var(--z-index-popover) !important;
  transition: top var(--animation-duration-normal) var(--ease-out) !important;
}

.skip-link:focus {
  top: 6px !important;
}

/* Keyboard shortcuts hints */
.kbd-shortcut {
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  min-width: var(--a11y-min-tap-target) !important;
  height: var(--a11y-min-tap-target) !important;
  padding: 0 var(--size-2) !important;
  background: color-mix(in oklch, var(--background-primary), white 10%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-sm) !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-bold) !important;
  color: var(--accent-primary) !important;
}

/* ==================== COGNITIVE ACCESSIBILITY ==================== */

/* Упрощенный режим для когнитивной доступности */
[data-cognitive-simplified="true"] {
  --font-size-base: 18px !important;
  --line-height-base: 1.8 !important;
  --layout-spacing: 16px !important;
}

.cognitive-simple {
  font-size: var(--a11y-font-size-min) !important;
  line-height: var(--a11y-line-height-min) !important;
  letter-spacing: var(--a11y-letter-spacing-min) !important;
}

/* Dyslexia-friendly режим */
[data-dyslexia-friendly="true"] {
  font-family: 'OpenDyslexic', 'Comic Sans MS', sans-serif !important;
  letter-spacing: 0.035em !important;
  word-spacing: 0.16em !important;
  line-height: 1.8 !important;
}

/* Упрощенные анимации */
.cognitive-reduced-motion * {
  animation: none !important;
  transition: none !important;
}

/* ==================== VISUAL ACCESSIBILITY ==================== */

/* Цветовая слепота поддержка */
[data-color-blindness="protanopia"] {
  filter: url('#protanopia') !important;
}

[data-color-blindness="deuteranopia"] {
  filter: url('#deuteranopia') !important;
}

[data-color-blindness="tritanopia"] {
  filter: url('#tritanopia') !important;
}

/* Альтернативные индикаторы для цветов */
.color-blind-safe {
  position: relative !important;
}

.color-blind-safe::before {
  content: '' !important;
  position: absolute !important;
  top: 2px !important;
  left: 2px !important;
  width: 4px !important;
  height: 4px !important;
  border-radius: 50% !important;
  background: currentColor !important;
  opacity: 0.8 !important;
}

/* Увеличение для слабовидящих */
[data-visual-zoom="large"] {
  font-size: 20px !important;
  line-height: 1.8 !important;
}

[data-visual-zoom="x-large"] {
  font-size: 24px !important;
  line-height: 2 !important;
}

/* ==================== MOTOR ACCESSIBILITY ==================== */

/* Увеличенные touch targets */
.motor-optimized {
  min-width: var(--a11y-min-tap-target) !important;
  min-height: var(--a11y-min-tap-target) !important;
  padding: var(--size-2) var(--size-4) !important;
}

/* Упрощенная навигация */
.motor-simple-nav {
  gap: var(--size-4) !important;
}

.motor-simple-nav button {
  padding: var(--size-4) !important;
  font-size: var(--font-size-lg) !important;
}

/* Sticky headers для легкой навигации */
.motor-sticky-header {
  position: sticky !important;
  top: 0 !important;
  background: var(--background-primary) !important;
  z-index: var(--z-index-sticky) !important;
  padding: var(--size-3) !important;
  border-bottom: 2px solid var(--accent-primary) !important;
}

/* ==================== LINGUISTIC ACCESSIBILITY ==================== */

/* Поддержка RTL языков */
[dir="rtl"] {
  text-align: right !important;
}

[dir="rtl"] .workspace-tab-header {
  padding: 12px 20px 12px 12px !important;
}

[dir="rtl"] .view-action {
  margin-left: 0 !important;
  margin-right: 8px !important;
}

/* Языковые специфичные стили */
[lang="ar"],
[lang="he"],
[lang="fa"] {
  font-family: 'Tahoma', 'Arial', sans-serif !important;
  line-height: 1.8 !important;
}

/* ==================== ASSISTIVE TECHNOLOGY INTEGRATION ==================== */

/* Live announcements для скринридеров */
.aria-live-region {
  position: absolute !important;
  left: -10000px !important;
  width: 1px !important;
  height: 1px !important;
  overflow: hidden !important;
}

/* Semantic structure helpers */
.semantic-heading {
  font-weight: var(--font-weight-bold) !important;
  margin: var(--size-4) 0 var(--size-2) 0 !important;
}

.semantic-list {
  list-style-type: disc !important;
  padding-left: var(--size-6) !important;
  margin: var(--size-3) 0 !important;
}

.semantic-button {
  cursor: pointer !important;
  user-select: none !important;
}

/* ==================== ADAPTIVE ACCESSIBILITY SYSTEM ==================== */

/* Автоматическая адаптация к системным настройкам */
@media (prefers-color-scheme: light) {
  .auto-adaptive {
    --background-primary: #ffffff !important;
    --text-normal: #000000 !important;
  }
}

@media (prefers-contrast: more) {
  .auto-adaptive {
    --border-width: 2px !important;
    --shadow-strength: 0.8 !important;
  }
}

/* Progressive enhancement для доступности */
.a11y-progressive {
  /* Базовые гарантированные стили */
}

@supports (color: oklch(0% 0 0)) {
  .a11y-progressive {
    /* Улучшенные стили с современными цветами */
    color: var(--a11y-text-primary) !important;
    background: var(--a11y-background-primary) !important;
  }
}

/* ==================== SCALABLE ACCESSIBILITY ARCHITECTURE ==================== */

/* CSS Layers для организации доступности */
@layer a11y-base, a11y-components, a11y-utilities;

@layer a11y-base {
  .a11y-foundation {
    --a11y-version: var(--design-version) !important;
  }
}

@layer a11y-components {
  .a11y-component {
    min-height: var(--a11y-min-tap-target) !important;
  }
}

@layer a11y-utilities {
  .a11y-focus {
    outline: var(--a11y-focus-ring) !important;
  }
}

/* Container Queries для адаптивной доступности */
@container (max-width: 400px) {
  .a11y-responsive {
    --a11y-min-tap-target: 48px !important;
    font-size: 18px !important;
  }
}

/* Система тем доступности */
[data-a11y-theme="high-contrast"] {
  --a11y-contrast-ratio: 7 !important;
  --border-width: 2px !important;
}

[data-a11y-theme="reduced-motion"] {
  --animation-duration-normal: 0.01ms !important;
}

/* ==================== FUTURE STANDARDS PREPARATION ==================== */

/* Подготовка для будущих CSS-функций доступности */
@supports (media: (prefers-reduced-data)) {
  @media (prefers-reduced-data: reduce) {
    .a11y-data-conscious {
      background-image: none !important;
      font-family: system-ui !important;
    }
  }
}

@supports (media: (prefers-reduced-transparency)) {
  @media (prefers-reduced-transparency: reduce) {
    .a11y-opaque {
      backdrop-filter: none !important;
      opacity: 1 !important;
    }
  }
}

/* CSS Anchor Positioning для доступности */
.a11y-tooltip {
  position: absolute;
  position-anchor: --tooltip-anchor;
}

.a11y-tooltip-target {
  anchor-name: --tooltip-anchor;
}

/* ==================== DEVELOPER TOOLS AND TESTING ==================== */

/* Accessibility testing helpers */
.a11y-test-highcontrast {
  filter: grayscale(1) contrast(2) !important;
}

.a11y-test-nocolor {
  filter: grayscale(1) !important;
}

.a11y-test-focus {
  outline: 3px solid red !important;
}

/* Debug grid для проверки выравнивания */
.a11y-debug-grid {
  background-image: 
    linear-gradient(rgba(255, 0, 0, 0.1) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255, 0, 0, 0.1) 1px, transparent 1px) !important;
  background-size: 8px 8px !important;
}

/* ==================== PERFORMANCE AND OPTIMIZATION ==================== */

/* Оптимизация для скринридеров */
@media speech {
  .a11y-speech-optimized {
    background-image: none !important;
    animation: none !important;
  }
}

/* Ленивая загрузка тяжелых функций доступности */
@media (prefers-reduced-data: no-preference) {
  .a11y-enhanced {
    background: var(--gradient-primary) !important;
  }
}

/* ==========================================================================
   Конец универсальной системы доступности и инклюзивного дизайна
   ========================================================================== */
   
   /* ==========================================================================
   Продвинутая система производительности и оптимизации Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ПРОИЗВОДИТЕЛЬНОСТИ ==================== */

:root {
  /* Переменные производительности */
  --perf-version: '2.1.0' !important;
  --perf-contain-mode: strict !important;
  --perf-will-change: auto !important;
  --perf-gpu-acceleration: auto !important;
  --perf-content-visibility: auto !important;
  
  /* Адаптивные настройки производительности */
  --perf-low-end: optimizeSpeed !important;
  --perf-high-end: optimizeQuality !important;
}

/* ==================== ОПТИМИЗАЦИЯ РЕНДЕРИНГА ==================== */

/* Система contain для изоляции компонентов */
.perf-contain-layout {
  contain: layout !important;
}

.perf-contain-style {
  contain: style !important;
}

.perf-contain-paint {
  contain: paint !important;
}

.perf-contain-strict {
  contain: layout style paint !important;
}

.perf-contain-content {
  contain: content !important;
}

/* Оптимизация для больших документов */
.cm-editor .cm-line {
  content-visibility: auto !important;
  contain-intrinsic-size: 1px 1.7em !important;
}

.markdown-preview-view > * {
  content-visibility: auto !important;
  contain-intrinsic-size: 1px 4em !important;
}

/* Изоляция тяжелых компонентов */
.workspace-leaf-content[data-type="graph"],
.workspace-leaf-content[data-type="excalidraw"] {
  contain: strict !important;
  transform: translateZ(0) !important; /* GPU layer promotion */
}

/* ==================== GPU УСКОРЕНИЕ ==================== */

/* Умное использование GPU */
.gpu-accelerated {
  transform: translateZ(0) !important;
  backface-visibility: hidden !important;
  perspective: 1000px !important;
}

/* Оптимизированные анимации */
.perf-transform {
  will-change: transform !important;
}

.perf-opacity {
  will-change: opacity !important;
}

.perf-scroll {
  will-change: scroll-position !important;
}

/* Layer management */
.perf-layer-base {
  z-index: var(--z-index-0) !important;
}

.perf-layer-content {
  z-index: var(--z-index-10) !important;
  transform: translateZ(0) !important;
}

.perf-layer-overlay {
  z-index: var(--z-index-40) !important;
  transform: translateZ(10px) !important;
}

/* ==================== ОПТИМИЗАЦИЯ СКРОЛЛА ==================== */

/* Smooth scrolling с оптимизацией */
.perf-smooth-scroll {
  scroll-behavior: smooth !important;
  -webkit-overflow-scrolling: touch !important;
  scrollbar-gutter: stable !important;
}

/* Virtual scrolling для больших списков */
.virtual-scroll-container {
  overflow-anchor: auto !important;
  content-visibility: auto !important;
}

.virtual-scroll-item {
  contain-intrinsic-size: 50px !important;
  content-visibility: auto !important;
}

/* Оптимизация скроллбаров */
.perf-scrollbar {
  scrollbar-width: thin !important;
  scrollbar-color: var(--accent-primary) transparent !important;
}

.perf-scrollbar::-webkit-scrollbar {
  width: 6px !important;
  height: 6px !important;
}

.perf-scrollbar::-webkit-scrollbar-thumb {
  background: var(--accent-primary) !important;
  border-radius: 3px !important;
}

/* ==================== ОПТИМИЗАЦИЯ СЕТИ И ЗАГРУЗКИ ==================== */

/* Ленивая загрузка изображений */
.perf-lazy-image {
  background: color-mix(in oklch, var(--background-primary), transparent 20%) !important;
  animation: skeleton-loading 2s infinite !important;
}

.perf-lazy-image.loaded {
  background: transparent !important;
  animation: none !important;
}

/* Progressive enhancement для тяжелых ресурсов */
.perf-progressive {
  /* Базовая функциональность */
}

@supports (content-visibility: auto) {
  .perf-progressive {
    /* Улучшенная производительность */
    content-visibility: auto !important;
  }
}

/* Critical CSS оптимизация */
.perf-critical {
  /* Стили для первоначальной загрузки */
}

.perf-non-critical {
  /* Отложенная загрузка стилей */
}

/* ==================== АДАПТИВНАЯ ПРОИЗВОДИТЕЛЬНОСТЬ ==================== */

/* Адаптация к мощностям устройства */
@media (prefers-reduced-data: reduce) {
  .perf-data-conscious {
    background-image: none !important;
    font-family: system-ui !important;
    animation: none !important;
  }
}

/* Оптимизация для медленных сетей */
@media (update: slow) {
  .perf-slow-update {
    animation-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
  }
}

/* Оптимизация для слабых устройств */
.perf-low-power {
  --animation-duration-normal: 100ms !important;
  --shadow-strength: 0.1 !important;
  backdrop-filter: none !important;
}

/* ==================== ОПТИМИЗАЦИЯ ПАМЯТИ ==================== */

/* Оптимизация больших DOM деревьев */
.perf-dom-optimized {
  contain: layout style paint !important;
  will-change: transform !important;
}

/* Оптимизация CSSOM */
.perf-cssom-friendly {
  /* Минимизация сложных селекторов */
  font-family: inherit !important;
  color: inherit !important;
  background: inherit !important;
}

/* Оптимизация перерисовок */
.perf-repaint-optimized {
  transform: translateZ(0) !important;
  backface-visibility: hidden !important;
}

/* ==================== КЭШИРОВАНИЕ И ПРЕДЗАГРУЗКА ==================== */

/* Предзагрузка критических ресурсов */
.perf-preload-critical {
  font-display: swap !important;
}

.perf-preload-lazy {
  font-display: optional !important;
}

/* Кэширование сложных вычислений */
.perf-cached-transform {
  transform: translateZ(0) !important; /* GPU cache */
}

/* ==================== ОПТИМИЗАЦИЯ АНИМАЦИЙ ==================== */

/* Производительные свойства анимаций */
.perf-animate-transform {
  transform: translateZ(0) !important;
  transition: transform var(--animation-duration-normal) var(--ease-out) !important;
}

.perf-animate-opacity {
  transition: opacity var(--animation-duration-normal) var(--ease-out) !important;
}

/* Непроизводительные свойства (избегать) */
.perf-avoid-animate {
  /* box-shadow, border-radius, width, height */
  transition: none !important;
}

/* Compositor-only анимации */
.perf-compositor-animation {
  transform: translateZ(0) !important;
  will-change: transform, opacity !important;
}

/* ==================== ОПТИМИЗАЦИЯ ШРИФТОВ ==================== */

/* Система оптимизации шрифтов */
.perf-font-optimized {
  font-display: swap !important;
  font-feature-settings: 'kern' 1, 'liga' 1, 'calt' 1 !important;
  text-rendering: optimizeSpeed !important;
}

.perf-font-system {
  font-family: system-ui, -apple-system, sans-serif !important;
}

/* Оптимизация рендеринга текста */
.perf-text-rendering {
  text-rendering: optimizeLegibility !important;
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
}

/* ==================== ОПТИМИЗАЦИЯ ИЗОБРАЖЕНИЙ ==================== */

/* Адаптивные изображения */
.perf-responsive-image {
  max-width: 100% !important;
  height: auto !important;
  content-visibility: auto !important;
}

/* Ленивая загрузка с placeholder */
.perf-lazy-media {
  background: color-mix(in oklch, var(--background-primary), transparent 30%) !important;
  min-height: 200px !important;
}

.perf-lazy-media.loaded {
  background: transparent !important;
  animation: fadeIn var(--animation-duration-normal) ease-out !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ПРОИЗВОДИТЕЛЬНОСТИ ==================== */

/* CSS Layers для организации оптимизаций */
@layer perf-base, perf-components, perf-utilities;

@layer perf-base {
  .perf-foundation {
    --perf-version: var(--design-version) !important;
  }
}

@layer perf-components {
  .perf-component {
    contain: layout style !important;
  }
}

@layer perf-utilities {
  .perf-optimized {
    transform: translateZ(0) !important;
  }
}

/* Container Queries для адаптивной производительности */
@container (max-width: 768px) {
  .perf-mobile-optimized {
    --animation-duration-normal: 150ms !important;
    backdrop-filter: none !important;
  }
}

/* Система профилей производительности */
[data-perf-profile="low"] {
  --perf-contain-mode: strict !important;
  --perf-gpu-acceleration: minimal !important;
}

[data-perf-profile="balanced"] {
  --perf-contain-mode: content !important;
  --perf-gpu-acceleration: auto !important;
}

[data-perf-profile="high"] {
  --perf-contain-mode: none !important;
  --perf-gpu-acceleration: full !important;
}

/* ==================== БУДУЩИЕ СТАНДАРТЫ ОПТИМИЗАЦИИ ==================== */

/* Подготовка для CSS Containment Level 3 */
@supports (contain: layout style paint size) {
  .perf-contain-next {
    contain: layout style paint size !important;
  }
}

/* Подготовка для CSS Overflow Level 4 */
@supports (overflow: clip) {
  .perf-overflow-optimized {
    overflow: clip !important;
  }
}

/* CSS Houdini оптимизации */
@supports (background: paint(optimized-gradient)) {
  .perf-houdini-optimized {
    --perf-engine: houdini !important;
  }
}

/* Scroll-driven оптимизации */
@supports (animation-timeline: scroll()) {
  .perf-scroll-driven {
    animation-timeline: scroll() !important;
    animation-range: 0% 100% !important;
  }
}

/* ==================== МОНИТОРИНГ И ДИАГНОСТИКА ==================== */

/* Инструменты для отладки производительности */
.perf-debug-repaint {
  outline: 1px solid red !important;
}

.perf-debug-layer {
  background: rgba(255, 0, 0, 0.1) !important;
}

.perf-debug-fps {
  animation: fps-monitor 1s infinite !important;
}

@keyframes fps-monitor {
  0% { opacity: 0.3; }
  50% { opacity: 1; }
  100% { opacity: 0.3; }
}

/* Визуализация производительности */
.perf-visualization {
  position: fixed !important;
  top: 10px !important;
  right: 10px !important;
  background: rgba(0, 0, 0, 0.8) !important;
  color: white !important;
  padding: 8px 12px !important;
  border-radius: 4px !important;
  font-family: monospace !important;
  font-size: 12px !important;
  z-index: var(--z-index-tooltip) !important;
}

/* ==================== ОПТИМИЗАЦИЯ ДЛЯ РАЗНЫХ СРЕД ==================== */

/* Оптимизация для печати */
@media print {
  .perf-print-optimized {
    background: white !important;
    color: black !important;
    box-shadow: none !important;
    border: 1px solid #ccc !important;
  }
}

/* Оптимизация для проекторов */
@media projection {
  .perf-projection-optimized {
    font-size: 24px !important;
    line-height: 1.5 !important;
    background: white !important;
    color: black !important;
  }
}

/* Оптимизация для скринридеров */
@media speech {
  .perf-speech-optimized {
    background: transparent !important;
    color: inherit !important;
  }
}

/* ==================== УТИЛИТЫ ДЛЯ РАЗРАБОТЧИКОВ ==================== */

/* Профилировочные утилиты */
.perf-profile-slow {
  animation-duration: 2s !important;
  transition-duration: 2s !important;
}

.perf-profile-fast {
  animation-duration: 0.01ms !important;
  transition-duration: 0.01ms !important;
}

/* Тестовые утилиты */
.perf-test-heavy {
  backdrop-filter: blur(100px) !important;
  box-shadow: 0 0 100px rgba(0, 0, 0, 0.5) !important;
}

.perf-test-light {
  backdrop-filter: none !important;
  box-shadow: none !important;
}

/* ==================== АВАРИЙНЫЕ РЕЖИМЫ И FALLBACKS ==================== */

/* Graceful degradation */
.perf-fallback {
  /* Базовая функциональность */
}

.perf-fallback-enhanced {
  /* Улучшенная функциональность при поддержке */
}

/* Аварийные режимы */
.perf-emergency-mode {
  --animation-duration-normal: 0.01ms !important;
  backdrop-filter: none !important;
  filter: none !important;
  transform: none !important;
}

/* ==========================================================================
   Конец продвинутой системы производительности и оптимизации
   ========================================================================== */
   
   /* ==========================================================================
   Продвинутая система печати и экспорта Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ПЕЧАТИ ==================== */

:root {
  /* Переменные для печати */
  --print-version: '2.1.0' !important;
  --print-margin: 0.5in !important;
  --print-bleed: 0.125in !important;
  --print-safe-zone: 0.25in !important;
  --print-base-font-size: 12pt !important;
  --print-line-height: 1.4 !important;
  
  /* Цвета для печати */
  --print-background: white !important;
  --print-text: black !important;
  --print-accent: #333333 !important;
  --print-border: #cccccc !important;
  
  /* Настройки страницы */
  --print-page-width: 8.5in !important;
  --print-page-height: 11in !important;
  --print-header-height: 0.5in !important;
  --print-footer-height: 0.5in !important;
}

/* ==================== БАЗОВЫЕ СТИЛИ ПЕЧАТИ ==================== */

@media print {
  /* Сброс стилей для печати */
  * {
    background: transparent !important;
    color: var(--print-text) !important;
    box-shadow: none !important;
    text-shadow: none !important;
    filter: none !important;
    backdrop-filter: none !important;
  }
  
  /* Основная структура документа */
  body {
    background: var(--print-background) !important;
    color: var(--print-text) !important;
    font-size: var(--print-base-font-size) !important;
    line-height: var(--print-line-height) !important;
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
  }
  
  /* Скрытие ненужных элементов */
  .workspace-tabs,
  .workspace-leaf-resize-handle,
  .status-bar,
  .view-header,
  .modal,
  .notice,
  .mobile-navbar,
  .sidebar-toggle,
  .toolbar {
    display: none !important;
  }
  
  /* Рабочая область для печати */
  .workspace-leaf-content {
    position: static !important;
    width: 100% !important;
    height: auto !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    background: transparent !important;
  }
}

/* ==================== ОПТИМИЗАЦИЯ СОДЕРЖИМОГО ДЛЯ ПЕЧАТИ ==================== */

@media print {
  /* Контейнер контента */
  .markdown-preview-view,
  .cm-editor {
    max-width: none !important;
    margin: 0 !important;
    padding: var(--print-margin) !important;
    background: transparent !important;
    font-family: "Times New Roman", "Georgia", serif !important;
  }
  
  /* Заголовки для печати */
  h1, h2, h3, h4, h5, h6 {
    color: var(--print-text) !important;
    page-break-after: avoid !important;
    break-after: avoid !important;
  }
  
  h1 {
    font-size: 18pt !important;
    margin: 24pt 0 12pt 0 !important;
    border-bottom: 1pt solid var(--print-border) !important;
    padding-bottom: 6pt !important;
  }
  
  h2 {
    font-size: 16pt !important;
    margin: 20pt 0 10pt 0 !important;
  }
  
  h3 {
    font-size: 14pt !important;
    margin: 16pt 0 8pt 0 !important;
  }
  
  /* Параграфы и текст */
  p {
    margin: 0 0 12pt 0 !important;
    text-align: justify !important;
    orphans: 2 !important;
    widows: 2 !important;
  }
  
  /* Списки */
  ul, ol {
    margin: 12pt 0 !important;
    padding-left: 24pt !important;
  }
  
  li {
    margin: 6pt 0 !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }
  
  /* Блоки кода */
  pre, code {
    background: #f8f8f8 !important;
    border: 0.5pt solid var(--print-border) !important;
    font-family: "Courier New", "Monaco", monospace !important;
    font-size: 10pt !important;
  }
  
  pre {
    padding: 12pt !important;
    margin: 12pt 0 !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    overflow: hidden !important;
    white-space: pre-wrap !important;
  }
  
  code {
    padding: 1pt 2pt !important;
  }
  
  /* Таблицы */
  table {
    width: 100% !important;
    border-collapse: collapse !important;
    margin: 12pt 0 !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }
  
  th, td {
    border: 0.5pt solid var(--print-border) !important;
    padding: 6pt 8pt !important;
    text-align: left !important;
  }
  
  th {
    background: #f0f0f0 !important;
    font-weight: bold !important;
  }
  
  /* Изображения */
  img {
    max-width: 100% !important;
    height: auto !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    display: block !important;
    margin: 12pt auto !important;
  }
  
  /* Ссылки */
  a {
    color: var(--print-text) !important;
    text-decoration: underline !important;
  }
  
  a[href]::after {
    content: " (" attr(href) ")" !important;
    font-size: 9pt !important;
    color: #666666 !important;
  }
  
  a[href^="#"]::after,
  a[href^="/"]::after {
    content: "" !important;
  }
  
  /* Цитаты */
  blockquote {
    border-left: 2pt solid var(--print-border) !important;
    margin: 12pt 0 !important;
    padding: 6pt 0 6pt 12pt !important;
    background: #fafafa !important;
    font-style: italic !important;
  }
}

/* ==================== УПРАВЛЕНИЕ РАЗРЫВАМИ СТРАНИЦ ==================== */

@media print {
  /* Избежание разрывов в неподходящих местах */
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid !important;
    break-after: avoid !important;
  }
  
  pre, table, img, blockquote {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }
  
  /* Принудительные разрывы страниц */
  .page-break-before {
    page-break-before: always !important;
    break-before: page !important;
  }
  
  .page-break-after {
    page-break-after: always !important;
    break-after: page !important;
  }
  
  .page-break-inside-avoid {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }
  
  /* Контроль переносов */
  p, li {
    hyphenate-limit-chars: 6 3 3 !important;
    hyphenate-limit-lines: 2 !important;
    hyphenate-limit-zone: 8% !important;
  }
}

/* ==================== ЗАГОЛОВКИ И КОЛОНТИТУЛЫ ==================== */

@page {
  /* Настройки страницы */
  size: letter !important;
  margin: var(--print-margin) !important;
  
  /* Колонтитулы */
  @top-left {
    content: element(header-left) !important;
  }
  
  @top-center {
    content: element(header-center) !important;
  }
  
  @top-right {
    content: element(header-right) !important;
  }
  
  @bottom-left {
    content: element(footer-left) !important;
  }
  
  @bottom-center {
    content: element(footer-center) !important;
  }
  
  @bottom-right {
    content: element(footer-right) !important;
  }
}

@media print {
  /* Элементы колонтитулов */
  .print-header-left {
    position: running(header-left) !important;
    font-size: 9pt !important;
    color: #666666 !important;
  }
  
  .print-header-center {
    position: running(header-center) !important;
    font-size: 10pt !important;
    font-weight: bold !important;
  }
  
  .print-header-right {
    position: running(header-right) !important;
    font-size: 9pt !important;
    color: #666666 !important;
  }
  
  .print-footer-left {
    position: running(footer-left) !important;
    font-size: 8pt !important;
    color: #999999 !important;
  }
  
  .print-footer-center {
    position: running(footer-center) !important;
    font-size: 9pt !important;
    color: #666666 !important;
  }
  
  .print-footer-right {
    position: running(footer-right) !important;
    font-size: 8pt !important;
    color: #999999 !important;
    content: "Страница " counter(page) " из " counter(pages) !important;
  }
}

/* ==================== СПЕЦИАЛЬНЫЕ ФОРМАТЫ ЭКСПОРТА ==================== */

/* PDF экспорт */
@media print and (pdf) {
  .pdf-optimized {
    /* Специфичные оптимизации для PDF */
    color: black !important;
    background: white !important;
  }
  
  /* Гиперссылки в PDF */
  a[href] {
    color: #0000ee !important;
    text-decoration: underline !important;
  }
}

/* Экспорт в Word */
.export-word-compatible {
  /* Совместимость с Microsoft Word */
  font-family: "Times New Roman", serif !important;
  font-size: 12pt !important;
  line-height: 1.15 !important;
}

/* Экспорт для электронных книг */
.export-ebook {
  max-width: 600px !important;
  margin: 0 auto !important;
  font-size: 16px !important;
  line-height: 1.6 !important;
}

/* ==================== АДАПТИВНЫЕ ФОРМАТЫ СТРАНИЦ ==================== */

/* Letter (США) */
@page letter {
  size: 8.5in 11in !important;
  margin: 0.5in !important;
}

/* A4 (Международный) */
@page a4 {
  size: 210mm 297mm !important;
  margin: 15mm !important;
}

/* A5 (Буклет) */
@page a5 {
  size: 148mm 210mm !important;
  margin: 10mm !important;
}

/* Пейзажная ориентация */
@page landscape {
  size: landscape !important;
  margin: 0.5in !important;
}

/* ==================== СПЕЦИАЛЬНЫЕ РЕЖИМЫ ПЕЧАТИ ==================== */

/* Режим черновика */
@media print and (draft) {
  .draft-watermark::before {
    content: "ЧЕРНОВИК" !important;
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) rotate(-45deg) !important;
    font-size: 72pt !important;
    color: rgba(0, 0, 0, 0.1) !important;
    z-index: 1000 !important;
    pointer-events: none !important;
  }
}

/* Режим презентации */
@media print and (presentation) {
  .slide {
    page-break-before: always !important;
    break-before: page !important;
    height: 100vh !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: center !important;
    align-items: center !important;
    text-align: center !important;
  }
  
  .slide h1 {
    font-size: 36pt !important;
    margin-bottom: 24pt !important;
  }
  
  .slide p {
    font-size: 18pt !important;
    text-align: center !important;
  }
}

/* Режим брошюры */
@media print and (booklet) {
  @page :left {
    margin-left: var(--print-bleed) !important;
    margin-right: var(--print-safe-zone) !important;
  }
  
  @page :right {
    margin-left: var(--print-safe-zone) !important;
    margin-right: var(--print-bleed) !important;
  }
}

/* ==================== МАСШТАБИРУЕМАЯ СИСТЕМА ЭКСПОРТА ==================== */

/* CSS Layers для организации экспорта */
@layer export-base, export-formats, export-utilities;

@layer export-base {
  .export-foundation {
    --export-version: var(--design-version) !important;
  }
}

@layer export-formats {
  .export-pdf {
    /* Стили для PDF экспорта */
  }
  
  .export-word {
    /* Стили для Word экспорта */
  }
  
  .export-html {
    /* Стили для чистого HTML */
  }
}

@layer export-utilities {
  .export-optimized {
    page-break-inside: avoid !important;
  }
}

/* Container Queries для адаптивного экспорта */
@container export-container (max-width: 600px) {
  .export-mobile-optimized {
    font-size: 14px !important;
    line-height: 1.5 !important;
  }
}

/* Система профилей экспорта */
[data-export-profile="minimal"] {
  --print-margin: 0.25in !important;
  --print-base-font-size: 10pt !important;
}

[data-export-profile="academic"] {
  --print-margin: 1in !important;
  --print-base-font-size: 12pt !important;
}

[data-export-profile="presentation"] {
  --print-margin: 0.5in !important;
  --print-base-font-size: 18pt !important;
}

/* ==================== БУДУЩИЕ СТАНДАРТЫ ЭКСПОРТА ==================== */

/* Подготовка для CSS Paged Media Level 4 */
@supports (page: blank) {
  @page :blank {
    @top-center {
      content: "Эта страница intentionally left blank" !important;
    }
  }
}

@supports (page: first) {
  @page :first {
    margin-top: 1in !important;
    
    @top-center {
      content: none !important;
    }
  }
}

/* Подготовка для CSS Generated Content for Paged Media */
@supports (content: target-counter(attr(href), page)) {
  .print-index::after {
    content: target-counter(attr(href), page) !important;
  }
}

/* CSS Houdini для кастомного экспорта */
@supports (background: paint(print-watermark)) {
  .export-houdini-enhanced {
    --export-engine: houdini !important;
  }
}

/* ==================== УТИЛИТЫ ДЛЯ РАЗРАБОТЧИКОВ ==================== */

/* Предпросмотр печати */
.print-preview-mode {
  background: white !important;
  color: black !important;
  box-shadow: 0 0 0 1px #cccccc !important;
  margin: 20px auto !important;
  max-width: 8.5in !important;
  min-height: 11in !important;
}

/* Отладочные утилиты */
.export-debug-breaks * {
  outline: 1px solid red !important;
}

.export-debug-page::after {
  content: "Страница: " counter(page) !important;
  position: fixed !important;
  top: 10px !important;
  right: 10px !important;
  background: red !important;
  color: white !important;
  padding: 2px 4px !important;
  font-size: 10px !important;
}

/* Тестовые утилиты */
.export-test-bleed {
  outline: 1px solid red !important;
  position: absolute !important;
  top: var(--print-bleed) !important;
  left: var(--print-bleed) !important;
  right: var(--print-bleed) !important;
  bottom: var(--print-bleed) !important;
  pointer-events: none !important;
}

.export-test-safe {
  outline: 1px solid blue !important;
  position: absolute !important;
  top: var(--print-safe-zone) !important;
  left: var(--print-safe-zone) !important;
  right: var(--print-safe-zone) !important;
  bottom: var(--print-safe-zone) !important;
  pointer-events: none !important;
}

/* ==================== ПРОИЗВОДИТЕЛЬНОСТЬ И ОПТИМИЗАЦИЯ ==================== */

/* Оптимизация для больших документов */
@media print {
  .export-large-document {
    content-visibility: auto !important;
    contain-intrinsic-size: 1px 1000px !important;
  }
}

/* Ленивая загрузка тяжелых элементов экспорта */
.export-lazy-element {
  display: none !important;
}

@media print {
  .export-lazy-element {
    display: block !important;
  }
}

/* ==================== СОВМЕСТИМОСТЬ И FALLBACKS ==================== */

/* Graceful degradation для старых браузеров */
.export-fallback {
  /* Базовая функциональность печати */
}

@supports (page: :first) {
  .export-fallback-enhanced {
    /* Улучшенная функциональность */
  }
}

/* Аварийные режимы */
.export-emergency {
  font-family: "Times New Roman", serif !important;
  font-size: 12pt !important;
  line-height: 1.15 !important;
  color: black !important;
  background: white !important;
}

/* ==========================================================================
   Конец продвинутой системы печати и экспорта
   ========================================================================== */
   
   /* ==========================================================================
   Универсальная система международной поддержки Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ЛОКАЛИЗАЦИИ ==================== */

:root {
  /* Глобальные переменные локализации */
  --i18n-version: '2.1.0' !important;
  --i18n-default-lang: 'en' !important;
  --i18n-font-scale: 1.0 !important;
  --i18n-line-height-scale: 1.0 !important;
  --i18n-letter-spacing: normal !important;
  
  /* Направление письма */
  --i18n-dir: ltr !important;
  --i18n-text-align: left !important;
  --i18n-start: left !important;
  --i18n-end: right !important;
  
  /* Система шрифтов для разных языков */
  --i18n-font-latin: 'Inter', 'SF Pro Text', system-ui, sans-serif !important;
  --i18n-font-cyrillic: 'Inter', 'SF Pro Text', 'Helvetica Neue', sans-serif !important;
  --i18n-font-arabic: 'Tahoma', 'Arial', sans-serif !important;
  --i18n-font-cjk: 'Hiragino Sans', 'Microsoft YaHei', 'Noto Sans CJK', sans-serif !important;
  --i18n-font-devanagari: 'Noto Sans Devanagari', 'Arial', sans-serif !important;
}

/* ==================== ПОДДЕРЖКА RTL ЯЗЫКОВ ==================== */

[dir="rtl"] {
  --i18n-dir: rtl !important;
  --i18n-text-align: right !important;
  --i18n-start: right !important;
  --i18n-end: left !important;
  
  /* Инвертирование макета */
  direction: rtl !important;
  text-align: right !important;
}

/* RTL адаптация интерфейса */
[dir="rtl"] .workspace-tab-header {
  padding: 12px 12px 12px 20px !important;
}

[dir="rtl"] .view-action {
  margin-left: 0 !important;
  margin-right: 8px !important;
}

[dir="rtl"] .nav-file-title {
  padding: 4px 20px 4px 8px !important;
}

[dir="rtl"] .cm-editor .cm-gutters {
  border-right: none !important;
  border-left: 1px solid var(--background-modifier-border) !important;
}

[dir="rtl"] .markdown-preview-view blockquote {
  border-left: none !important;
  border-right: 4px solid var(--quote-opening-modifier) !important;
  padding: 12px 24px 12px 16px !important;
}

/* ==================== СИСТЕМА ШРИФТОВ ДЛЯ РАЗНЫХ ЯЗЫКОВ ==================== */

/* Латиница (западные языки) */
[lang="en"],
[lang="es"],
[lang="fr"],
[lang="de"],
[lang="it"] {
  font-family: var(--i18n-font-latin) !important;
  --i18n-font-scale: 1.0 !important;
  --i18n-line-height-scale: 1.0 !important;
}

/* Кириллица */
[lang="ru"],
[lang="uk"],
[lang="be"],
[lang="bg"],
[lang="sr"],
[lang="mk"] {
  font-family: var(--i18n-font-cyrillic) !important;
  --i18n-font-scale: 1.05 !important;
  --i18n-line-height-scale: 1.1 !important;
}

/* Арабская письменность */
[lang="ar"],
[lang="fa"],
[lang="ur"],
[lang="ps"] {
  font-family: var(--i18n-font-arabic) !important;
  --i18n-font-scale: 1.15 !important;
  --i18n-line-height-scale: 1.3 !important;
  --i18n-letter-spacing: 0.02em !important;
}

/* CJK (Китайский, Японский, Корейский) */
[lang="zh"],
[lang="ja"],
[lang="ko"] {
  font-family: var(--i18n-font-cjk) !important;
  --i18n-font-scale: 1.1 !important;
  --i18n-line-height-scale: 1.4 !important;
  --i18n-letter-spacing: 0.01em !important;
}

/* Деванагари и индийские языки */
[lang="hi"],
[lang="mr"],
[lang="ne"],
[lang="sa"] {
  font-family: var(--i18n-font-devanagari) !important;
  --i18n-font-scale: 1.08 !important;
  --i18n-line-height-scale: 1.25 !important;
}

/* ==================== АДАПТИВНАЯ ТИПОГРАФИКА ==================== */

.i18n-optimized {
  font-size: calc(var(--font-size-base) * var(--i18n-font-scale, 1.0)) !important;
  line-height: calc(var(--line-height-base) * var(--i18n-line-height-scale, 1.0)) !important;
  letter-spacing: var(--i18n-letter-spacing, normal) !important;
  text-align: var(--i18n-text-align) !important;
}

/* Оптимизация для языков с сложной типографикой */
[lang="ar"],
[lang="fa"],
[lang="ur"] {
  /* Арабская типографика требует особого подхода */
  line-height: 1.8 !important;
  word-spacing: 0.1em !important;
}

[lang="th"] {
  /* Тайский язык имеет сложные диакритические знаки */
  line-height: 2.0 !important;
}

[lang="zh"],
[lang="ja"] {
  /* Китайский и японский требуют больше вертикального пространства */
  line-height: 1.8 !important;
  text-spacing: ideograph-alpha 0.25em !important;
}

/* ==================== ВЕРТИКАЛЬНОЕ ПИСЬМО ==================== */

[writing-mode="vertical-rl"],
[writing-mode="vertical-lr"] {
  --i18n-dir: vertical !important;
  writing-mode: vertical-rl !important;
  text-orientation: mixed !important;
  
  .workspace-tabs {
    flex-direction: column !important;
  }
  
  .workspace-split.mod-horizontal {
    flex-direction: column !important;
  }
  
  .cm-editor .cm-content {
    writing-mode: vertical-rl !important;
  }
}

/* Японский вертикальный текст */
[lang="ja"][writing-mode="vertical"] {
  text-combine-upright: all !important;
  text-orientation: upright !important;
}

/* ==================== СИСТЕМА ДАТ И ВРЕМЕНИ ==================== */

/* Адаптация форматов дат */
.i18n-date-short {
  font-variant-numeric: tabular-nums !important;
}

[lang="en-US"] .i18n-date-short::after {
  content: " (US)" !important;
  font-size: 0.8em !important;
  opacity: 0.7 !important;
}

[lang="de-DE"] .i18n-date-short::after {
  content: " (DE)" !important;
  font-size: 0.8em !important;
  opacity: 0.7 !important;
}

/* Календарные системы */
[data-calendar="gregorian"] {
  --calendar-first-day: 0 !important; /* Sunday */
}

[data-calendar="islamic"] {
  --calendar-first-day: 6 !important; /* Saturday */
}

[data-calendar="hebrew"] {
  --calendar-first-day: 0 !important; /* Sunday */
}

/* ==================== МНОГОЯЗЫЧНЫЙ КОНТЕНТ ==================== */

/* Смешанное направление текста */
.i18n-bidirectional {
  unicode-bidi: isolate !important;
}

/* Языковые переключатели в контенте */
.lang-switch {
  display: inline-block !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-sm) !important;
  padding: 2px 6px !important;
  font-size: 0.8em !important;
  font-weight: var(--font-weight-medium) !important;
  color: var(--accent-primary) !important;
  margin: 0 4px !important;
  vertical-align: super !important;
}

/* Подсветка языка кода */
[data-code-lang]::before {
  content: attr(data-code-lang) !important;
  display: inline-block !important;
  background: var(--accent-primary) !important;
  color: white !important;
  padding: 2px 8px !important;
  font-size: 0.7em !important;
  font-weight: var(--font-weight-bold) !important;
  border-radius: var(--radius-sm) !important;
  margin-right: 8px !important;
  text-transform: uppercase !important;
}

[dir="rtl"] [data-code-lang]::before {
  margin-right: 0 !important;
  margin-left: 8px !important;
}

/* ==================== КУЛЬТУРНЫЕ ОСОБЕННОСТИ ==================== */

/* Цветовые ассоциации */
[data-culture="western"] {
  --semantic-success: #28a745 !important;
  --semantic-warning: #ffc107 !important;
  --semantic-error: #dc3545 !important;
}

[data-culture="eastern"] {
  --semantic-success: #4CAF50 !important;
  --semantic-warning: #FF9800 !important;
  --semantic-error: #F44336 !important;
}

[data-culture="middle-eastern"] {
  --semantic-success: #009688 !important;
  --semantic-warning: #FF5722 !important;
  --semantic-error: #E91E63 !important;
}

/* Символика и иконки */
[data-culture="western"] .icon-success::before {
  content: "✓" !important;
}

[data-culture="eastern"] .icon-success::before {
  content: "○" !important;
}

[data-culture="islamic"] .icon-success::before {
  content: "🕌" !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ЛОКАЛИЗАЦИИ ==================== */

/* CSS Layers для организации i18n */
@layer i18n-base, i18n-languages, i18n-utilities;

@layer i18n-base {
  .i18n-foundation {
    --i18n-version: var(--design-version) !important;
  }
}

@layer i18n-languages {
  /* Языковые специфичные стили */
  [lang="ar"] {
    font-size: calc(1em * 1.15) !important;
  }
  
  [lang="zh"] {
    line-height: 1.8 !important;
  }
}

@layer i18n-utilities {
  .i18n-rtl {
    direction: rtl !important;
  }
  
  .i18n-ltr {
    direction: ltr !important;
  }
}

/* Container Queries для адаптивной локализации */
@container (max-width: 768px) {
  .i18n-mobile-optimized {
    font-size: calc(1em * 0.9) !important;
    line-height: 1.6 !important;
  }
}

/* Система тем для разных культур */
[data-i18n-theme="global"] {
  --i18n-font-scale: 1.0 !important;
  --i18n-line-height-scale: 1.0 !important;
}

[data-i18n-theme="cjk-optimized"] {
  --i18n-font-scale: 1.1 !important;
  --i18n-line-height-scale: 1.4 !important;
}

[data-i18n-theme="arabic-optimized"] {
  --i18n-font-scale: 1.15 !important;
  --i18n-line-height-scale: 1.8 !important;
}

/* ==================== БУДУЩИЕ СТАНДАРТЫ МЕЖДУНАРОДИЗАЦИИ ==================== */

/* Подготовка для CSS Writing Modes Level 4 */
@supports (text-combine-upright: all) {
  .i18n-vertical-optimized {
    text-combine-upright: all !important;
  }
}

@supports (text-spacing: trim-start) {
  .i18n-spacing-optimized {
    text-spacing: trim-start trim-end space-start trim-adjacent !important;
  }
}

/* Подготовка для CSS Text Level 4 */
@supports (hanging-punctuation: first) {
  .i18n-punctuation-optimized {
    hanging-punctuation: first last allow-end !important;
  }
}

/* CSS Houdini для кастомной локализации */
@supports (background: paint(i18n-underline)) {
  .i18n-houdini-enhanced {
    --i18n-engine: houdini !important;
  }
}

/* ==================== ПРОИЗВОДИТЕЛЬНОСТЬ И ОПТИМИЗАЦИЯ ==================== */

/* Ленивая загрузка шрифтов для разных языков */
.i18n-font-loader {
  font-display: swap !important;
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

/* Оптимизация для языков с сложной рендерингом */
[lang="ar"],
[lang="fa"],
[lang="th"] {
  text-rendering: optimizeSpeed !important;
  -webkit-font-smoothing: antialiased !important;
}

/* ==================== ИНСТРУМЕНТЫ РАЗРАБОТЧИКА ==================== */

/* Отладочные утилиты для локализации */
.i18n-debug-lang::after {
  content: " [" attr(lang) "]" !important;
  font-size: 0.7em !important;
  opacity: 0.6 !important;
  color: var(--accent-primary) !important;
}

.i18n-debug-dir::after {
  content: " [dir: " attr(dir) "]" !important;
  font-size: 0.7em !important;
  opacity: 0.6 !important;
  color: var(--accent-secondary) !important;
}

/* Визуализация текстового направления */
.i18n-visual-dir {
  position: relative !important;
}

.i18n-visual-dir[dir="ltr"]::before {
  content: "→" !important;
  position: absolute !important;
  left: -20px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  color: var(--accent-primary) !important;
}

.i18n-visual-dir[dir="rtl"]::before {
  content: "←" !important;
  position: absolute !important;
  right: -20px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  color: var(--accent-primary) !important;
}

/* Тестовые утилиты */
.i18n-test-mixed::before {
  content: "Hello مرحبا 你好" !important;
  display: block !important;
  padding: 8px !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-sm) !important;
  margin: 8px 0 !important;
  font-family: var(--i18n-font-latin), var(--i18n-font-arabic), var(--i18n-font-cjk) !important;
}

/* ==================== СОВМЕСТИМОСТЬ И FALLBACKS ==================== */

/* Graceful degradation для старых браузеров */
.i18n-fallback {
  font-family: system-ui, sans-serif !important;
  line-height: 1.5 !important;
}

@supports (font-variation-settings: "wdth" 100) {
  .i18n-fallback-enhanced {
    font-family: var(--i18n-font-latin) !important;
  }
}

/* Аварийные режимы для сложных языков */
.i18n-emergency {
  font-family: system-ui, sans-serif !important;
  line-height: 1.6 !important;
  font-size: 16px !important;
}

/* Автоматическое определение языка */
.i18n-auto-detect:lang(ar) {
  font-family: var(--i18n-font-arabic) !important;
  direction: rtl !important;
}

.i18n-auto-detect:lang(zh) {
  font-family: var(--i18n-font-cjk) !important;
}

/* ==================== ИНТЕГРАЦИЯ С ВНЕШНИМИ СИСТЕМАМИ ==================== */

/* Поддержка CLDR (Common Locale Data Repository) */
[data-cldr-locale="en-US"] {
  --i18n-date-format: "MM/DD/YYYY" !important;
  --i18n-time-format: "h:mm A" !important;
  --i18n-number-separator: "," !important;
  --i18n-decimal-separator: "." !important;
}

[data-cldr-locale="de-DE"] {
  --i18n-date-format: "DD.MM.YYYY" !important;
  --i18n-time-format: "HH:mm" !important;
  --i18n-number-separator: "." !important;
  --i18n-decimal-separator: "," !important;
}

[data-cldr-locale="ar-SA"] {
  --i18n-date-format: "DD/MM/YYYY" !important;
  --i18n-time-format: "HH:mm" !important;
  --i18n-number-separator: "," !important;
  --i18n-decimal-separator: "." !important;
}

/* Интеграция с ICU MessageFormat */
.i18n-message-format {
  font-variant-numeric: contextual !important;
}

/* ==========================================================================
   Конец универсальной системы международной поддержки
   ========================================================================== */
   
   /* ==========================================================================
   Экспериментальные функции и будущие стандарты Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ЭКСПЕРИМЕНТАЛЬНЫХ ФУНКЦИЙ ==================== */

:root {
  /* Флаги экспериментальных функций */
  --experimental-version: '2.1.0' !important;
  --experimental-css-nesting: true !important;
  --experimental-container-queries: true !important;
  --experimental-view-transitions: true !important;
  --experimental-scroll-driven: true !important;
  --experimental-houdini: false !important;
  
  /* Переменные для будущих стандартов */
  --future-css-color-5: oklch !important;
  --future-css-animation-4: scroll-timeline !important;
  --future-css-layout-4: subgrid !important;
  --future-css-typography-4: text-wrap-balance !important;
}

/* ==================== CSS NESTING (LEVEL 4) ==================== */

/* Нативная вложенность CSS */
.experimental-nesting {
  /* Базовые стили */
  background: var(--background-primary);
  border-radius: var(--radius-md);
  padding: var(--size-4);
  
  /* Вложенные селекторы */
  & .nested-element {
    color: var(--accent-primary);
    margin: var(--size-2) 0;
    
    &:hover {
      background: color-mix(in oklch, var(--accent-primary), transparent 90%);
      transform: translateX(4px);
    }
    
    &[data-state="active"] {
      border-left: 3px solid var(--accent-primary);
      padding-left: var(--size-3);
    }
  }
  
  /* Медиа-запросы внутри вложенности */
  @media (max-width: 768px) {
    padding: var(--size-3);
    
    & .nested-element {
      font-size: var(--font-size-sm);
    }
  }
  
  /* Поддержка контейнерных запроссов внутри */
  @container (max-width: 400px) {
    flex-direction: column;
    
    & .nested-element {
      width: 100%;
    }
  }
}

/* ==================== CONTAINER QUERIES (LEVEL 3) ==================== */

/* Система контейнерных запросов */
.experimental-container {
  container-type: inline-size !important;
  container-name: experimental-component !important;
}

/* Запросы к конкретным контейнерам */
@container experimental-component (min-width: 600px) {
  .container-responsive {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: var(--size-4) !important;
  }
}

@container experimental-component (max-width: 400px) {
  .container-responsive {
    flex-direction: column !important;
    
    & > * {
      width: 100% !important;
    }
  }
}

/* Запросы к стилю контейнера */
@container style(--experimental-theme: dark) {
  .theme-aware-component {
    background: color-mix(in oklch, black, transparent 10%) !important;
    color: white !important;
  }
}

/* ==================== VIEW TRANSITIONS API ==================== */

/* Система переходов между состояниями */
.experimental-view-transitions {
  view-transition-name: experimental-element !important;
}

/* Кастомные анимации переходов */
@view-transition {
  navigation: auto !important;
}

::view-transition-old(experimental-element) {
  animation: fade-out-scale 0.3s ease-in !important;
}

::view-transition-new(experimental-element) {
  animation: fade-in-scale 0.3s ease-out !important;
}

@keyframes fade-out-scale {
  to {
    opacity: 0;
    transform: scale(0.8);
  }
}

@keyframes fade-in-scale {
  from {
    opacity: 0;
    transform: scale(1.2);
  }
}

/* Групповые переходы */
.view-transition-group {
  view-transition-name: group-transition !important;
}

::view-transition-group(group-transition) {
  animation-duration: 0.5s !important;
}

/* ==================== SCROLL-DRIVEN ANIMATIONS ==================== */

/* Анимации, управляемые скроллом */
.experimental-scroll-animations {
  animation-timeline: scroll() !important;
  animation-range: entry 0% cover 50% !important;
}

/* Конкретные временные линии */
@scroll-timeline --page-scroll {
  source: auto !important;
  orientation: vertical !important;
  time-range: 1s !important;
}

.scroll-progress-indicator {
  animation: progress-indicator linear !important;
  animation-timeline: --page-scroll !important;
}

@keyframes progress-indicator {
  from { transform: scaleX(0); }
  to { transform: scaleX(1); }
}

/* View-timeline анимации */
.experimental-view-timeline {
  animation: reveal linear !important;
  animation-timeline: view() !important;
  animation-range: entry 10% cover 30% !important;
}

@keyframes reveal {
  from {
    opacity: 0;
    transform: translateY(50px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ==================== CSS ANCHOR POSITIONING ==================== */

/* Система привязки позиций */
.experimental-anchor {
  position: absolute !important;
  position-anchor: --tooltip-anchor !important;
  inset: anchor(top) !important;
}

.anchor-target {
  anchor-name: --tooltip-anchor !important;
}

/* Сложные привязки */
.popover-anchored {
  position: absolute !important;
  position-anchor: --popover-anchor !important;
  
  /* Привязка к конкретным сторонам */
  top: anchor(bottom) !important;
  left: anchor(left) !important;
  right: anchor(right) !important;
}

/* ==================== ADVANCED COLOR FUNCTIONS (LEVEL 5) ==================== */

/* Новые цветовые пространства */
.experimental-color-oklch {
  color: oklch(70% 0.15 270) !important;
  background: oklch(20% 0.05 270 / 0.9) !important;
}

.experimental-color-display-p3 {
  color: color(display-p3 1 0.4 0.6) !important;
  background: color(display-p3 0.1 0.2 0.3 / 0.8) !important;
}

/* Relative color syntax */
.experimental-relative-color {
  --base-color: #ff6b9d !important;
  color: rgb(from var(--base-color) r g b / 0.8) !important;
  background: oklch(from var(--base-color) l c h / 0.2) !important;
}

/* Color mixing с новыми режимами */
.experimental-color-mix {
  background: color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  border: 1px solid color-mix(in srgb, var(--accent-primary), black 30%) !important;
}

/* ==================== ADVANCED TYPOGRAPHY (LEVEL 4) ==================== */

/* Балансировка текста */
.experimental-text-wrap {
  text-wrap: balance !important;
  text-wrap: pretty !important;
}

/* Продвинутая система переносов */
.experimental-hyphenation {
  hyphenate-limit-chars: 6 3 3 !important;
  hyphenate-limit-lines: 2 !important;
  hyphenate-limit-zone: 8% !important;
  hyphenate-limit-last: always !important;
}

/* Свисающая пунктуация */
.experimental-hanging-punct {
  hanging-punctuation: first last allow-end !important;
}

/* ==================== CSS HOUDINI EXPERIMENTS ==================== */

/* Кастомные свойства с типами */
@property --experimental-progress {
  syntax: '<number>' !important;
  inherits: false !important;
  initial-value: 0 !important;
}

@property --experimental-color {
  syntax: '<color>' !important;
  inherits: true !important;
  initial-value: #000000 !important;
}

/* Paint API worklets */
.experimental-paint-worklet {
  background: paint(experimental-gradient) !important;
  --gradient-colors: var(--accent-primary), var(--accent-secondary) !important;
  --gradient-angle: 45deg !important;
}

/* Layout API */
.experimental-layout-worklet {
  display: layout(experimental-masonry) !important;
  --masonry-columns: 3 !important;
  --masonry-gap: 10px !important;
}

/* Animation API */
.experimental-animation-worklet {
  animation: experimental-scroll-linked linear !important;
  animation-timeline: scroll() !important;
}

/* ==================== ADVANCED SELECTORS (LEVEL 4) ==================== */

/* :has() родительские селекторы */
.experimental-has-selector:has(.important-content) {
  border: 2px solid var(--semantic-warning) !important;
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
}

/* :is() и :where() для специфичности */
.experimental-is-where {
  &:is(.header, .footer, .sidebar) {
    background: var(--background-primary-alt) !important;
  }
  
  &:where(.button, .link, .action) {
    cursor: pointer !important;
  }
}

/* :focus-visible для умного фокуса */
.experimental-focus-visible:focus-visible {
  outline: 2px solid var(--accent-primary) !important;
  outline-offset: 2px !important;
}

/* ==================== GRID LEVEL 3 FEATURES ==================== */

/* Subgrid поддержка */
.experimental-subgrid {
  display: grid !important;
  grid-template-columns: subgrid !important;
  grid-template-rows: subgrid !important;
}

/* Masonry layout */
.experimental-masonry {
  display: grid !important;
  grid-template-rows: masonry !important;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)) !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ЭКСПЕРИМЕНТОВ ==================== */

/* CSS Layers для экспериментальных функций */
@layer experimental-base, experimental-apis, experimental-future;

@layer experimental-base {
  .experimental-foundation {
    --experimental-version: var(--design-version) !important;
  }
}

@layer experimental-apis {
  .experimental-api {
    /* API-специфичные стили */
  }
}

@layer experimental-future {
  .experimental-future {
    /* Стили для будущих стандартов */
  }
}

/* Система флагов для экспериментальных функций */
[data-experimental-features="all"] {
  --experimental-css-nesting: true !important;
  --experimental-container-queries: true !important;
  --experimental-view-transitions: true !important;
  --experimental-scroll-driven: true !important;
}

[data-experimental-features="none"] {
  --experimental-css-nesting: false !important;
  --experimental-container-queries: false !important;
  --experimental-view-transitions: false !important;
  --experimental-scroll-driven: false !important;
}

/* Progressive enhancement для экспериментальных функций */
.experimental-fallback {
  /* Базовая функциональность */
}

@supports (selector(:has(*))) {
  .experimental-fallback-enhanced {
    /* Улучшенная функциональность с :has() */
  }
}

/* ==================== БУДУЩИЕ СТАНДАРТЫ CSS ==================== */

/* CSS Scope (Level 1) */
@scope (.experimental-scope) to (.scope-boundary) {
  .scoped-element {
    background: var(--accent-primary) !important;
  }
}

/* CSS Cascade Layers (Level 1) */
@layer reset, base, theme, components, utilities;

/* CSS Color Adjust (Level 1) */
@media (prefers-color-scheme: dark) {
  .color-scheme-aware {
    color-scheme: dark light !important;
  }
}

/* CSS Environment Variables */
.experimental-env-vars {
  padding-top: env(safe-area-inset-top) !important;
  padding-bottom: env(safe-area-inset-bottom) !important;
}

/* ==================== ЭКСПЕРИМЕНТАЛЬНЫЕ ИНТЕРФЕЙСЫ ==================== */

/* 3D трансформации и перспектива */
.experimental-3d {
  transform-style: preserve-3d !important;
  perspective: 1000px !important;
  
  & .card-3d {
    transform: rotateY(var(--rotate-y, 0)) rotateX(var(--rotate-x, 0)) !important;
    transition: transform 0.3s ease !important;
  }
}

/* Glass morphism эффекты */
.experimental-glass {
  background: color-mix(in oklch, var(--background-primary), transparent 20%) !important;
  backdrop-filter: blur(20px) saturate(180%) !important;
  border: 1px solid color-mix(in oklch, white, transparent 80%) !important;
}

/* Неонные glow эффекты */
.experimental-neon {
  text-shadow: 
    0 0 5px currentColor,
    0 0 10px currentColor,
    0 0 15px currentColor !important;
  animation: neon-pulse 2s ease-in-out infinite !important;
}

/* ==================== ИНСТРУМЕНТЫ РАЗРАБОТЧИКА ==================== */

/* Отладочные утилиты для экспериментов */
.experimental-debug::before {
  content: "🔬 EXPERIMENTAL" !important;
  display: block !important;
  background: var(--semantic-warning) !important;
  color: black !important;
  padding: 4px 8px !important;
  font-size: 0.7em !important;
  font-weight: bold !important;
  border-radius: var(--radius-sm) !important;
  margin-bottom: 8px !important;
}

/* Тестовые утилиты */
.experimental-test-grid {
  background-image: 
    linear-gradient(rgba(255, 0, 0, 0.1) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255, 0, 0, 0.1) 1px, transparent 1px) !important;
  background-size: 8px 8px !important;
}

/* Визуализация экспериментальных функций */
.experimental-visual-timeline {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  height: 3px !important;
  background: var(--gradient-primary) !important;
  transform-origin: left !important;
  animation: timeline-progress linear !important;
  animation-timeline: scroll() !important;
}

/* ==================== СОВМЕСТИМОСТЬ И МИГРАЦИЯ ==================== */

/* Graceful degradation */
.experimental-graceful {
  /* Базовая функциональность */
}

@supports (container-type: inline-size) {
  .experimental-graceful-enhanced {
    /* Улучшенная функциональность с Container Queries */
  }
}

/* Полифиллы и fallbacks */
.experimental-polyfill {
  /* Стили для браузеров без поддержки */
}

@supports not (container-type: inline-size) {
  .experimental-polyfill-fallback {
    /* Альтернативные стили */
  }
}

/* Система миграции */
[data-experimental-migration="v2.1"] {
  --migration-compatibility: true !important;
}

/* ==================== ПРОИЗВОДИТЕЛЬНОСТЬ ЭКСПЕРИМЕНТОВ ==================== */

/* Оптимизация тяжелых экспериментальных функций */
.experimental-performance {
  contain: layout style paint !important;
  will-change: transform !important;
}

/* Ленивая загрузка экспериментальных стилей */
@media (prefers-reduced-motion: no-preference) {
  .experimental-heavy {
    animation: experimental-reveal 0.5s ease-out !important;
  }
}

/* Отключение экспериментов на слабых устройствах */
@media (max-width: 768px) {
  .experimental-mobile-optimized {
    --experimental-scroll-driven: false !important;
    --experimental-view-transitions: false !important;
  }
}

/* ==========================================================================
   Конец системы экспериментальных функций и будущих стандартов
   ========================================================================== */
   
   /* ==========================================================================
   Модульная система компонентов и утилит Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== АТОМАРНАЯ СИСТЕМА ДИЗАЙН-ТОКЕНОВ ==================== */

:root {
  /* Система версионирования */
  --system-version: '2.1.0' !important;
  --system-namespace: 'dn' !important;
  
  /* Атомарные размеры (8px grid) */
  --size-px: 1px !important;
  --size-0: 0 !important;
  --size-1: 0.25rem !important;  /* 4px */
  --size-2: 0.5rem !important;   /* 8px */
  --size-3: 0.75rem !important;  /* 12px */
  --size-4: 1rem !important;     /* 16px */
  --size-5: 1.25rem !important;  /* 20px */
  --size-6: 1.5rem !important;   /* 24px */
  --size-8: 2rem !important;     /* 32px */
  --size-10: 2.5rem !important;  /* 40px */
  --size-12: 3rem !important;    /* 48px */
  --size-16: 4rem !important;    /* 64px */
  --size-20: 5rem !important;    /* 80px */
  --size-24: 6rem !important;    /* 96px */
  
  /* Атомарные скругления */
  --radius-none: 0 !important;
  --radius-xs: 0.125rem !important;  /* 2px */
  --radius-sm: 0.25rem !important;   /* 4px */
  --radius-md: 0.375rem !important;  /* 6px */
  --radius-lg: 0.5rem !important;    /* 8px */
  --radius-xl: 0.75rem !important;   /* 12px */
  --radius-2xl: 1rem !important;     /* 16px */
  --radius-3xl: 1.5rem !important;   /* 24px */
  --radius-full: 50% !important;
  
  /* Атомарные тени */
  --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05) !important;
  --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1) !important;
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1) !important;
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1) !important;
  --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1) !important;
  
  /* Атомарные z-index */
  --z-auto: auto !important;
  --z-0: 0 !important;
  --z-10: 10 !important;
  --z-20: 20 !important;
  --z-30: 30 !important;
  --z-40: 40 !important;
  --z-50: 50 !important;
}

/* ==================== УТИЛИТАРНЫЕ КЛАССЫ АТОМАРНОГО УРОВНЯ ==================== */

/* Display Utilities */
.d-block { display: block !important; }
.d-inline { display: inline !important; }
.d-inline-block { display: inline-block !important; }
.d-flex { display: flex !important; }
.d-inline-flex { display: inline-flex !important; }
.d-grid { display: grid !important; }
.d-inline-grid { display: inline-grid !important; }
.d-none { display: none !important; }

/* Flexbox Utilities */
.flex-row { flex-direction: row !important; }
.flex-col { flex-direction: column !important; }
.flex-wrap { flex-wrap: wrap !important; }
.flex-nowrap { flex-wrap: nowrap !important; }
.flex-1 { flex: 1 1 0% !important; }
.flex-auto { flex: 1 1 auto !important; }
.flex-none { flex: none !important; }

/* Flex Alignment */
.items-start { align-items: flex-start !important; }
.items-end { align-items: flex-end !important; }
.items-center { align-items: center !important; }
.items-baseline { align-items: baseline !important; }
.items-stretch { align-items: stretch !important; }

.justify-start { justify-content: flex-start !important; }
.justify-end { justify-content: flex-end !important; }
.justify-center { justify-content: center !important; }
.justify-between { justify-content: space-between !important; }
.justify-around { justify-content: space-around !important; }
.justify-evenly { justify-content: space-evenly !important; }

/* Grid Utilities */
.grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)) !important; }
.grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)) !important; }
.grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)) !important; }
.grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)) !important; }
.grid-cols-auto { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)) !important; }

.gap-0 { gap: var(--size-0) !important; }
.gap-1 { gap: var(--size-1) !important; }
.gap-2 { gap: var(--size-2) !important; }
.gap-3 { gap: var(--size-3) !important; }
.gap-4 { gap: var(--size-4) !important; }
.gap-6 { gap: var(--size-6) !important; }
.gap-8 { gap: var(--size-8) !important; }

/* Spacing Utilities - Padding */
.p-0 { padding: var(--size-0) !important; }
.p-1 { padding: var(--size-1) !important; }
.p-2 { padding: var(--size-2) !important; }
.p-3 { padding: var(--size-3) !important; }
.p-4 { padding: var(--size-4) !important; }
.p-6 { padding: var(--size-6) !important; }
.p-8 { padding: var(--size-8) !important; }

.px-0 { padding-left: var(--size-0) !important; padding-right: var(--size-0) !important; }
.px-1 { padding-left: var(--size-1) !important; padding-right: var(--size-1) !important; }
.px-2 { padding-left: var(--size-2) !important; padding-right: var(--size-2) !important; }
.px-3 { padding-left: var(--size-3) !important; padding-right: var(--size-3) !important; }
.px-4 { padding-left: var(--size-4) !important; padding-right: var(--size-4) !important; }

.py-0 { padding-top: var(--size-0) !important; padding-bottom: var(--size-0) !important; }
.py-1 { padding-top: var(--size-1) !important; padding-bottom: var(--size-1) !important; }
.py-2 { padding-top: var(--size-2) !important; padding-bottom: var(--size-2) !important; }
.py-3 { padding-top: var(--size-3) !important; padding-bottom: var(--size-3) !important; }
.py-4 { padding-top: var(--size-4) !important; padding-bottom: var(--size-4) !important; }

/* Spacing Utilities - Margin */
.m-0 { margin: var(--size-0) !important; }
.m-1 { margin: var(--size-1) !important; }
.m-2 { margin: var(--size-2) !important; }
.m-3 { margin: var(--size-3) !important; }
.m-4 { margin: var(--size-4) !important; }
.m-6 { margin: var(--size-6) !important; }
.m-8 { margin: var(--size-8) !important; }

.mx-0 { margin-left: var(--size-0) !important; margin-right: var(--size-0) !important; }
.mx-1 { margin-left: var(--size-1) !important; margin-right: var(--size-1) !important; }
.mx-2 { margin-left: var(--size-2) !important; margin-right: var(--size-2) !important; }
.mx-3 { margin-left: var(--size-3) !important; margin-right: var(--size-3) !important; }
.mx-4 { margin-left: var(--size-4) !important; margin-right: var(--size-4) !important; }
.mx-auto { margin-left: auto !important; margin-right: auto !important; }

.my-0 { margin-top: var(--size-0) !important; margin-bottom: var(--size-0) !important; }
.my-1 { margin-top: var(--size-1) !important; margin-bottom: var(--size-1) !important; }
.my-2 { margin-top: var(--size-2) !important; margin-bottom: var(--size-2) !important; }
.my-3 { margin-top: var(--size-3) !important; margin-bottom: var(--size-3) !important; }
.my-4 { margin-top: var(--size-4) !important; margin-bottom: var(--size-4) !important; }

/* ==================== МОЛЕКУЛЯРНЫЕ КОМПОНЕНТЫ ==================== */

/* Button Component */
.btn {
  /* Atomic Properties */
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: var(--size-2) !important;
  padding: var(--size-2) var(--size-4) !important;
  border: 1px solid transparent !important;
  border-radius: var(--radius-md) !important;
  font-weight: var(--font-weight-medium) !important;
  font-size: var(--font-size-sm) !important;
  text-decoration: none !important;
  cursor: pointer !important;
  transition: all var(--animation-duration-fast) var(--ease-out) !important;
  user-select: none !important;
  
  /* Focus Management */
  &:focus-visible {
    outline: 2px solid var(--accent-primary) !important;
    outline-offset: 2px !important;
  }
  
  /* States */
  &:disabled {
    opacity: 0.5 !important;
    cursor: not-allowed !important;
    pointer-events: none !important;
  }
}

/* Button Variants */
.btn-primary {
  background: var(--accent-primary) !important;
  color: white !important;
  border-color: var(--accent-primary) !important;
  
  &:hover {
    background: color-mix(in oklch, var(--accent-primary), black 15%) !important;
    border-color: color-mix(in oklch, var(--accent-primary), black 15%) !important;
    transform: translateY(-1px) !important;
  }
}

.btn-secondary {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  color: var(--accent-primary) !important;
  border-color: color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  
  &:hover {
    background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
    border-color: color-mix(in oklch, var(--accent-primary), transparent 60%) !important;
  }
}

.btn-ghost {
  background: transparent !important;
  color: var(--text-normal) !important;
  border-color: transparent !important;
  
  &:hover {
    background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  }
}

/* Button Sizes */
.btn-sm {
  padding: var(--size-1) var(--size-3) !important;
  font-size: var(--font-size-xs) !important;
}

.btn-lg {
  padding: var(--size-3) var(--size-6) !important;
  font-size: var(--font-size-base) !important;
}

/* Card Component */
.card {
  /* Atomic Properties */
  background: var(--background-primary) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-6) !important;
  box-shadow: var(--shadow-sm) !important;
  transition: all var(--animation-duration-normal) var(--ease-out) !important;
  
  /* Interactive States */
  &:hover {
    border-color: color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
    box-shadow: var(--shadow-md) !important;
    transform: translateY(-2px) !important;
  }
}

.card-header {
  margin-bottom: var(--size-4) !important;
  padding-bottom: var(--size-3) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.card-title {
  color: var(--accent-primary) !important;
  font-weight: var(--font-weight-semibold) !important;
  font-size: var(--font-size-lg) !important;
  margin: 0 !important;
}

.card-content {
  color: var(--text-normal) !important;
  line-height: var(--line-height-relaxed) !important;
}

/* Badge Component */
.badge {
  /* Atomic Properties */
  display: inline-flex !important;
  align-items: center !important;
  padding: var(--size-1) var(--size-3) !important;
  border-radius: var(--radius-full) !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-medium) !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
  white-space: nowrap !important;
}

/* Badge Variants */
.badge-primary {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  color: var(--accent-primary) !important;
}

.badge-success {
  background: color-mix(in oklch, var(--semantic-success), transparent 90%) !important;
  color: var(--semantic-success) !important;
}

.badge-warning {
  background: color-mix(in oklch, var(--semantic-warning), transparent 90%) !important;
  color: var(--semantic-warning) !important;
}

.badge-error {
  background: color-mix(in oklch, var(--semantic-error), transparent 90%) !important;
  color: var(--semantic-error) !important;
}

/* Alert Component */
.alert {
  /* Atomic Properties */
  padding: var(--size-4) !important;
  border-radius: var(--radius-md) !important;
  border-left: 4px solid transparent !important;
  margin: var(--size-4) 0 !important;
}

/* Alert Variants */
.alert-info {
  background: color-mix(in oklch, var(--semantic-info), transparent 95%) !important;
  border-left-color: var(--semantic-info) !important;
  color: var(--text-normal) !important;
}

.alert-warning {
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
  border-left-color: var(--semantic-warning) !important;
  color: var(--text-normal) !important;
}

.alert-error {
  background: color-mix(in oklch, var(--semantic-error), transparent 95%) !important;
  border-left-color: var(--semantic-error) !important;
  color: var(--text-normal) !important;
}

.alert-success {
  background: color-mix(in oklch, var(--semantic-success), transparent 95%) !important;
  border-left-color: var(--semantic-success) !important;
  color: var(--text-normal) !important;
}

/* ==================== ОРГАНИЗМНЫЕ КОМПОНЕНТЫ ==================== */

/* Navigation Component */
.nav {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-4) !important;
  padding: var(--size-4) !important;
  background: var(--background-primary-alt) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.nav-brand {
  font-weight: var(--font-weight-bold) !important;
  font-size: var(--font-size-lg) !important;
  color: var(--accent-primary) !important;
  text-decoration: none !important;
}

.nav-menu {
  display: flex !important;
  gap: var(--size-2) !important;
  margin-left: auto !important;
}

.nav-item {
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  color: var(--text-muted) !important;
  text-decoration: none !important;
  transition: all var(--animation-duration-fast) var(--ease-out) !important;
  
  &:hover {
    background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
    color: var(--text-normal) !important;
  }
  
  &.active {
    background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
    color: var(--accent-primary) !important;
  }
}

/* Sidebar Component */
.sidebar {
  width: 280px !important;
  background: var(--background-primary-alt) !important;
  border-right: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  padding: var(--size-4) !important;
  display: flex !important;
  flex-direction: column !important;
  gap: var(--size-4) !important;
}

.sidebar-section {
  display: flex !important;
  flex-direction: column !important;
  gap: var(--size-2) !important;
}

.sidebar-title {
  font-size: var(--font-size-sm) !important;
  font-weight: var(--font-weight-semibold) !important;
  color: var(--text-muted) !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
  margin-bottom: var(--size-2) !important;
}

/* Modal Component */
.modal-overlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background: rgba(0, 0, 0, 0.5) !important;
  backdrop-filter: blur(4px) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  z-index: var(--z-index-modal-backdrop) !important;
}

.modal-content {
  background: var(--background-primary) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-6) !important;
  box-shadow: var(--shadow-xl) !important;
  max-width: 500px !important;
  width: 90vw !important;
  max-height: 90vh !important;
  overflow-y: auto !important;
  position: relative !important;
  z-index: var(--z-index-modal) !important;
}

.modal-header {
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
  margin-bottom: var(--size-4) !important;
}

.modal-title {
  font-size: var(--font-size-xl) !important;
  font-weight: var(--font-weight-bold) !important;
  color: var(--accent-primary) !important;
  margin: 0 !important;
}

.modal-close {
  background: none !important;
  border: none !important;
  padding: var(--size-2) !important;
  border-radius: var(--radius-md) !important;
  cursor: pointer !important;
  color: var(--text-muted) !important;
  transition: all var(--animation-duration-fast) var(--ease-out) !important;
  
  &:hover {
    background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
    color: var(--text-normal) !important;
  }
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА КОМПОНЕНТОВ ==================== */

/* CSS Layers для организации компонентов */
@layer components-base, components-molecules, components-organisms;

@layer components-base {
  .component-foundation {
    --component-version: var(--system-version) !important;
  }
}

@layer components-molecules {
  .btn,
  .card,
  .badge,
  .alert {
    --molecule-version: '1.0' !important;
  }
}

@layer components-organisms {
  .nav,
  .sidebar,
  .modal {
    --organism-version: '1.0' !important;
  }
}

/* Container Queries для адаптивных компонентов */
@container (max-width: 400px) {
  .nav {
    flex-direction: column !important;
    gap: var(--size-2) !important;
  }
  
  .nav-menu {
    margin-left: 0 !important;
    width: 100% !important;
    justify-content: center !important;
  }
}

/* Система тем для компонентов */
[data-component-theme="minimal"] {
  --radius-md: var(--radius-sm) !important;
  --shadow-sm: none !important;
}

[data-component-theme="elevated"] {
  --shadow-sm: var(--shadow-md) !important;
  --border-opacity: 0.3 !important;
}

[data-component-theme="glass"] {
  background: color-mix(in oklch, var(--background-primary), transparent 20%) !important;
  backdrop-filter: blur(20px) !important;
  border: 1px solid color-mix(in oklch, white, transparent 80%) !important;
}

/* ==================== БУДУЩИЕ СТАНДАРТЫ ДЛЯ КОМПОНЕНТОВ ==================== */

/* Подготовка для CSS Scope */
@scope (.component-scope) to (.scope-boundary) {
  .scoped-component {
    background: var(--accent-primary) !important;
  }
}

/* Подготовка для CSS Anchor Positioning */
.component-anchored {
  position: absolute !important;
  position-anchor: --component-anchor !important;
}

.anchor-target {
  anchor-name: --component-anchor !important;
}

/* CSS Houdini для кастомных компонентов */
@supports (background: paint(custom-component)) {
  .houdini-component {
    --component-engine: houdini !important;
  }
}

/* ==================== УТИЛИТЫ ДЛЯ РАЗРАБОТЧИКОВ ==================== */

/* Отладочные утилиты компонентов */
.component-debug {
  outline: 2px dashed color-mix(in oklch, var(--accent-primary), transparent 50%) !important;
  position: relative !important;
}

.component-debug::before {
  content: attr(data-component) !important;
  position: absolute !important;
  top: -20px !important;
  left: 0 !important;
  background: var(--accent-primary) !important;
  color: white !important;
  padding: 2px 6px !important;
  font-size: 0.7em !important;
  border-radius: var(--radius-sm) !important;
  z-index: var(--z-index-tooltip) !important;
}

/* Тестовые утилиты */
.component-test-grid {
  background-image: 
    linear-gradient(rgba(255, 0, 0, 0.1) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255, 0, 0, 0.1) 1px, transparent 1px) !important;
  background-size: 8px 8px !important;
}

/* Визуализация компонентной структуры */
.component-structure::before {
  content: "🧩 COMPONENT" !important;
  display: block !important;
  background: var(--accent-primary) !important;
  color: white !important;
  padding: 4px 8px !important;
  font-size: 0.8em !important;
  font-weight: bold !important;
  border-radius: var(--radius-sm) !important;
  margin-bottom: 8px !important;
}

/* ==================== ПРОИЗВОДИТЕЛЬНОСТЬ И ОПТИМИЗАЦИЯ ==================== */

/* Оптимизация компонентов */
.component-optimized {
  contain: layout style !important;
  will-change: transform !important;
}

/* Ленивая загрузка тяжелых компонентов */
@media (prefers-reduced-motion: no-preference) {
  .component-heavy {
    animation: fadeIn var(--animation-duration-normal) ease-out !important;
  }
}

/* Оптимизация для мобильных устройств */
@media (max-width: 768px) {
  .component-mobile-optimized {
    --padding-base: var(--size-3) !important;
    --font-size-base: var(--font-size-sm) !important;
  }
}

/* ==================== СОВМЕСТИМОСТЬ И МИГРАЦИЯ ==================== */

/* Graceful degradation для компонентов */
.component-fallback {
  /* Базовая функциональность */
}

@supports (container-type: inline-size) {
  .component-fallback-enhanced {
    /* Улучшенная функциональность */
  }
}

/* Система миграции компонентов */
[data-component-migration="v2.1"] {
  --migration-compatibility: true !important;
}

/* ==========================================================================
   Конец модульной системы компонентов и утилит
   ========================================================================== */
   
   /* ==========================================================================
   Расширенная система тем и кастомизации Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== ДИНАМИЧЕСКАЯ СИСТЕМА ТЕМ ==================== */

:root {
  /* Система версионирования тем */
  --theme-version: '2.1.0' !important;
  --theme-namespace: 'dn-theme' !important;
  
  /* Динамические цветовые схемы */
  --theme-hue-primary: 335 !important;
  --theme-hue-secondary: 190 !important;
  --theme-hue-tertiary: 270 !important;
  --theme-saturation: 100% !important;
  --theme-lightness: 65% !important;
  
  /* Динамические акцентные цвета */
  --theme-accent-primary: hsl(
    var(--theme-hue-primary),
    var(--theme-saturation),
    var(--theme-lightness)
  ) !important;
  
  --theme-accent-secondary: hsl(
    var(--theme-hue-secondary),
    var(--theme-saturation),
    calc(var(--theme-lightness) + 10%)
  ) !important;
  
  --theme-accent-tertiary: hsl(
    var(--theme-hue-tertiary),
    calc(var(--theme-saturation) - 20%),
    calc(var(--theme-lightness) + 5%)
  ) !important;
  
  /* Динамические семантические цвета */
  --theme-semantic-success: hsl(145, 100%, 65%) !important;
  --theme-semantic-warning: hsl(45, 100%, 65%) !important;
  --theme-semantic-error: hsl(0, 100%, 65%) !important;
  --theme-semantic-info: hsl(190, 100%, 75%) !important;
  
  /* Система плотности интерфейса */
  --theme-density: normal !important;
  --theme-spacing-scale: 1 !important;
  --theme-font-scale: 1 !important;
  --theme-border-scale: 1 !important;
}

/* ==================== ПРЕСЕТЫ ЦВЕТОВЫХ СХЕМ ==================== */

/* Neon Preset (Default) */
[data-theme-preset="neon"] {
  --theme-hue-primary: 335 !important; /* Pink */
  --theme-hue-secondary: 190 !important; /* Cyan */
  --theme-hue-tertiary: 270 !important; /* Purple */
  --theme-saturation: 100% !important;
  --theme-lightness: 65% !important;
}

/* Warm Preset */
[data-theme-preset="warm"] {
  --theme-hue-primary: 25 !important; /* Orange */
  --theme-hue-secondary: 45 !important; /* Yellow */
  --theme-hue-tertiary: 350 !important; /* Red */
  --theme-saturation: 100% !important;
  --theme-lightness: 60% !important;
}

/* Cool Preset */
[data-theme-preset="cool"] {
  --theme-hue-primary: 200 !important; /* Blue */
  --theme-hue-secondary: 160 !important; /* Teal */
  --theme-hue-tertiary: 280 !important; /* Magenta */
  --theme-saturation: 100% !important;
  --theme-lightness: 70% !important;
}

/* Monochrome Preset */
[data-theme-preset="monochrome"] {
  --theme-hue-primary: 0 !important;
  --theme-hue-secondary: 0 !important;
  --theme-hue-tertiary: 0 !important;
  --theme-saturation: 0% !important;
  --theme-lightness: 75% !important;
}

/* Nature Preset */
[data-theme-preset="nature"] {
  --theme-hue-primary: 145 !important; /* Green */
  --theme-hue-secondary: 35 !important; /* Brown */
  --theme-hue-tertiary: 210 !important; /* Sky Blue */
  --theme-saturation: 80% !important;
  --theme-lightness: 55% !important;
}

/* Ocean Preset */
[data-theme-preset="ocean"] {
  --theme-hue-primary: 195 !important; /* Ocean Blue */
  --theme-hue-secondary: 160 !important; /* Sea Green */
  --theme-hue-tertiary: 280 !important; /* Coral */
  --theme-saturation: 90% !important;
  --theme-lightness: 60% !important;
}

/* ==================== СИСТЕМА ПЛОТНОСТИ ИНТЕРФЕЙСА ==================== */

/* Compact Density */
[data-theme-density="compact"] {
  --theme-density: compact !important;
  --theme-spacing-scale: 0.75 !important;
  --theme-font-scale: 0.9 !important;
  --theme-border-scale: 0.8 !important;
}

/* Normal Density (Default) */
[data-theme-density="normal"] {
  --theme-density: normal !important;
  --theme-spacing-scale: 1 !important;
  --theme-font-scale: 1 !important;
  --theme-border-scale: 1 !important;
}

/* Comfortable Density */
[data-theme-density="comfortable"] {
  --theme-density: comfortable !important;
  --theme-spacing-scale: 1.25 !important;
  --theme-font-scale: 1.1 !important;
  --theme-border-scale: 1.2 !important;
}

/* Spacious Density */
[data-theme-density="spacious"] {
  --theme-density: spacious !important;
  --theme-spacing-scale: 1.5 !important;
  --theme-font-scale: 1.2 !important;
  --theme-border-scale: 1.4 !important;
}

/* ==================== СИСТЕМА РЕЖИМОВ ОТОБРАЖЕНИЯ ==================== */

/* Light Mode */
[data-theme-mode="light"] {
  --background-primary: oklch(98% 0.02 var(--theme-hue-primary)) !important;
  --background-primary-alt: oklch(95% 0.02 var(--theme-hue-primary)) !important;
  --background-secondary: oklch(92% 0.03 var(--theme-hue-primary)) !important;
  --text-normal: oklch(15% 0.05 var(--theme-hue-primary)) !important;
  --text-muted: oklch(35% 0.04 var(--theme-hue-primary)) !important;
  --text-faint: oklch(55% 0.03 var(--theme-hue-primary)) !important;
}

/* Dark Mode (Default) */
[data-theme-mode="dark"] {
  --background-primary: oklch(15% 0.02 var(--theme-hue-primary)) !important;
  --background-primary-alt: oklch(12% 0.02 var(--theme-hue-primary)) !important;
  --background-secondary: oklch(18% 0.03 var(--theme-hue-primary)) !important;
  --text-normal: oklch(95% 0.01 var(--theme-hue-primary)) !important;
  --text-muted: oklch(75% 0.02 var(--theme-hue-primary)) !important;
  --text-faint: oklch(55% 0.03 var(--theme-hue-primary)) !important;
}

/* High Contrast Mode */
[data-theme-mode="high-contrast"] {
  --background-primary: #000000 !important;
  --background-primary-alt: #111111 !important;
  --background-secondary: #222222 !important;
  --text-normal: #ffffff !important;
  --text-muted: #cccccc !important;
  --text-faint: #999999 !important;
  --theme-accent-primary: #ffff00 !important;
}

/* Sepia Mode */
[data-theme-mode="sepia"] {
  --background-primary: #f8f0e0 !important;
  --background-primary-alt: #f0e6d0 !important;
  --background-secondary: #e8dcc0 !important;
  --text-normal: #5c4b37 !important;
  --text-muted: #7d6b57 !important;
  --text-faint: #9e8c77 !important;
  filter: sepia(0.3) !important;
}

/* ==================== СИСТЕМА КОНТЕКСТНЫХ ТЕМ ==================== */

/* Writing Context */
[data-theme-context="writing"] {
  --theme-font-family: 'Georgia', 'Times New Roman', serif !important;
  --theme-font-size: 1.1em !important;
  --theme-line-height: 1.8 !important;
  --theme-max-width: 700px !important;
}

/* Coding Context */
[data-theme-context="coding"] {
  --theme-font-family: 'JetBrains Mono', 'Fira Code', monospace !important;
  --theme-font-size: 0.95em !important;
  --theme-line-height: 1.5 !important;
  --theme-accent-primary: var(--theme-semantic-info) !important;
}

/* Research Context */
[data-theme-context="research"] {
  --theme-accent-primary: var(--theme-accent-secondary) !important;
  --theme-font-family: 'Inter', system-ui, sans-serif !important;
}

/* Presentation Context */
[data-theme-context="presentation"] {
  --theme-density: spacious !important;
  --theme-font-scale: 1.3 !important;
  --theme-max-width: 100% !important;
}

/* ==================== ДИНАМИЧЕСКИЕ КОМПОНЕНТЫ ТЕМ ==================== */

/* Theme-aware компоненты с динамическими свойствами */
.theme-component {
  /* Динамические spacing */
  padding: calc(var(--size-4) * var(--theme-spacing-scale)) !important;
  margin: calc(var(--size-2) * var(--theme-spacing-scale)) !important;
  gap: calc(var(--size-2) * var(--theme-spacing-scale)) !important;
  
  /* Динамические типографика */
  font-size: calc(var(--font-size-base) * var(--theme-font-scale)) !important;
  line-height: calc(var(--line-height-base) * var(--theme-font-scale)) !important;
  
  /* Динамические borders */
  border-radius: calc(var(--radius-md) * var(--theme-border-scale)) !important;
  border-width: calc(1px * var(--theme-border-scale)) !important;
}

/* Theme-aware кнопки */
.btn-theme-aware {
  background: var(--theme-accent-primary) !important;
  color: white !important;
  border: 1px solid var(--theme-accent-primary) !important;
  padding: calc(var(--size-2) * var(--theme-spacing-scale)) calc(var(--size-4) * var(--theme-spacing-scale)) !important;
  border-radius: calc(var(--radius-md) * var(--theme-border-scale)) !important;
  font-size: calc(var(--font-size-sm) * var(--theme-font-scale)) !important;
  
  &:hover {
    background: color-mix(in oklch, var(--theme-accent-primary), black 15%) !important;
  }
}

/* Theme-aware карточки */
.card-theme-aware {
  background: var(--background-primary) !important;
  border: 1px solid color-mix(in oklch, var(--theme-accent-primary), transparent 90%) !important;
  border-radius: calc(var(--radius-lg) * var(--theme-border-scale)) !important;
  padding: calc(var(--size-6) * var(--theme-spacing-scale)) !important;
  box-shadow: var(--shadow-sm) !important;
}

/* ==================== СИСТЕМА КАСТОМИЗАЦИИ ==================== */

/* CSS Properties для кастомных свойств */
@property --custom-accent-hue {
  syntax: '<number>';
  inherits: true;
  initial-value: 335;
}

@property --custom-accent-saturation {
  syntax: '<percentage>';
  inherits: true;
  initial-value: 100%;
}

@property --custom-accent-lightness {
  syntax: '<percentage>';
  inherits: true;
  initial-value: 65%;
}

/* Кастомная цветовая схема */
[data-theme-custom="true"] {
  --theme-hue-primary: var(--custom-accent-hue, 335) !important;
  --theme-saturation: var(--custom-accent-saturation, 100%) !important;
  --theme-lightness: var(--custom-accent-lightness, 65%) !important;
}

/* Система кастомных CSS переменных */
.theme-custom-properties {
  --custom-background-image: none !important;
  --custom-background-blur: 0px !important;
  --custom-background-saturation: 100% !important;
  --custom-border-style: solid !important;
  --custom-animation-duration: 0.3s !important;
}

/* Применение кастомных свойств */
[data-custom-background="true"] {
  background-image: var(--custom-background-image) !important;
  backdrop-filter: 
    blur(var(--custom-background-blur))
    saturate(var(--custom-background-saturation)) !important;
}

[data-custom-borders="true"] {
  border-style: var(--custom-border-style) !important;
}

[data-custom-animations="true"] {
  transition-duration: var(--custom-animation-duration) !important;
  animation-duration: var(--custom-animation-duration) !important;
}

/* ==================== СИСТЕМА ПЛАВНЫХ ПЕРЕХОДОВ ТЕМ ==================== */

/* Плавные переходы между темами */
.theme-transition {
  transition: 
    background-color 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    color 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    border-color 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    box-shadow 0.5s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

/* View Transitions для смены тем */
@view-transition {
  navigation: auto !important;
}

::view-transition-old(root),
::view-transition-new(root) {
  animation-duration: 0.5s !important;
}

/* Анимации смены цветовой схемы */
@keyframes theme-switch-fade {
  from {
    opacity: 0.7;
    transform: scale(0.98);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.theme-switch-active {
  animation: theme-switch-fade 0.3s ease-out !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ТЕМ ==================== */

/* CSS Layers для организации тем */
@layer themes-base, themes-presets, themes-contexts, themes-custom;

@layer themes-base {
  .theme-foundation {
    --theme-version: var(--system-version) !important;
  }
}

@layer themes-presets {
  [data-theme-preset] {
    /* Пресет-специфичные стили */
  }
}

@layer themes-contexts {
  [data-theme-context] {
    /* Контекст-специфичные стили */
  }
}

@layer themes-custom {
  [data-theme-custom] {
    /* Кастомные стили */
  }
}

/* Container Queries для адаптивных тем */
@container (max-width: 768px) {
  .theme-mobile-optimized {
    --theme-spacing-scale: 0.9 !important;
    --theme-font-scale: 0.95 !important;
  }
}

/* Система миграции тем */
[data-theme-migration="v2.1"] {
  --theme-compatibility: true !important;
}

/* ==================== БУДУЩИЕ СТАНДАРТЫ ДЛЯ ТЕМ ==================== */

/* Подготовка для CSS Color Level 5 */
@supports (color: oklch(0% 0 0)) {
  .theme-color-modern {
    --theme-accent-primary: oklch(
      var(--theme-lightness) 
      0.2 
      var(--theme-hue-primary)
    ) !important;
  }
}

/* Подготовка для CSS Relative Colors */
@supports (color: rgb(from red r g b)) {
  .theme-relative-colors {
    --theme-accent-secondary: oklch(
      from var(--theme-accent-primary)
      l
      calc(c * 0.8)
      calc(h + 60)
    ) !important;
  }
}

/* CSS Houdini для кастомных тем */
@supports (background: paint(theme-generator)) {
  .theme-houdini-enhanced {
    --theme-engine: houdini !important;
  }
}

/* ==================== ИНСТРУМЕНТЫ РАЗРАБОТЧИКА ДЛЯ ТЕМ ==================== */

/* Визуализация темы */
.theme-debug::before {
  content: "🎨 THEME: " attr(data-theme-preset) " | " attr(data-theme-mode) " | " attr(data-theme-density) !important;
  display: block !important;
  background: var(--theme-accent-primary) !important;
  color: white !important;
  padding: 8px 12px !important;
  font-size: 0.8em !important;
  font-weight: bold !important;
  border-radius: var(--radius-md) !important;
  margin-bottom: 12px !important;
  font-family: monospace !important;
}

/* Палитра цветов темы */
.theme-palette {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)) !important;
  gap: var(--size-2) !important;
  margin: var(--size-4) 0 !important;
}

.theme-color-swatch {
  height: 60px !important;
  border-radius: var(--radius-md) !important;
  display: flex !important;
  align-items: end !important;
  justify-content: center !important;
  padding: var(--size-2) !important;
  font-size: 0.7em !important;
  font-weight: bold !important;
  color: white !important;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5) !important;
}

/* Тестовые утилиты для тем */
.theme-test-contrast {
  outline: 2px solid red !important;
  position: relative !important;
}

.theme-test-contrast::after {
  content: "CONTRAST: " attr(data-contrast-ratio) !important;
  position: absolute !important;
  top: -20px !important;
  left: 0 !important;
  background: red !important;
  color: white !important;
  padding: 2px 6px !important;
  font-size: 0.7em !important;
  border-radius: var(--radius-sm) !important;
}

/* ==================== ПРОИЗВОДИТЕЛЬНОСТЬ И ОПТИМИЗАЦИЯ ТЕМ ==================== */

/* Оптимизация переключения тем */
.theme-optimized {
  contain: layout style !important;
  will-change: background-color, color, border-color !important;
}

/* Ленивая загрузка тяжелых тем */
@media (prefers-reduced-motion: no-preference) {
  .theme-heavy {
    transition: all 0.5s ease-out !important;
  }
}

/* Отключение анимаций для слабых устройств */
@media (prefers-reduced-motion: reduce) {
  .theme-transition {
    transition: none !important;
  }
}

/* ==================== СОВМЕСТИМОСТЬ И МИГРАЦИЯ ТЕМ ==================== */

/* Graceful degradation для тем */
.theme-fallback {
  /* Базовая цветовая схема */
  --theme-accent-primary: #ff6b9d !important;
  --theme-accent-secondary: #a3eeff !important;
}

@supports (color: hsl(var(--hue) var(--saturation) var(--lightness))) {
  .theme-fallback-enhanced {
    /* Улучшенная динамическая схема */
  }
}

/* Система fallback для старых браузеров */
.theme-legacy-support {
  background: var(--fallback-background) !important;
  color: var(--fallback-text) !important;
}

/* ==================== ЭКСПОРТ И ИМПОРТ ТЕМ ==================== */

/* Система сериализации тем */
.theme-export {
  /* Стили для экспорта темы */
}

.theme-import {
  /* Стили для импорта темы */
}

/* Генератор CSS переменных для экспорта */
.theme-variables-export::before {
  content: "/* Theme Variables Export */ :root { " attr(data-theme-variables) " }" !important;
  display: block !important;
  font-family: monospace !important;
  white-space: pre !important;
  background: #f5f5f5 !important;
  padding: var(--size-4) !important;
  border-radius: var(--radius-md) !important;
  margin: var(--size-4) 0 !important;
  border-left: 4px solid var(--theme-accent-primary) !important;
}

/* ==========================================================================
   Конец расширенной системы тем и кастомизации
   ========================================================================== */
   
   /* ==========================================================================
   Комплексная система документации и разработки Dark Nebula
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ДОКУМЕНТАЦИИ ==================== */

:root {
  /* Переменные документации */
  --docs-version: '2.1.0' !important;
  --docs-namespace: 'dn-docs' !important;
  --docs-mode: 'development' !important;
  
  /* Цвета для документации */
  --docs-color-note: var(--semantic-info) !important;
  --docs-color-tip: var(--semantic-success) !important;
  --docs-color-warning: var(--semantic-warning) !important;
  --docs-color-danger: var(--semantic-error) !important;
  --docs-color-info: var(--accent-secondary) !important;
}

/* ==================== КОМПОНЕНТЫ ДОКУМЕНТАЦИИ ==================== */

/* Callout блоки для документации */
.docs-callout {
  border-left: 4px solid transparent !important;
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  border-radius: var(--radius-md) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  position: relative !important;
}

.docs-callout-note {
  border-left-color: var(--docs-color-note) !important;
  background: color-mix(in oklch, var(--docs-color-note), transparent 95%) !important;
}

.docs-callout-tip {
  border-left-color: var(--docs-color-tip) !important;
  background: color-mix(in oklch, var(--docs-color-tip), transparent 95%) !important;
}

.docs-callout-warning {
  border-left-color: var(--docs-color-warning) !important;
  background: color-mix(in oklch, var(--docs-color-warning), transparent 95%) !important;
}

.docs-callout-danger {
  border-left-color: var(--docs-color-danger) !important;
  background: color-mix(in oklch, var(--docs-color-danger), transparent 95%) !important;
}

.docs-callout-title {
  font-weight: var(--font-weight-semibold) !important;
  font-size: var(--font-size-sm) !important;
  margin-bottom: var(--size-2) !important;
  display: flex !important;
  align-items: center !important;
  gap: var(--size-2) !important;
}

/* Code блоки с подсветкой */
.docs-code-block {
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  overflow-x: auto !important;
  position: relative !important;
}

.docs-code-block::before {
  content: attr(data-language) !important;
  position: absolute !important;
  top: 0 !important;
  right: 0 !important;
  background: var(--accent-primary) !important;
  color: white !important;
  padding: var(--size-1) var(--size-3) !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-bold) !important;
  border-bottom-left-radius: var(--radius-md) !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
}

.docs-inline-code {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  color: var(--accent-primary) !important;
  padding: var(--size-1) var(--size-2) !important;
  border-radius: var(--radius-sm) !important;
  font-family: var(--font-family-mono) !important;
  font-size: 0.9em !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
}

/* Компонент свойств API */
.docs-api-property {
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-md) !important;
  padding: var(--size-4) !important;
  margin: var(--size-3) 0 !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
}

.docs-api-header {
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
  margin-bottom: var(--size-3) !important;
  padding-bottom: var(--size-2) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.docs-api-name {
  font-family: var(--font-family-mono) !important;
  font-weight: var(--font-weight-bold) !important;
  color: var(--accent-primary) !important;
  font-size: var(--font-size-lg) !important;
}

.docs-api-type {
  background: color-mix(in oklch, var(--accent-secondary), transparent 90%) !important;
  color: var(--accent-secondary) !important;
  padding: var(--size-1) var(--size-2) !important;
  border-radius: var(--radius-sm) !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-bold) !important;
}

.docs-api-description {
  color: var(--text-normal) !important;
  line-height: var(--line-height-relaxed) !important;
  margin-bottom: var(--size-3) !important;
}

.docs-api-default {
  background: color-mix(in oklch, var(--text-muted), transparent 95%) !important;
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-sm) !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-sm) !important;
  border-left: 3px solid var(--text-muted) !important;
}

/* ==================== ИНТЕРАКТИВНАЯ ДОКУМЕНТАЦИЯ ==================== */

/* Live примеры кода */
.docs-live-example {
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  margin: var(--size-4) 0 !important;
  overflow: hidden !important;
}

.docs-live-preview {
  padding: var(--size-6) !important;
  background: var(--background-primary) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  min-height: 100px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

.docs-live-controls {
  background: color-mix(in oklch, var(--background-primary-alt), transparent 10%) !important;
  padding: var(--size-3) var(--size-4) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.docs-live-tabs {
  display: flex !important;
  gap: var(--size-2) !important;
}

.docs-live-tab {
  background: transparent !important;
  border: 1px solid transparent !important;
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-sm) !important;
  color: var(--text-muted) !important;
  cursor: pointer !important;
  transition: all var(--animation-duration-fast) var(--ease-out) !important;
  font-size: var(--font-size-sm) !important;
  
  &.active {
    background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
    border-color: color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
    color: var(--accent-primary) !important;
  }
}

/* Интерактивная палитра цветов */
.docs-color-palette {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
  gap: var(--size-4) !important;
  margin: var(--size-6) 0 !important;
}

.docs-color-card {
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  overflow: hidden !important;
  background: var(--background-primary) !important;
  transition: all var(--animation-duration-normal) var(--ease-out) !important;
  
  &:hover {
    transform: translateY(-2px) !important;
    box-shadow: var(--shadow-md) !important;
  }
}

.docs-color-swatch {
  height: 80px !important;
  position: relative !important;
  cursor: pointer !important;
}

.docs-color-info {
  padding: var(--size-3) !important;
}

.docs-color-name {
  font-weight: var(--font-weight-semibold) !important;
  color: var(--text-normal) !important;
  margin-bottom: var(--size-1) !important;
}

.docs-color-value {
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-xs) !important;
  color: var(--text-muted) !important;
}

/* ==================== СИСТЕМА РАЗРАБОТКИ И ОТЛАДКИ ==================== */

/* Режим разработки */
[data-env="development"] {
  --docs-mode: 'development' !important;
}

[data-env="production"] {
  --docs-mode: 'production' !important;
}

/* Dev-only компоненты */
.docs-dev-only {
  display: none !important;
}

[data-env="development"] .docs-dev-only {
  display: block !important;
}

/* Debug панель */
.docs-debug-panel {
  position: fixed !important;
  bottom: var(--size-4) !important;
  right: var(--size-4) !important;
  background: color-mix(in oklch, var(--background-primary), black 10%) !important;
  backdrop-filter: blur(20px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  z-index: var(--z-index-tooltip) !important;
  box-shadow: var(--shadow-xl) !important;
  max-width: 300px !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-xs) !important;
}

.docs-debug-title {
  font-weight: var(--font-weight-bold) !important;
  color: var(--accent-primary) !important;
  margin-bottom: var(--size-2) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
}

.docs-debug-close {
  background: none !important;
  border: none !important;
  color: var(--text-muted) !important;
  cursor: pointer !important;
  padding: var(--size-1) !important;
  border-radius: var(--radius-sm) !important;
  
  &:hover {
    background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
    color: var(--text-normal) !important;
  }
}

.docs-debug-info {
  color: var(--text-normal) !important;
  line-height: 1.4 !important;
}

.docs-debug-item {
  display: flex !important;
  justify-content: between !important;
  margin-bottom: var(--size-1) !important;
}

.docs-debug-label {
  color: var(--text-muted) !important;
}

.docs-debug-value {
  color: var(--accent-primary) !important;
  font-weight: var(--font-weight-medium) !important;
}

/* Инструменты инспекции */
.docs-inspect-mode * {
  outline: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  position: relative !important;
}

.docs-inspect-mode *:hover::before {
  content: attr(class) !important;
  position: absolute !important;
  top: -20px !important;
  left: 0 !important;
  background: var(--accent-primary) !important;
  color: white !important;
  padding: 2px 6px !important;
  font-size: 0.7em !important;
  border-radius: var(--radius-sm) !important;
  z-index: var(--z-index-tooltip) !important;
  font-family: var(--font-family-mono) !important;
  white-space: nowrap !important;
}

/* ==================== СИСТЕМА ТЕСТИРОВАНИЯ ==================== */

/* Визуальные тесты */
.docs-visual-test {
  border: 2px dashed color-mix(in oklch, var(--accent-primary), transparent 50%) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  border-radius: var(--radius-md) !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 98%) !important;
}

.docs-test-title {
  font-weight: var(--font-weight-bold) !important;
  color: var(--accent-primary) !important;
  margin-bottom: var(--size-3) !important;
  display: flex !important;
  align-items: center !important;
  gap: var(--size-2) !important;
}

.docs-test-grid {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
  gap: var(--size-4) !important;
  padding: var(--size-4) !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border-radius: var(--radius-md) !important;
}

/* Тесты доступности */
.docs-a11y-test {
  border: 2px solid color-mix(in oklch, var(--semantic-warning), transparent 50%) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  border-radius: var(--radius-md) !important;
  background: color-mix(in oklch, var(--semantic-warning), transparent 98%) !important;
}

.docs-a11y-check {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-2) !important;
  padding: var(--size-2) !important;
  border-radius: var(--radius-sm) !important;
  margin-bottom: var(--size-1) !important;
  
  &.pass {
    background: color-mix(in oklch, var(--semantic-success), transparent 95%) !important;
    color: var(--semantic-success) !important;
  }
  
  &.fail {
    background: color-mix(in oklch, var(--semantic-error), transparent 95%) !important;
    color: var(--semantic-error) !important;
  }
  
  &.warning {
    background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
    color: var(--semantic-warning) !important;
  }
}

/* ==================== СИСТЕМА ВЕРСИОНИРОВАНИЯ И МИГРАЦИИ ==================== */

/* Компонент версионирования */
.docs-version-badge {
  display: inline-flex !important;
  align-items: center !important;
  gap: var(--size-1) !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  color: var(--accent-primary) !important;
  padding: var(--size-1) var(--size-2) !important;
  border-radius: var(--radius-full) !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-bold) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
}

.docs-deprecation-notice {
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-warning), transparent 80%) !important;
  border-radius: var(--radius-md) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  position: relative !important;
}

.docs-deprecation-notice::before {
  content: "⚠️ DEPRECATED" !important;
  position: absolute !important;
  top: -10px !important;
  left: var(--size-4) !important;
  background: var(--semantic-warning) !important;
  color: black !important;
  padding: 2px 8px !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-bold) !important;
  border-radius: var(--radius-sm) !important;
}

/* Миграционные guide */
.docs-migration-guide {
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  overflow: hidden !important;
  margin: var(--size-6) 0 !important;
}

.docs-migration-step {
  padding: var(--size-4) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  display: flex !important;
  gap: var(--size-4) !important;
  align-items: start !important;
  
  &:last-child {
    border-bottom: none !important;
  }
}

.docs-step-number {
  background: var(--accent-primary) !important;
  color: white !important;
  width: 32px !important;
  height: 32px !important;
  border-radius: 50% !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  font-weight: var(--font-weight-bold) !important;
  flex-shrink: 0 !important;
}

.docs-step-content {
  flex: 1 !important;
}

.docs-step-title {
  font-weight: var(--font-weight-semibold) !important;
  color: var(--accent-primary) !important;
  margin-bottom: var(--size-2) !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ДОКУМЕНТАЦИИ ==================== */

/* CSS Layers для документации */
@layer docs-base, docs-components, docs-interactive, docs-development;

@layer docs-base {
  .docs-foundation {
    --docs-version: var(--system-version) !important;
  }
}

@layer docs-components {
  .docs-callout,
  .docs-code-block,
  .docs-api-property {
    --docs-component-version: '1.0' !important;
  }
}

@layer docs-interactive {
  .docs-live-example,
  .docs-color-palette {
    --docs-interactive-version: '1.0' !important;
  }
}

@layer docs-development {
  .docs-debug-panel,
  .docs-visual-test {
    --docs-dev-version: '1.0' !important;
  }
}

/* Container Queries для адаптивной документации */
@container (max-width: 768px) {
  .docs-mobile-optimized {
    --docs-spacing-scale: 0.9 !important;
    --docs-font-scale: 0.95 !important;
  }
}

/* Система тем для документации */
[data-docs-theme="minimal"] {
  --docs-border-opacity: 0.1 !important;
  --docs-shadow-strength: 0.05 !important;
}

[data-docs-theme="detailed"] {
  --docs-border-opacity: 0.3 !important;
  --docs-shadow-strength: 0.2 !important;
}

/* ==================== БУДУЩИЕ СТАНДАРТЫ ДЛЯ ДОКУМЕНТАЦИИ ==================== */

/* Подготовка для CSS Custom Properties API */
@property --docs-accent-color {
  syntax: '<color>';
  inherits: true;
  initial-value: #ff6b9d;
}

@supports (background: paint(docs-highlight)) {
  .docs-houdini-enhanced {
    --docs-engine: houdini !important;
  }
}

/* Подготовка для CSS View Transitions */
@view-transition {
  navigation: auto !important;
}

.docs-page-transition {
  view-transition-name: docs-content !important;
}

/* ==================== ИНСТРУМЕНТЫ АВТОМАТИЗАЦИИ ==================== */

/* Автогенерация документации */
.docs-auto-generated::before {
  content: "🤖 AUTO-GENERATED" !important;
  display: block !important;
  background: var(--accent-secondary) !important;
  color: white !important;
  padding: 4px 8px !important;
  font-size: 0.7em !important;
  font-weight: bold !important;
  border-radius: var(--radius-sm) !important;
  margin-bottom: 8px !important;
  text-align: center !important;
}

/* Система сниппетов */
.docs-snippet {
  position: relative !important;
}

.docs-snippet-copy {
  position: absolute !important;
  top: var(--size-2) !important;
  right: var(--size-2) !important;
  background: color-mix(in oklch, var(--background-primary), transparent 20%) !important;
  backdrop-filter: blur(10px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-sm) !important;
  padding: var(--size-1) var(--size-2) !important;
  font-size: var(--font-size-xs) !important;
  color: var(--text-muted) !important;
  cursor: pointer !important;
  transition: all var(--animation-duration-fast) var(--ease-out) !important;
  opacity: 0 !important;
}

.docs-snippet:hover .docs-snippet-copy {
  opacity: 1 !important;
}

.docs-snippet-copy:hover {
  background: var(--accent-primary) !important;
  color: white !important;
  transform: scale(1.05) !important;
}

.docs-snippet-copy.copied {
  background: var(--semantic-success) !important;
  color: white !important;
}

/* ==================== СИСТЕМА ОБРАТНОЙ СВЯЗИ ==================== */

.docs-feedback {
  border-top: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  padding-top: var(--size-4) !important;
  margin-top: var(--size-8) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
  gap: var(--size-4) !important;
}

.docs-feedback-question {
  font-weight: var(--font-weight-medium) !important;
  color: var(--text-normal) !important;
}

.docs-feedback-buttons {
  display: flex !important;
  gap: var(--size-2) !important;
}

.docs-feedback-btn {
  background: transparent !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  color: var(--text-muted) !important;
  cursor: pointer !important;
  transition: all var(--animation-duration-fast) var(--ease-out) !important;
  display: flex !important;
  align-items: center !important;
  gap: var(--size-1) !important;
  
  &:hover {
    background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
    color: var(--accent-primary) !important;
    transform: translateY(-1px) !important;
  }
  
  &.active {
    background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
    border-color: var(--accent-primary) !important;
    color: var(--accent-primary) !important;
  }
}

/* ==========================================================================
   Конец комплексной системы документации и разработки
   ========================================================================== */
   
   /* ==================== ИНТЕЛЛЕКТУАЛЬНАЯ СИСТЕМА RENDER CONTAINMENT ==================== */

.perf-optimized-element {
  /* Базовое containment для стабильности layout */
  contain: var(--perf-contain-strategy) !important;
  content-visibility: auto !important;
  
  /* Динамическое управление рендерингом */
  contain-intrinsic-size: 
    var(--contain-intrinsic-width, auto) 
    var(--contain-intrinsic-height, auto) !important;
}

/* Приоритетный рендеринг активного контента */
.workspace-leaf.mod-active {
  --perf-priority-content: 1 !important;
  z-index: var(--z-index-content) !important;
  
  /* GPU ускорение для активной области */
  transform: translateZ(0) !important;
  will-change: transform, opacity !important;
}

.workspace-leaf:not(.mod-active) {
  --perf-priority-content: 0.7 !important;
  opacity: var(--perf-priority-content) !important;
}

/* Умное скрытие неактивных элементов для экономии ресурсов */
[data-focus-mode="deep"] .workspace-leaf:not(.mod-active) {
  content-visibility: hidden !important;
  contain-intrinsic-size: 0px 100px !important;
}

/* ==================== АДАПТИВНАЯ СИСТЕМА АНИМАЦИЙ ==================== */

/* Динамическое качество анимаций на основе профиля */
.perf-animation-optimized {
  transition-duration: calc(
    var(--animation-duration-normal) * 
    var(--animation-quality-scale, 1)
  ) !important;
  
  animation-duration: calc(
    var(--animation-duration-normal) * 
    var(--animation-quality-scale, 1)
  ) !important;
}

[data-perf-profile="focus"] {
  --animation-quality-scale: 0.7 !important;
}

[data-perf-profile="battery"] {
  --animation-quality-scale: 0.3 !important;
}

/* Отключение несущественных анимаций в режиме фокуса */
[data-perf-profile="focus"] .perf-non-essential-animation {
  animation: none !important;
  transition: none !important;
}

/* ==================== ИНТЕЛЛЕКТУАЛЬНАЯ ЗАГРУЗКА РЕСУРСОВ ==================== */

/* Ленивая загрузка с приоритетами */
.perf-lazy-resource {
  content-visibility: auto !important;
  contain-intrinsic-size: 1px 100px !important;
}

/* Приоритетная загрузка видимого контента */
.perf-priority-content {
  loading: eager !important;
  fetchpriority: high !important;
}

.perf-background-content {
  loading: lazy !important;
  fetchpriority: low !important;
}

/* Адаптивное качество изображений */
.perf-adaptive-image {
  image-rendering: -webkit-optimize-contrast !important;
  image-rendering: crisp-edges !important;
}

[data-perf-profile="focus"] .perf-adaptive-image,
[data-perf-profile="battery"] .perf-adaptive-image {
  image-rendering: auto !important;
  filter: blur(0.3px) !important;
}

/* ==================== ОПТИМИЗАЦИЯ ШРИФТОВ И ТИПОГРАФИКИ ==================== */

.perf-font-optimized {
  font-display: swap !important;
  font-feature-settings: 'kern' 1, 'liga' 1 !important;
}

[data-perf-profile="focus"] .perf-font-optimized {
  font-display: block !important;
}

[data-perf-profile="battery"] .perf-font-optimized {
  font-family: system-ui, sans-serif !important;
  font-feature-settings: normal !important;
}

/* Оптимизация рендеринга текста */
.perf-text-rendering {
  text-rendering: optimizeSpeed !important;
}

[data-perf-profile="balanced"] .perf-text-rendering {
  text-rendering: optimizeLegibility !important;
}

/* ==================== СИСТЕМА ПРЕДЗАГРУЗКИ И КЭШИРОВАНИЯ ==================== */

/* Предзагрузка критических ресурсов */
.perf-preload-critical {
  position: absolute !important;
  width: 0 !important;
  height: 0 !important;
  overflow: hidden !important;
  opacity: 0 !important;
}

/* Интеллектуальное кэширование макетов */
.perf-layout-cache {
  transform: translateZ(0) !important;
  will-change: transform !important;
}

/* ==================== АДАПТИВНАЯ СИСТЕМА СКРОЛЛА ==================== */

.perf-optimized-scroll {
  scroll-behavior: smooth !important;
  -webkit-overflow-scrolling: touch !important;
  scrollbar-gutter: stable !important;
}

/* Виртуальный скролл для больших списков */
.perf-virtual-scroll-container {
  overflow-anchor: auto !important;
  content-visibility: auto !important;
}

.perf-virtual-scroll-item {
  contain-intrinsic-size: 50px !important;
  content-visibility: auto !important;
}

/* ==================== МОНИТОРИНГ И АДАПТАЦИЯ В РЕАЛЬНОМ ВРЕМЕНИ ==================== */

/* Индикаторы производительности для разработки */
.perf-metrics-debug {
  position: fixed !important;
  top: 10px !important;
  left: 10px !important;
  background: rgba(0, 0, 0, 0.9) !important;
  color: #00ff00 !important;
  padding: 8px 12px !important;
  border-radius: 4px !important;
  font-family: monospace !important;
  font-size: 11px !important;
  z-index: var(--z-index-tooltip) !important;
  pointer-events: none !important;
}

/* Адаптация к состоянию устройства */
@media (prefers-reduced-data: reduce) {
  .perf-data-conscious {
    background-image: none !important;
    animation: none !important;
    font-family: system-ui !important;
  }
}

@media (update: slow) {
  .perf-slow-update {
    animation-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
  }
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ДЛЯ БУДУЩИХ ОБНОВЛЕНИЙ ==================== */

/* CSS Layers для организации оптимизаций */
@layer perf-base, perf-strategies, perf-monitoring, perf-future;

@layer perf-base {
  .perf-foundation {
    --perf-api-version: '2.1' !important;
    --perf-compatibility-mode: true !important;
  }
}

@layer perf-strategies {
  .perf-containment-strategy {
    /* Стратегии containment для разных сценариев */
  }
  
  .perf-loading-strategy {
    /* Стратегии загрузки ресурсов */
  }
}

@layer perf-monitoring {
  .perf-metrics-tracker {
    /* Система отслеживания метрик */
  }
}

@layer perf-future {
  /* Подготовка для будущих API */
  .perf-ready-for-future {
    --perf-speculation: 'enabled' !important;
  }
}

/* Container Queries для адаптивной производительности */
@container (max-width: 768px) {
  .perf-mobile-optimized {
    --perf-contain-strategy: layout style !important;
    --animation-quality-scale: 0.8 !important;
  }
}

/* Подготовка для будущих CSS-функций */
@supports (content-visibility: auto) {
  .perf-modern-browser {
    --perf-contain-strategy: layout style paint !important;
  }
}

@supports (animation-timeline: scroll()) {
  .perf-scroll-driven-optimized {
    animation-timeline: scroll() !important;
  }
}

/* Система плагинов для оптимизаций */
.perf-plugin-optimized {
  --plugin-perf-mode: 'optimized' !important;
}

/* ==================== УТИЛИТЫ ДЛЯ РАЗРАБОТЧИКОВ ==================== */

/* Отладочные режимы */
[data-perf-debug="true"] * {
  outline: 1px solid rgba(255, 0, 0, 0.3) !important;
}

.perf-debug-repaint {
  animation: perf-debug-pulse 2s infinite !important;
}

@keyframes perf-debug-pulse {
  0%, 100% { background: transparent; }
  50% { background: rgba(255, 0, 0, 0.1); }
}

/* Тестовые утилиты */
.perf-test-heavy {
  backdrop-filter: blur(100px) !important;
  box-shadow: 0 0 100px rgba(0, 0, 0, 0.5) !important;
}

.perf-test-light {
  backdrop-filter: none !important;
  box-shadow: none !important;
}

/* ==================== СИСТЕМА МИГРАЦИИ И СОВМЕСТИМОСТИ ==================== */

/* Graceful degradation */
.perf-fallback {
  /* Базовая функциональность для всех браузеров */
}

.perf-fallback-enhanced {
  /* Улучшенная функциональность при поддержке */
}

/* Аварийные режимы */
.perf-emergency-mode {
  --perf-contain-strategy: none !important;
  --animation-quality-scale: 0 !important;
  backdrop-filter: none !important;
  filter: none !important;
}

/* Система версионирования */
[data-perf-version="2.1"] {
  --perf-compatibility-mode: true !important;
}

/* ==================== ИНТЕГРАЦИЯ С РЕЖИМАМИ ФОКУСА ==================== */

/* Автоматическое переключение профилей при активации режимов фокуса */
[data-focus-mode="deep"] {
  --perf-profile: 'focus' !important;
}

[data-workspace-mode="presentation"] {
  --perf-profile: 'balanced' !important;
  --perf-priority-content: 1 !important;
  --perf-priority-ui: 0.2 !important;
}

[data-workspace-mode="reading"] {
  --perf-profile: 'balanced' !important;
  --perf-animation-quality: minimal !important;
}

/* ==========================================================================
   КОНЕЦ ПРОДВИНУТОЙ СИСТЕМЫ ПРОИЗВОДИТЕЛЬНОСТИ И ОПТИМИЗАЦИИ
   ========================================================================== */
   
   /* ==========================================================================
   УНИВЕРСАЛЬНАЯ СИСТЕМА ОБРАТНОЙ СОВМЕСТИМОСТИ DARK NEBULA
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ВЕРСИОНИРОВАНИЯ И СОВМЕСТИМОСТИ ==================== */

:root {
  /* Система контроля версий */
  --compat-version: '2.1.0' !important;
  --compat-api-level: '2024' !important;
  --compat-fallback-mode: 'auto' !important;
  --compat-legacy-support: true !important;
  
  /* Уровни поддержки функций */
  --compat-css-grid: true !important;
  --compat-css-variables: true !important;
  --compat-css-contain: false !important;
  --compat-css-clamp: false !important;
  
  /* Адаптивные стратегии */
  --compat-strategy-layout: 'flexbox' !important;
  --compat-strategy-colors: 'hex' !important;
  --compat-strategy-typography: 'system' !important;
}

/* ==================== АВТОМАТИЧЕСКОЕ ОПРЕДЕЛЕНИЕ ВОЗМОЖНОСТЕЙ ==================== */

/* Базовые fallback-переменные для старых браузеров */
:root {
  /* Цветовая палитра fallback */
  --compat-color-primary: #ff6b9d !important;
  --compat-color-secondary: #a3eeff !important;
  --compat-color-background: #1a0b1f !important;
  --compat-color-text: #e0e0e0 !important;
  
  /* Размеры fallback */
  --compat-spacing-unit: 8px !important;
  --compat-font-size-base: 16px !important;
}

/* Progressive enhancement detection */
@supports (display: grid) {
  :root {
    --compat-css-grid: true !important;
    --compat-strategy-layout: 'grid' !important;
  }
}

@supports (--css-variables: true) {
  :root {
    --compat-css-variables: true !important;
  }
}

@supports (contain: layout) {
  :root {
    --compat-css-contain: true !important;
  }
}

@supports (width: clamp(1px, 2px, 3px)) {
  :root {
    --compat-css-clamp: true !important;
  }
}

/* ==================== СТРАТЕГИИ LAYOUT ДЛЯ РАЗНЫХ БРАУЗЕРОВ ==================== */

/* Базовый flexbox fallback для всех браузеров */
.compat-layout-base {
  display: flex !important;
  flex-direction: column !important;
}

/* Grid enhancement при поддержке */
@supports (display: grid) {
  .compat-layout-base {
    display: grid !important;
    grid-template-columns: 1fr !important;
    grid-template-rows: auto 1fr auto !important;
  }
}

/* Container queries fallback система */
.compat-container-base {
  width: 100% !important;
}

@supports (container-type: inline-size) {
  .compat-container-base {
    container-type: inline-size !important;
    container-name: compat-container !important;
  }
}

/* ==================== ЦВЕТОВЫЕ СТРАТЕГИИ СОВМЕСТИМОСТИ ==================== */

/* Modern color spaces с fallback */
.compat-color-primary {
  color: var(--compat-color-primary) !important; /* Fallback для старых браузеров */
  color: oklch(70% 0.15 var(--theme-hue-primary)) !important;
}

.compat-color-background {
  background: var(--compat-color-background) !important;
  background: oklch(15% 0.02 var(--theme-hue-primary)) !important;
}

@supports (color: color(display-p3 1 0 0)) {
  .compat-color-primary {
    color: color(display-p3 1 0.4 0.6) !important;
  }
}

/* Color-mix fallback система */
.compat-color-mix {
  background: color-mix(in srgb, var(--compat-color-primary) 20%, transparent) !important;
}

@supports (background: color-mix(in oklch, red, transparent 50%)) {
  .compat-color-mix {
    background: color-mix(in oklch, var(--accent-primary) 20%, transparent) !important;
  }
}

/* ==================== ТИПОГРАФИЧЕСКАЯ СОВМЕСТИМОСТЬ ==================== */

/* Fluid typography с fallback */
.compat-fluid-text {
  font-size: var(--compat-font-size-base) !important;
  font-size: clamp(
    var(--fluid-text-min),
    calc(var(--fluid-text-min) + (var(--fluid-text-max) - var(--fluid-text-min)) * ((100vw - 320px) / (1440 - 320))),
    var(--fluid-text-max)
  ) !important;
}

/* System font stack для максимальной совместимости */
.compat-font-system {
  font-family: 
    -apple-system, BlinkMacSystemFont, 
    "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell",
    "Fira Sans", "Droid Sans", "Helvetica Neue", 
    sans-serif !important;
}

/* Modern font features с graceful degradation */
.compat-font-features {
  font-feature-settings: 'kern' 1, 'liga' 1 !important;
}

@supports (font-variant-ligatures: common-ligatures) {
  .compat-font-features {
    font-feature-settings: normal !important;
    font-variant-ligatures: common-ligatures !important;
    font-kerning: normal !important;
  }
}

/* ==================== СОВМЕСТИМОСТЬ С OBSIDIAN ВЕРСИЯМИ ==================== */

/* Поддержка старых версий Obsidian */
[data-app-version^="0."] .compat-v1-features {
  /* Упрощенные стили для версий 0.x */
  --compat-strategy-layout: 'flexbox' !important;
  --compat-css-variables: false !important;
}

[data-app-version^="1."] .compat-v1-features {
  /* Полная поддержка для версий 1.x */
  --compat-css-variables: true !important;
  --compat-css-grid: true !important;
}

/* Обнаружение новых API Obsidian */
.compat-modern-api {
  /* Базовые стили для всех версий */
}

@supports (selector(.cm-editor)) {
  .compat-modern-api {
    /* Стили для версий с CodeMirror 6 */
  }
}

/* ==================== СОВМЕСТИМОСТЬ С COMMUNITY-ТЕМАМИ ==================== */

/* Совместимость с популярными темами */
[data-theme*="minimal"] .compat-theme-adaptation {
  --compat-strategy-colors: 'minimal' !important;
}

[data-theme*="atom"] .compat-theme-adaptation {
  --compat-strategy-colors: 'atom' !important;
}

[data-theme*="things"] .compat-theme-adaptation {
  --compat-strategy-colors: 'things' !important;
}

/* Система нейминга для предотвращения конфликтов */
.dn-compat-[component-name] {
  /* Изолированные стили с уникальным неймингом */
}

/* ==================== СТРАТЕГИИ MIGRATION ПУТЕЙ ==================== */

/* Миграция с версии 1.x на 2.x */
.compat-migration-v2 {
  --migration-progress: 0% !important;
  transition: all 0.5s ease !important;
}

/* Поэтапное включение новых функций */
.compat-feature-flag {
  --feature-enabled: false !important;
}

[data-compat-flags*="new-grid"] .compat-feature-flag {
  --feature-enabled: true !important;
}

/* ==================== ADAPTIVE FALLBACK STRATEGIES ==================== */

/* Стратегия для браузеров без CSS переменных */
.compat-no-variables {
  /* Базовые значения для критических стилей */
  background: #1a0b1f !important;
  color: #e0e0e0 !important;
  font-family: sans-serif !important;
}

@supports (--css-variables: true) {
  .compat-no-variables {
    background: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-family: var(--font-family-sans) !important;
  }
}

/* Стратегия для мобильных браузеров */
@media (max-width: 768px) {
  .compat-mobile-fallback {
    --compat-strategy-layout: 'flexbox' !important;
    --compat-css-grid: false !important;
  }
}

/* ==================== СИСТЕМА ОБНАРУЖЕНИЯ ПЛАГИНОВ ==================== */

/* Совместимость с популярными плагинами */
.compat-plugin-calendar {
  /* Стили для календаря с fallback */
}

.compat-plugin-kanban {
  /* Стили для канбан-досок */
}

.compat-plugin-dataview {
  /* Стили для dataview таблиц */
}

/* Автоматическое обнаружение плагинов */
[data-active-plugins*="calendar"] .compat-plugin-detection {
  --plugin-calendar: true !important;
}

[data-active-plugins*="kanban"] .compat-plugin-detection {
  --plugin-kanban: true !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА СОВМЕСТИМОСТИ ==================== */

/* CSS Layers для организации совместимости */
@layer compat-base, compat-fallbacks, compat-enhancements, compat-future;

@layer compat-base {
  .compat-foundation {
    --compat-api-version: '2.1' !important;
    --compat-support-window: '5years' !important;
  }
}

@layer compat-fallbacks {
  .compat-legacy-support {
    /* Стили для legacy браузеров */
  }
  
  .compat-modern-fallback {
    /* Fallback стратегии */
  }
}

@layer compat-enhancements {
  .compat-progressive-enhancement {
    /* Улучшения для современных браузеров */
  }
}

@layer compat-future {
  .compat-future-ready {
    /* Подготовка для будущих стандартов */
  }
}

/* Container queries для адаптивной совместимости */
@container compat-container (max-width: 600px) {
  .compat-responsive-fallback {
    --compat-strategy-layout: 'flexbox' !important;
  }
}

/* Система feature detection */
@supports not (display: grid) {
  .compat-grid-fallback {
    display: flex !important;
    flex-wrap: wrap !important;
  }
}

@supports not (backdrop-filter: blur(10px)) {
  .compat-backdrop-fallback {
    background: rgba(0, 0, 0, 0.8) !important;
  }
}

/* ==================== СИСТЕМА ТЕСТИРОВАНИЯ СОВМЕСТИМОСТИ ==================== */

/* Режим тестирования совместимости */
[data-compat-test="true"] .compat-test-mode {
  outline: 2px solid #ff4444 !important;
}

.compat-test-legacy::before {
  content: "LEGACY BROWSER" !important;
  background: #ff4444 !important;
  color: white !important;
  padding: 4px 8px !important;
  font-size: 0.7em !important;
  border-radius: 4px !important;
}

/* Инструменты для разработчиков */
.compat-debug-panel {
  position: fixed !important;
  bottom: 10px !important;
  right: 10px !important;
  background: rgba(0, 0, 0, 0.9) !important;
  color: white !important;
  padding: 12px !important;
  border-radius: 8px !important;
  font-family: monospace !important;
  font-size: 12px !important;
  z-index: 10000 !important;
}

/* ==================== СИСТЕМА МИГРАЦИИ ДАННЫХ ==================== */

/* Миграция пользовательских настроек */
.compat-settings-migration {
  --migration-state: 'pending' !important;
  transition: all 0.3s ease !important;
}

.compat-settings-migration[data-migrated="true"] {
  --migration-state: 'completed' !important;
}

/* Сохранение пользовательских кастомизаций */
.compat-user-overrides {
  /* Приоритет пользовательских стилей */
  all: unset !important;
}

/* ==================== СОВМЕСТИМОСТЬ С БУДУЩИМИ ВЕРСИЯМИ ==================== */

/* Подготовка для Obsidian API changes */
.compat-future-proof {
  --future-api-version: 'next' !important;
}

/* Система deprecated features */
.compat-deprecated-feature {
  opacity: 0.7 !important;
  border: 1px dashed #ff4444 !important;
}

.compat-deprecated-feature::before {
  content: "DEPRECATED" !important;
  background: #ff4444 !important;
  color: white !important;
  padding: 2px 6px !important;
  font-size: 0.6em !important;
  border-radius: 3px !important;
}

/* ==================== СИСТЕМА ОБРАТНОЙ СВЯЗИ И ДИАГНОСТИКИ ==================== */

/* Диагностика проблем совместимости */
.compat-issue-detector {
  position: relative !important;
}

.compat-issue-detector[data-issue]::after {
  content: attr(data-issue) !important;
  position: absolute !important;
  top: -20px !important;
  left: 0 !important;
  background: #ff4444 !important;
  color: white !important;
  padding: 2px 6px !important;
  font-size: 0.7em !important;
  border-radius: 3px !important;
  white-space: nowrap !important;
}

/* Система отчетов о проблемах */
.compat-feedback-widget {
  position: fixed !important;
  bottom: 20px !important;
  left: 20px !important;
  background: var(--accent-primary) !important;
  color: white !important;
  padding: 8px 12px !important;
  border-radius: 20px !important;
  font-size: 0.8em !important;
  cursor: pointer !important;
  z-index: 1000 !important;
}

/* ==========================================================================
   КОНЕЦ УНИВЕРСАЛЬНОЙ СИСТЕМЫ ОБРАТНОЙ СОВМЕСТИМОСТИ
   ========================================================================== */
   
   /* ==========================================================================
   ВИЗУАЛЬНЫЙ КОНСТРУКТОР ТЕМЫ DARK NEBULA
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ВИЗУАЛЬНОГО КОНСТРУКТОРА ==================== */

:root {
  /* Режим конструктора */
  --builder-mode: 'design' !important; /* design | preview | export */
  --builder-version: '2.1.0' !important;
  --builder-active-panel: 'colors' !important;
  
  /* Состояние конструктора */
  --builder-preview-mode: false !important;
  --builder-live-reload: true !important;
  --builder-undo-steps: 50 !important;
  
  /* Система компонентов конструктора */
  --builder-panel-width: 320px !important;
  --builder-panel-zindex: 10000 !important;
  --builder-overlay-opacity: 0.1 !important;
}

/* ==================== ОСНОВНОЙ ИНТЕРФЕЙС КОНСТРУКТОРА ==================== */

.builder-interface {
  position: fixed !important;
  top: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: var(--builder-panel-width) !important;
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  backdrop-filter: blur(40px) saturate(200%) !important;
  border-left: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  z-index: var(--builder-panel-zindex) !important;
  display: flex !important;
  flex-direction: column !important;
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.builder-interface[data-collapsed="true"] {
  transform: translateX(100%) !important;
}

/* Заголовок конструктора */
.builder-header {
  padding: var(--size-4) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
}

.builder-title {
  font-weight: var(--font-weight-bold) !important;
  color: var(--accent-primary) !important;
  font-size: var(--font-size-lg) !important;
  margin: 0 !important;
}

.builder-controls {
  display: flex !important;
  gap: var(--size-2) !important;
}

/* Основная область конструктора */
.builder-main {
  flex: 1 !important;
  overflow-y: auto !important;
  padding: var(--size-4) !important;
}

/* ==================== СИСТЕМА ВКЛАДОК КОНСТРУКТОРА ==================== */

.builder-tabs {
  display: flex !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  margin-bottom: var(--size-4) !important;
  gap: var(--size-2) !important;
}

.builder-tab {
  background: transparent !important;
  border: none !important;
  padding: var(--size-3) var(--size-4) !important;
  color: var(--text-muted) !important;
  cursor: pointer !important;
  border-radius: var(--radius-md) var(--radius-md) 0 0 !important;
  transition: all 0.2s ease !important;
  font-size: var(--font-size-sm) !important;
  position: relative !important;
}

.builder-tab:hover {
  color: var(--text-normal) !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

.builder-tab.active {
  color: var(--accent-primary) !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 98%) !important;
}

.builder-tab.active::after {
  content: '' !important;
  position: absolute !important;
  bottom: -1px !important;
  left: 0 !important;
  right: 0 !important;
  height: 2px !important;
  background: var(--accent-primary) !important;
  border-radius: 2px 2px 0 0 !important;
}

/* ==================== ПАНЕЛЬ ЦВЕТОВ И ПАЛИТР ==================== */

.builder-colors-panel {
  display: flex !important;
  flex-direction: column !important;
  gap: var(--size-4) !important;
}

/* Палитра цветов */
.builder-color-palette {
  display: grid !important;
  grid-template-columns: repeat(3, 1fr) !important;
  gap: var(--size-3) !important;
  margin-bottom: var(--size-4) !important;
}

.builder-color-swatch {
  aspect-ratio: 1 !important;
  border-radius: var(--radius-md) !important;
  border: 2px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
  position: relative !important;
}

.builder-color-swatch:hover {
  transform: scale(1.05) !important;
  border-color: var(--accent-primary) !important;
}

.builder-color-swatch.active {
  border-color: var(--accent-primary) !important;
  box-shadow: 0 0 0 2px color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
}

.builder-color-swatch::after {
  content: attr(data-name) !important;
  position: absolute !important;
  bottom: -20px !important;
  left: 0 !important;
  right: 0 !important;
  font-size: var(--font-size-xs) !important;
  text-align: center !important;
  color: var(--text-muted) !important;
}

/* Редактор отдельных цветов */
.builder-color-editor {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.builder-color-inputs {
  display: grid !important;
  gap: var(--size-3) !important;
}

.builder-color-slider {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
}

.builder-color-slider label {
  font-size: var(--font-size-sm) !important;
  color: var(--text-normal) !important;
  min-width: 60px !important;
}

.builder-color-slider input[type="range"] {
  flex: 1 !important;
  height: 4px !important;
  border-radius: 2px !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  outline: none !important;
}

/* ==================== РЕДАКТОР ТИПОГРАФИКИ ==================== */

.builder-typography-panel {
  display: flex !important;
  flex-direction: column !important;
  gap: var(--size-4) !important;
}

.builder-font-selector {
  display: grid !important;
  grid-template-columns: 1fr auto !important;
  gap: var(--size-3) !important;
  align-items: center !important;
}

.builder-font-preview {
  padding: var(--size-4) !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border-radius: var(--radius-md) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  min-height: 100px !important;
  font-size: var(--font-size-lg) !important;
  line-height: 1.6 !important;
}

.builder-typography-controls {
  display: grid !important;
  gap: var(--size-3) !important;
}

.builder-typography-slider {
  display: grid !important;
  grid-template-columns: auto 1fr auto !important;
  align-items: center !important;
  gap: var(--size-3) !important;
}

/* ==================== РЕДАКТОР МАКЕТА И SPACING ==================== */

.builder-layout-panel {
  display: flex !important;
  flex-direction: column !important;
  gap: var(--size-4) !important;
}

.builder-spacing-controls {
  display: grid !important;
  gap: var(--size-3) !important;
}

.builder-spacing-visualizer {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  position: relative !important;
  min-height: 120px !important;
}

.builder-spacing-box {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border: 2px dashed color-mix(in oklch, var(--accent-primary), transparent 60%) !important;
  border-radius: var(--radius-md) !important;
  position: absolute !important;
  transition: all 0.3s ease !important;
}

/* ==================== СИСТЕМА ПРЕСЕТОВ И ПРОФИЛЕЙ ==================== */

.builder-presets-panel {
  display: grid !important;
  grid-template-columns: repeat(2, 1fr) !important;
  gap: var(--size-3) !important;
}

.builder-preset-card {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-3) !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
  text-align: center !important;
}

.builder-preset-card:hover {
  transform: translateY(-2px) !important;
  border-color: color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  box-shadow: var(--shadow-md) !important;
}

.builder-preset-card.active {
  border-color: var(--accent-primary) !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

.builder-preset-preview {
  height: 60px !important;
  border-radius: var(--radius-md) !important;
  margin-bottom: var(--size-2) !important;
  background: linear-gradient(135deg, var(--preset-color-1), var(--preset-color-2), var(--preset-color-3)) !important;
}

/* ==================== LIVE PREVIEW СИСТЕМА ==================== */

.builder-preview-overlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: var(--builder-panel-width) !important;
  bottom: 0 !important;
  background: transparent !important;
  z-index: calc(var(--builder-panel-zindex) - 1) !important;
  pointer-events: none !important;
  opacity: var(--builder-overlay-opacity) !important;
  transition: opacity 0.3s ease !important;
}

.builder-preview-overlay.active {
  pointer-events: all !important;
  opacity: 1 !important;
}

.builder-preview-highlight {
  position: absolute !important;
  border: 2px solid var(--accent-primary) !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  border-radius: var(--radius-md) !important;
  pointer-events: none !important;
  z-index: 1000 !important;
}

/* ==================== СИСТЕМА ИСТОРИИ И UNDO/REDO ==================== */

.builder-history-panel {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.builder-history-list {
  max-height: 200px !important;
  overflow-y: auto !important;
  display: flex !important;
  flex-direction: column !important;
  gap: var(--size-2) !important;
}

.builder-history-item {
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  font-size: var(--font-size-sm) !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
}

.builder-history-item:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

.builder-history-item.active {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  color: var(--accent-primary) !important;
}

/* ==================== СИСТЕМА ЭКСПОРТА И ИМПОРТА ==================== */

.builder-export-panel {
  display: flex !important;
  flex-direction: column !important;
  gap: var(--size-4) !important;
}

.builder-export-options {
  display: grid !important;
  gap: var(--size-3) !important;
}

.builder-export-option {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
  padding: var(--size-3) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-md) !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
}

.builder-export-option:hover {
  border-color: color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

.builder-export-code {
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-sm) !important;
  max-height: 200px !important;
  overflow-y: auto !important;
  white-space: pre-wrap !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА КОНСТРУКТОРА ==================== */

/* CSS Layers для организации конструктора */
@layer builder-base, builder-ui, builder-panels, builder-preview, builder-export;

@layer builder-base {
  .builder-foundation {
    --builder-api-version: '2.1' !important;
    --builder-extensible: true !important;
  }
}

@layer builder-ui {
  .builder-interface-components {
    /* Базовые компоненты UI */
  }
}

@layer builder-panels {
  .builder-panel-system {
    /* Система панелей и вкладок */
  }
}

@layer builder-preview {
  .builder-preview-system {
    /* Система live preview */
  }
}

@layer builder-export {
  .builder-export-system {
    /* Система экспорта/импорта */
  }
}

/* Container Queries для адаптивного конструктора */
@container (max-width: 1024px) {
  .builder-responsive {
    --builder-panel-width: 280px !important;
  }
}

@container (max-width: 768px) {
  .builder-responsive {
    --builder-panel-width: 100vw !important;
    right: -100vw !important;
  }
  
  .builder-responsive[data-mobile-open="true"] {
    right: 0 !important;
  }
}

/* Система плагинов для конструктора */
.builder-plugin-slot {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

/* ==================== СИСТЕМА РЕКОМЕНДАЦИЙ И АНАЛИТИКИ ==================== */

.builder-recommendations {
  background: color-mix(in oklch, var(--accent-secondary), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-secondary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.builder-recommendation-item {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
  padding: var(--size-2) 0 !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
}

.builder-recommendation-item:hover {
  color: var(--accent-secondary) !important;
}

.builder-analytics-panel {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.builder-analytics-chart {
  height: 100px !important;
  background: linear-gradient(to top, color-mix(in oklch, var(--accent-primary), transparent 90%), transparent) !important;
  border-radius: var(--radius-md) !important;
  position: relative !important;
}

/* ==================== ИНТЕРАКТИВНЫЕ КОМПОНЕНТЫ КОНСТРУКТОРА ==================== */

.builder-draggable-handle {
  cursor: grab !important;
  padding: var(--size-2) !important;
  border-radius: var(--radius-sm) !important;
  transition: all 0.2s ease !important;
}

.builder-draggable-handle:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

.builder-draggable-handle:active {
  cursor: grabbing !important;
}

.builder-resizable-handle {
  position: absolute !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  transition: all 0.2s ease !important;
}

.builder-resizable-handle:hover {
  background: var(--accent-primary) !important;
}

/* ==================== СИСТЕМА АНИМАЦИЙ И МИКРО-ИНТЕРАКЦИЙ ==================== */

.builder-micro-interaction {
  transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.builder-button-primary {
  background: var(--accent-primary) !important;
  color: white !important;
  border: none !important;
  padding: var(--size-3) var(--size-4) !important;
  border-radius: var(--radius-md) !important;
  cursor: pointer !important;
  font-weight: var(--font-weight-medium) !important;
  transition: all 0.2s ease !important;
}

.builder-button-primary:hover {
  transform: translateY(-1px) !important;
  box-shadow: var(--shadow-md) !important;
}

.builder-tooltip {
  position: absolute !important;
  background: color-mix(in oklch, var(--background-primary), black 10%) !important;
  color: white !important;
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-sm) !important;
  font-size: var(--font-size-xs) !important;
  white-space: nowrap !important;
  z-index: 10001 !important;
  pointer-events: none !important;
}

/* ==================== СИСТЕМА СОХРАНЕНИЯ И ЗАГРУЗКИ ==================== */

.builder-save-system {
  display: flex !important;
  gap: var(--size-3) !important;
  margin-top: var(--size-4) !important;
}

.builder-save-preset {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  color: var(--accent-primary) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  padding: var(--size-3) var(--size-4) !important;
  border-radius: var(--radius-md) !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
}

.builder-save-preset:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.builder-load-system {
  position: relative !important;
}

.builder-file-input {
  position: absolute !important;
  opacity: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

/* ==================== СИСТЕМА КОНТЕКСТНОЙ ПОМОЩИ ==================== */

.builder-help-system {
  position: fixed !important;
  bottom: var(--size-4) !important;
  left: var(--size-4) !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  color: var(--accent-primary) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  border-radius: 50% !important;
  width: 40px !important;
  height: 40px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  cursor: pointer !important;
  z-index: 10000 !important;
  transition: all 0.2s ease !important;
}

.builder-help-system:hover {
  transform: scale(1.1) !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.builder-help-panel {
  position: fixed !important;
  bottom: 80px !important;
  left: var(--size-4) !important;
  width: 300px !important;
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  backdrop-filter: blur(40px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  z-index: 10000 !important;
  box-shadow: var(--shadow-xl) !important;
}

/* ==========================================================================
   КОНЕЦ ВИЗУАЛЬНОГО КОНСТРУКТОРА ТЕМЫ
   ========================================================================== */
   
   
  /* ==========================================================================
   РАСШИРЕННАЯ СИСТЕМА ДОКУМЕНТАЦИИ DARK NEBULA
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ДОКУМЕНТАЦИИ И СПРАВОЧНОЙ СИСТЕМЫ ==================== */

:root {
  /* Режимы документации */
  --docs-mode: 'user' !important; /* user | developer | designer | admin */
  --docs-version: '2.1.0' !important;
  --docs-active-section: 'getting-started' !important;
  
  /* Навигация по документации */
  --docs-sidebar-width: 280px !important;
  --docs-content-width: min(100%, 800px) !important;
  --docs-toc-width: 240px !important;
  
  /* Интерактивные элементы */
  --docs-interactive-zindex: 1000 !important;
  --docs-search-height: 60px !important;
}

/* ==================== ОСНОВНОЙ МАКЕТ ДОКУМЕНТАЦИИ ==================== */

.docs-container {
  display: grid !important;
  grid-template-columns: var(--docs-sidebar-width) 1fr var(--docs-toc-width) !important;
  grid-template-areas: "sidebar main toc" !important;
  min-height: 100vh !important;
  background: var(--background-primary) !important;
}

.docs-sidebar {
  grid-area: sidebar !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border-right: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  padding: var(--size-6) !important;
  position: sticky !important;
  top: 0 !important;
  height: 100vh !important;
  overflow-y: auto !important;
}

.docs-main {
  grid-area: main !important;
  max-width: var(--docs-content-width) !important;
  margin: 0 auto !important;
  padding: var(--size-8) !important;
}

.docs-toc {
  grid-area: toc !important;
  background: color-mix(in oklch, var(--background-primary), transparent 3%) !important;
  border-left: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  padding: var(--size-6) !important;
  position: sticky !important;
  top: 0 !important;
  height: 100vh !important;
  overflow-y: auto !important;
}

/* ==================== СИСТЕМА НАВИГАЦИИ И ПОИСКА ==================== */

.docs-search-container {
  position: sticky !important;
  top: 0 !important;
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  backdrop-filter: blur(20px) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  padding: var(--size-4) !important;
  z-index: var(--docs-interactive-zindex) !important;
}

.docs-search {
  width: 100% !important;
  height: var(--docs-search-height) !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: 0 var(--size-4) !important;
  font-size: var(--font-size-lg) !important;
  color: var(--text-normal) !important;
  transition: all 0.3s ease !important;
}

.docs-search:focus {
  border-color: var(--accent-primary) !important;
  box-shadow: 0 0 0 3px color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
}

.docs-search-results {
  position: absolute !important;
  top: 100% !important;
  left: 0 !important;
  right: 0 !important;
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  backdrop-filter: blur(40px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-lg) !important;
  margin-top: var(--size-2) !important;
  max-height: 400px !important;
  overflow-y: auto !important;
  box-shadow: var(--shadow-xl) !important;
}

.docs-nav-section {
  margin-bottom: var(--size-6) !important;
}

.docs-nav-title {
  font-size: var(--font-size-sm) !important;
  font-weight: var(--font-weight-semibold) !important;
  color: var(--accent-primary) !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
  margin-bottom: var(--size-3) !important;
  padding-bottom: var(--size-2) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.docs-nav-items {
  display: flex !important;
  flex-direction: column !important;
  gap: var(--size-1) !important;
}

.docs-nav-item {
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  color: var(--text-muted) !important;
  text-decoration: none !important;
  transition: all 0.2s ease !important;
  font-size: var(--font-size-sm) !important;
}

.docs-nav-item:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  color: var(--text-normal) !important;
}

.docs-nav-item.active {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  color: var(--accent-primary) !important;
  font-weight: var(--font-weight-medium) !important;
}

/* ==================== ИНТЕРАКТИВНЫЕ КОМПОНЕНТЫ ДОКУМЕНТАЦИИ ==================== */

.docs-component-preview {
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-xl) !important;
  margin: var(--size-6) 0 !important;
  overflow: hidden !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
}

.docs-preview-header {
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  padding: var(--size-4) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
}

.docs-preview-title {
  font-weight: var(--font-weight-semibold) !important;
  color: var(--accent-primary) !important;
  margin: 0 !important;
}

.docs-preview-controls {
  display: flex !important;
  gap: var(--size-2) !important;
}

.docs-preview-content {
  padding: var(--size-6) !important;
  min-height: 200px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

.docs-preview-code {
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  border-top: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  padding: var(--size-4) !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-sm) !important;
  overflow-x: auto !important;
}

/* ==================== СИСТЕМА CALLBACK И ПРИМЕЧАНИЙ ==================== */

.docs-callout {
  border-left: 4px solid transparent !important;
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  position: relative !important;
}

.docs-callout-note {
  border-left-color: var(--semantic-info) !important;
  background: color-mix(in oklch, var(--semantic-info), transparent 95%) !important;
}

.docs-callout-tip {
  border-left-color: var(--semantic-success) !important;
  background: color-mix(in oklch, var(--semantic-success), transparent 95%) !important;
}

.docs-callout-warning {
  border-left-color: var(--semantic-warning) !important;
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
}

.docs-callout-danger {
  border-left-color: var(--semantic-error) !important;
  background: color-mix(in oklch, var(--semantic-error), transparent 95%) !important;
}

.docs-callout-title {
  font-weight: var(--font-weight-semibold) !important;
  font-size: var(--font-size-sm) !important;
  margin-bottom: var(--size-2) !important;
  display: flex !important;
  align-items: center !important;
  gap: var(--size-2) !important;
}

/* ==================== СИСТЕМА API ДОКУМЕНТАЦИИ ==================== */

.docs-api-section {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-xl) !important;
  margin: var(--size-6) 0 !important;
  overflow: hidden !important;
}

.docs-api-header {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  padding: var(--size-4) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.docs-api-title {
  font-weight: var(--font-weight-bold) !important;
  color: var(--accent-primary) !important;
  margin: 0 !important;
  font-size: var(--font-size-xl) !important;
}

.docs-api-description {
  color: var(--text-normal) !important;
  margin: var(--size-2) 0 0 0 !important;
  line-height: var(--line-height-relaxed) !important;
}

.docs-api-properties {
  padding: var(--size-4) !important;
}

.docs-api-property {
  padding: var(--size-4) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

.docs-api-property:last-child {
  border-bottom: none !important;
}

.docs-api-property-header {
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
  margin-bottom: var(--size-2) !important;
}

.docs-api-property-name {
  font-family: var(--font-family-mono) !important;
  font-weight: var(--font-weight-bold) !important;
  color: var(--accent-primary) !important;
  font-size: var(--font-size-lg) !important;
}

.docs-api-property-type {
  background: color-mix(in oklch, var(--accent-secondary), transparent 90%) !important;
  color: var(--accent-secondary) !important;
  padding: var(--size-1) var(--size-2) !important;
  border-radius: var(--radius-sm) !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-bold) !important;
}

/* ==================== ИНТЕРАКТИВНЫЕ ПРИМЕРЫ И ПЕСОЧНИЦА ==================== */

.docs-playground {
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-xl) !important;
  margin: var(--size-6) 0 !important;
  overflow: hidden !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
}

.docs-playground-header {
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  padding: var(--size-4) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.docs-playground-tabs {
  display: flex !important;
  gap: var(--size-2) !important;
  margin-bottom: var(--size-4) !important;
}

.docs-playground-tab {
  background: transparent !important;
  border: 1px solid transparent !important;
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  color: var(--text-muted) !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
  font-size: var(--font-size-sm) !important;
}

.docs-playground-tab.active {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  border-color: color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  color: var(--accent-primary) !important;
}

.docs-playground-content {
  display: grid !important;
  grid-template-columns: 1fr 1fr !important;
  min-height: 400px !important;
}

.docs-playground-editor {
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  border-right: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  padding: var(--size-4) !important;
}

.docs-playground-preview {
  padding: var(--size-4) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

/* ==================== СИСТЕМА ВИДЕО-ТУТОРИАЛОВ ==================== */

.docs-video-container {
  position: relative !important;
  border-radius: var(--radius-xl) !important;
  overflow: hidden !important;
  margin: var(--size-6) 0 !important;
  background: color-mix(in oklch, var(--background-primary), black 10%) !important;
}

.docs-video-player {
  width: 100% !important;
  height: 400px !important;
  background: black !important;
}

.docs-video-controls {
  position: absolute !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  background: linear-gradient(transparent, rgba(0, 0, 0, 0.8)) !important;
  padding: var(--size-4) !important;
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
}

.docs-video-chapters {
  display: flex !important;
  gap: var(--size-2) !important;
  padding: var(--size-4) !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border-top: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.docs-video-chapter {
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  color: var(--accent-primary) !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
  font-size: var(--font-size-sm) !important;
}

.docs-video-chapter:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

/* ==================== СИСТЕМА TROUBLESHOOTING И FAQ ==================== */

.docs-faq-section {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-xl) !important;
  margin: var(--size-6) 0 !important;
  overflow: hidden !important;
}

.docs-faq-item {
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  transition: all 0.3s ease !important;
}

.docs-faq-item:last-child {
  border-bottom: none !important;
}

.docs-faq-question {
  padding: var(--size-4) !important;
  background: transparent !important;
  border: none !important;
  width: 100% !important;
  text-align: left !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
  color: var(--text-normal) !important;
  font-size: var(--font-size-lg) !important;
  transition: all 0.2s ease !important;
}

.docs-faq-question:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 98%) !important;
}

.docs-faq-answer {
  padding: 0 var(--size-4) !important;
  max-height: 0 !important;
  overflow: hidden !important;
  transition: all 0.3s ease !important;
}

.docs-faq-item.active .docs-faq-answer {
  padding: var(--size-4) !important;
  max-height: 500px !important;
  background: color-mix(in oklch, var(--background-primary), transparent 3%) !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ДОКУМЕНТАЦИИ ==================== */

/* CSS Layers для организации документации */
@layer docs-base, docs-layout, docs-components, docs-interactive, docs-mobile;

@layer docs-base {
  .docs-foundation {
    --docs-api-version: '2.1' !important;
    --docs-extensible: true !important;
  }
}

@layer docs-layout {
  .docs-layout-system {
    /* Система макетов и сеток */
  }
}

@layer docs-components {
  .docs-component-system {
    /* Компоненты документации */
  }
}

@layer docs-interactive {
  .docs-interactive-system {
    /* Интерактивные элементы */
  }
}

@layer docs-mobile {
  .docs-mobile-optimized {
    /* Мобильная оптимизация */
  }
}

/* Container Queries для адаптивной документации */
@container (max-width: 1200px) {
  .docs-responsive {
    grid-template-columns: var(--docs-sidebar-width) 1fr !important;
    grid-template-areas: "sidebar main" !important;
  }
  
  .docs-responsive .docs-toc {
    display: none !important;
  }
}

@container (max-width: 768px) {
  .docs-responsive {
    grid-template-columns: 1fr !important;
    grid-template-areas: "main" !important;
  }
  
  .docs-responsive .docs-sidebar {
    position: fixed !important;
    left: -100% !important;
    z-index: var(--docs-interactive-zindex) !important;
    transition: left 0.3s ease !important;
  }
  
  .docs-responsive .docs-sidebar[data-mobile-open="true"] {
    left: 0 !important;
  }
}

/* Система режимов для разных типов пользователей */
[data-docs-mode="user"] .docs-developer-content {
  display: none !important;
}

[data-docs-mode="developer"] .docs-user-content {
  display: none !important;
}

[data-docs-mode="designer"] .docs-technical-content {
  display: none !important;
}

/* ==================== СИСТЕМА ОБРАТНОЙ СВЯЗИ И СООБЩЕСТВА ==================== */

.docs-feedback-widget {
  position: fixed !important;
  bottom: var(--size-4) !important;
  right: var(--size-4) !important;
  background: var(--accent-primary) !important;
  color: white !important;
  padding: var(--size-3) var(--size-4) !important;
  border-radius: var(--radius-lg) !important;
  cursor: pointer !important;
  z-index: var(--docs-interactive-zindex) !important;
  box-shadow: var(--shadow-lg) !important;
  transition: all 0.3s ease !important;
}

.docs-feedback-widget:hover {
  transform: translateY(-2px) !important;
  box-shadow: var(--shadow-xl) !important;
}

.docs-feedback-modal {
  position: fixed !important;
  top: 50% !important;
  left: 50% !important;
  transform: translate(-50%, -50%) !important;
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  backdrop-filter: blur(40px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-6) !important;
  z-index: calc(var(--docs-interactive-zindex) + 1) !important;
  width: min(90vw, 500px) !important;
  box-shadow: var(--shadow-2xl) !important;
}

/* ==================== СИСТЕМА ПОИСКА И ИНДЕКСАЦИИ ==================== */

.docs-search-index {
  position: absolute !important;
  top: 100% !important;
  left: 0 !important;
  right: 0 !important;
  background: color-mix(in oklch, var(--background-primary), black 10%) !important;
  backdrop-filter: blur(40px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-lg) !important;
  margin-top: var(--size-2) !important;
  max-height: 400px !important;
  overflow-y: auto !important;
  box-shadow: var(--shadow-xl) !important;
}

.docs-search-result {
  padding: var(--size-3) var(--size-4) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
}

.docs-search-result:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

.docs-search-result:last-child {
  border-bottom: none !important;
}

.docs-search-result-title {
  font-weight: var(--font-weight-medium) !important;
  color: var(--text-normal) !important;
  margin-bottom: var(--size-1) !important;
}

.docs-search-result-path {
  font-size: var(--font-size-xs) !important;
  color: var(--text-muted) !important;
}

/* ==================== СИСТЕМА ВЕРСИОНИРОВАНИЯ ДОКУМЕНТАЦИИ ==================== */

.docs-version-selector {
  position: relative !important;
  margin-bottom: var(--size-4) !important;
}

.docs-version-dropdown {
  width: 100% !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  border-radius: var(--radius-md) !important;
  padding: var(--size-2) var(--size-3) !important;
  color: var(--text-normal) !important;
  cursor: pointer !important;
}

.docs-version-warning {
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-warning), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

/* ==================== СИСТЕМА ДОСТУПНОСТИ ДОКУМЕНТАЦИИ ==================== */

.docs-accessibility-features {
  background: color-mix(in oklch, var(--accent-secondary), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-secondary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.docs-high-contrast-mode {
  filter: contrast(1.5) brightness(0.9) !important;
}

.docs-reduced-motion-mode * {
  animation-duration: 0.01ms !important;
  transition-duration: 0.01ms !important;
}

/* ==========================================================================
   КОНЕЦ РАСШИРЕННОЙ СИСТЕМЫ ДОКУМЕНТАЦИИ
   ========================================================================== */
   
   /* ==========================================================================
   СИСТЕМА КОНТЕКСТНОЙ ФИЛЬТРАЦИИ И ЭМОЦИОНАЛЬНОГО ДИЗАЙНА DARK NEBULA
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА КОНТЕКСТНОЙ ФИЛЬТРАЦИИ ==================== */

:root {
  /* Режимы фильтрации */
  --filter-mode: 'adaptive' !important; /* adaptive | focus | relax | creative */
  --filter-intensity: 0.7 !important; /* 0 - 1 */
  --filter-context: 'default' !important;
  
  /* Динамические фильтры */
  --filter-blur: 0px !important;
  --filter-opacity: 1 !important;
  --filter-saturation: 1 !important;
  --filter-contrast: 1 !important;
  
  /* Эмоциональные состояния */
  --emotion-state: 'neutral' !important;
  --emotion-energy: 0.5 !important;
  --emotion-valence: 0.5 !important;
}

/* ==================== АДАПТИВНЫЕ ФИЛЬТРЫ КОНТЕНТА ==================== */

.filter-context-aware {
  /* Базовые фильтры, применяемые ко всему контенту */
  filter: 
    blur(var(--filter-blur))
    opacity(var(--filter-opacity))
    saturate(var(--filter-saturation))
    contrast(var(--filter-contrast)) !important;
  
  transition: filter 0.5s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

/* Режим глубокого фокуса */
[data-filter-mode="deep-focus"] {
  --filter-intensity: 0.9 !important;
  --filter-blur: 8px !important;
  --filter-opacity: 0.3 !important;
  --filter-saturation: 0.8 !important;
}

[data-filter-mode="deep-focus"] .filter-priority-high {
  --filter-blur: 0px !important;
  --filter-opacity: 1 !important;
  --filter-saturation: 1.2 !important;
  animation: focus-pulse 3s ease-in-out infinite !important;
}

/* Режим релаксации */
[data-filter-mode="relax"] {
  --filter-intensity: 0.6 !important;
  --filter-blur: 2px !important;
  --filter-saturation: 0.9 !important;
  --filter-contrast: 0.95 !important;
}

/* Режим креативной работы */
[data-filter-mode="creative"] {
  --filter-intensity: 0.8 !important;
  --filter-saturation: 1.3 !important;
  --filter-contrast: 1.1 !important;
}

/* ==================== ИНТЕЛЛЕКТУАЛЬНОЕ ВЫДЕЛЕНИЕ КОНТЕНТА ==================== */

.context-priority-system {
  position: relative !important;
}

.context-priority-high {
  z-index: 100 !important;
  position: relative !important;
  
  &::before {
    content: '' !important;
    position: absolute !important;
    top: -4px !important;
    left: -4px !important;
    right: -4px !important;
    bottom: -4px !important;
    background: linear-gradient(
      45deg,
      color-mix(in oklch, var(--accent-primary), transparent 80%),
      color-mix(in oklch, var(--accent-secondary), transparent 80%),
      color-mix(in oklch, var(--accent-primary), transparent 80%)
    ) !important;
    border-radius: calc(var(--radius-lg) + 4px) !important;
    z-index: -1 !important;
    animation: priority-glow 2s ease-in-out infinite !important;
  }
}

.context-priority-medium {
  opacity: 0.8 !important;
  filter: saturate(0.8) !important;
}

.context-priority-low {
  opacity: 0.4 !important;
  filter: saturate(0.6) blur(1px) !important;
  transition: all 0.3s ease !important;
}

.context-priority-low:hover {
  opacity: 0.7 !important;
  filter: saturate(0.8) blur(0px) !important;
}

@keyframes focus-pulse {
  0%, 100% { 
    box-shadow: 0 0 0 0 color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  }
  50% { 
    box-shadow: 0 0 0 4px color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  }
}

@keyframes priority-glow {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.6; }
}

/* ==================== КОНТЕКСТНО-ЗАВИСИМЫЕ ИНТЕРФЕЙСЫ ==================== */

/* Автоматическое определение типа контента */
[data-content-type="writing"] .context-writing-optimized {
  --filter-intensity: 0.8 !important;
  --filter-contrast: 1.05 !important;
}

[data-content-type="coding"] .context-coding-optimized {
  --filter-saturation: 1.1 !important;
  --filter-contrast: 1.15 !important;
}

[data-content-type="research"] .context-research-optimized {
  --filter-opacity: 0.95 !important;
  --filter-saturation: 0.95 !important;
}

[data-content-type="planning"] .context-planning-optimized {
  --filter-intensity: 0.9 !important;
  --filter-contrast: 1.1 !important;
}

/* Умное скрытие на основе контекста */
.context-aware-hidden {
  opacity: 0.1 !important;
  transform: scale(0.95) !important;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.context-aware-hidden:hover {
  opacity: 0.7 !important;
  transform: scale(0.98) !important;
}

.context-relevant {
  opacity: 1 !important;
  transform: scale(1) !important;
  animation: context-reveal 0.6s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

@keyframes context-reveal {
  from {
    opacity: 0;
    transform: scale(0.8) translateY(20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* ==================== ЭМОЦИОНАЛЬНЫЙ ДИЗАЙН И ОБРАТНАЯ СВЯЗЬ ==================== */

.emotion-positive-feedback {
  position: relative !important;
  overflow: hidden !important;
}

/* Микро-анимации достижений */
.achievement-celebration {
  position: fixed !important;
  top: 50% !important;
  left: 50% !important;
  transform: translate(-50%, -50%) !important;
  z-index: 10000 !important;
  pointer-events: none !important;
}

.celebration-particle {
  position: absolute !important;
  width: 8px !important;
  height: 8px !important;
  background: var(--accent-primary) !important;
  border-radius: 50% !important;
  animation: celebration-explode 1.5s ease-out forwards !important;
}

@keyframes celebration-explode {
  0% {
    transform: translate(0, 0) scale(0);
    opacity: 1;
  }
  100% {
    transform: 
      translate(
        calc(var(--tx) * 100px),
        calc(var(--ty) * 100px)
      ) scale(1);
    opacity: 0;
  }
}

/* Позитивное подкрепление */
.positive-reinforcement {
  background: color-mix(in oklch, var(--semantic-success), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-success), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  animation: positive-glow 2s ease-in-out !important;
}

@keyframes positive-glow {
  0%, 100% {
    box-shadow: 0 0 0 0 color-mix(in oklch, var(--semantic-success), transparent 80%) !important;
  }
  50% {
    box-shadow: 0 0 0 8px color-mix(in oklch, var(--semantic-success), transparent 80%) !important;
  }
}

/* Эмоциональные состояния интерфейса */
[data-emotion-state="focused"] {
  --emotion-energy: 0.8 !important;
  --emotion-valence: 0.7 !important;
  --accent-primary: hsl(200, 100%, 65%) !important; /* Спокойный синий */
}

[data-emotion-state="energized"] {
  --emotion-energy: 0.9 !important;
  --emotion-valence: 0.8 !important;
  --accent-primary: hsl(45, 100%, 65%) !important; /* Энергичный желтый */
}

[data-emotion-state="relaxed"] {
  --emotion-energy: 0.3 !important;
  --emotion-valence: 0.6 !important;
  --accent-primary: hsl(160, 100%, 65%) !important; /* Расслабляющий зеленый */
}

[data-emotion-state="creative"] {
  --emotion-energy: 0.7 !important;
  --emotion-valence: 0.9 !important;
  --accent-primary: hsl(300, 100%, 65%) !important; /* Креативный фиолетовый */
}

/* ==================== ТАКТИЛЬНАЯ И ВИЗУАЛЬНАЯ ОБРАТНАЯ СВЯЗЬ ==================== */

.haptic-feedback {
  /* Подготовка для тактильной обратной связи */
  touch-action: manipulation !important;
}

@media (hover: hover) and (pointer: fine) {
  .haptic-feedback:hover {
    animation: haptic-buzz 0.1s ease !important;
  }
}

@keyframes haptic-buzz {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-1px); }
  75% { transform: translateX(1px); }
}

/* Визуальная обратная связь для действий */
.action-feedback {
  position: relative !important;
  overflow: hidden !important;
}

.action-feedback::after {
  content: '' !important;
  position: absolute !important;
  top: 50% !important;
  left: 50% !important;
  width: 0 !important;
  height: 0 !important;
  background: radial-gradient(circle, color-mix(in oklch, var(--accent-primary), transparent 70%) 0%, transparent 70%) !important;
  transform: translate(-50%, -50%) !important;
  transition: all 0.3s ease !important;
  border-radius: 50% !important;
}

.action-feedback:active::after {
  width: 300% !important;
  height: 300% !important;
  opacity: 0 !important;
  transition: all 0.5s ease !important;
}

/* ==================== СИСТЕМА ЭМОЦИОНАЛЬНЫХ ПЕРЕХОДОВ ==================== */

.emotional-transition {
  transition: 
    background-color 0.8s cubic-bezier(0.4, 0, 0.2, 1),
    color 0.8s cubic-bezier(0.4, 0, 0.2, 1),
    border-color 0.8s cubic-bezier(0.4, 0, 0.2, 1),
    box-shadow 0.8s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

/* Плавное изменение эмоционального состояния */
.emotion-flow-enter {
  animation: emotion-flow-in 0.6s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.emotion-flow-exit {
  animation: emotion-flow-out 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

@keyframes emotion-flow-in {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
    filter: blur(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
    filter: blur(0);
  }
}

@keyframes emotion-flow-out {
  to {
    opacity: 0;
    transform: translateY(-20px) scale(0.98);
    filter: blur(5px);
  }
}

/* ==================== АДАПТИВНЫЕ ЦВЕТОВЫЕ СХЕМЫ ПО ЭМОЦИЯМ ==================== */

.emotion-color-theme[data-emotion="joy"] {
  --accent-primary: hsl(45, 100%, 65%) !important;   /* Теплый желтый */
  --accent-secondary: hsl(350, 100%, 65%) !important; /* Розовый */
  --accent-tertiary: hsl(280, 100%, 75%) !important;  /* Фиолетовый */
}

.emotion-color-theme[data-emotion="calm"] {
  --accent-primary: hsl(200, 100%, 65%) !important;   /* Спокойный синий */
  --accent-secondary: hsl(160, 100%, 65%) !important; /* Зеленый */
  --accent-tertiary: hsl(220, 100%, 75%) !important;  /* Голубой */
}

.emotion-color-theme[data-emotion="focus"] {
  --accent-primary: hsl(270, 100%, 65%) !important;   /* Фиолетовый */
  --accent-secondary: hsl(190, 100%, 65%) !important; /* Бирюзовый */
  --accent-tertiary: hsl(320, 100%, 75%) !important;  /* Пурпурный */
}

.emotion-color-theme[data-emotion="energy"] {
  --accent-primary: hsl(10, 100%, 65%) !important;    /* Оранжевый */
  --accent-secondary: hsl(55, 100%, 65%) !important;  /* Золотой */
  --accent-tertiary: hsl(350, 100%, 75%) !important;  /* Красный */
}

/* ==================== СИСТЕМА МОНИТОРИНГА МЕНТАЛЬНОГО СОСТОЯНИЯ ==================== */

.mental-state-indicator {
  position: fixed !important;
  top: var(--size-4) !important;
  right: var(--size-4) !important;
  width: 60px !important;
  height: 60px !important;
  border-radius: 50% !important;
  background: conic-gradient(
    from 0deg,
    color-mix(in oklch, var(--semantic-success), transparent 30%) 0%,
    color-mix(in oklch, var(--semantic-warning), transparent 30%) 50%,
    color-mix(in oklch, var(--semantic-error), transparent 30%) 100%
  ) !important;
  cursor: pointer !important;
  z-index: 1000 !important;
  transition: all 0.3s ease !important;
}

.mental-state-indicator:hover {
  transform: scale(1.1) !important;
}

.mental-state-value {
  position: absolute !important;
  top: 50% !important;
  left: 50% !important;
  transform: translate(-50%, -50%) !important;
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  width: 44px !important;
  height: 44px !important;
  border-radius: 50% !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-bold) !important;
}

/* ==================== УМНЫЕ УВЕДОМЛЕНИЯ И НАПОМИНАНИЯ ==================== */

.context-aware-notification {
  position: fixed !important;
  bottom: var(--size-4) !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  background: color-mix(in oklch, var(--background-primary), black 10%) !important;
  backdrop-filter: blur(40px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  max-width: 400px !important;
  z-index: 1000 !important;
  animation: notification-slide-up 0.5s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

@keyframes notification-slide-up {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(100%);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}

.break-reminder {
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
  border-color: color-mix(in oklch, var(--semantic-warning), transparent 80%) !important;
}

.achievement-notification {
  background: color-mix(in oklch, var(--semantic-success), transparent 95%) !important;
  border-color: color-mix(in oklch, var(--semantic-success), transparent 80%) !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ЭМОЦИОНАЛЬНОГО ДИЗАЙНА ==================== */

/* CSS Layers для организации эмоционального дизайна */
@layer emotion-base, emotion-filters, emotion-feedback, emotion-adaptive, emotion-analytics;

@layer emotion-base {
  .emotion-foundation {
    --emotion-api-version: '2.1' !important;
    --emotion-adaptive: true !important;
  }
}

@layer emotion-filters {
  .emotion-filter-system {
    /* Система контекстных фильтров */
  }
}

@layer emotion-feedback {
  .emotion-feedback-system {
    /* Система обратной связи */
  }
}

@layer emotion-adaptive {
  .emotion-adaptive-system {
    /* Адаптивные эмоциональные состояния */
  }
}

@layer emotion-analytics {
  .emotion-analytics-system {
    /* Аналитика эмоциональных состояний */
  }
}

/* Container Queries для адаптивных эмоциональных состояний */
@container (max-width: 768px) {
  .emotion-mobile-optimized {
    --filter-intensity: 0.8 !important;
    --filter-blur: 1px !important;
  }
}

/* Система плагинов для эмоционального дизайна */
.emotion-plugin-interface {
  --plugin-emotion-support: true !important;
}

/* ==================== СИСТЕМА АНАЛИТИКИ И ОПТИМИЗАЦИИ ==================== */

.emotion-analytics-panel {
  position: fixed !important;
  bottom: 80px !important;
  right: var(--size-4) !important;
  background: color-mix(in oklch, var(--background-primary), black 10%) !important;
  backdrop-filter: blur(40px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  width: 300px !important;
  z-index: 999 !important;
}

.emotion-metrics {
  display: grid !important;
  gap: var(--size-3) !important;
}

.emotion-metric {
  display: flex !important;
  justify-content: between !important;
  align-items: center !important;
  padding: var(--size-2) 0 !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.emotion-metric:last-child {
  border-bottom: none !important;
}

.emotion-metric-value {
  font-weight: var(--font-weight-bold) !important;
  color: var(--accent-primary) !important;
}

/* ==================== ИНТЕГРАЦИЯ С ВНЕШНИМИ СИСТЕМАМИ ==================== */

.health-integration {
  background: color-mix(in oklch, var(--accent-secondary), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-secondary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.focus-assistant {
  position: relative !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
}

/* ==========================================================================
   КОНЕЦ СИСТЕМЫ КОНТЕКСТНОЙ ФИЛЬТРАЦИИ И ЭМОЦИОНАЛЬНОГО ДИЗАЙНА
   ========================================================================== */
   
   /* ==========================================================================
   УНИВЕРСАЛЬНАЯ СИСТЕМА ВНЕШНИХ ИНТЕГРАЦИЙ DARK NEBULA
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА ВНЕШНИХ ИНТЕГРАЦИЙ ==================== */

:root {
  /* Уровни интеграции */
  --integration-level: 'standard' !important; /* minimal | standard | enhanced | full */
  --integration-api-version: '2024' !important;
  --integration-auto-detect: true !important;
  
  /* Поддержка сервисов */
  --integration-cloud: true !important;
  --integration-ai: false !important;
  --integration-productivity: true !important;
  --integration-developer: false !important;
  
  /* Безопасность и разрешения */
  --integration-permission-level: 'read-only' !important;
  --integration-encryption: true !important;
  --integration-sync-interval: '5m' !important;
}

/* ==================== ИНТЕГРАЦИЯ С ОБЛАЧНЫМИ СЕРВИСАМИ ==================== */

/* Google Drive интеграция */
.integration-google-drive {
  --integration-brand-color: #4285F4 !important;
  --integration-icon: url('data:image/svg+xml,<svg>...</svg>') !important;
}

.integration-google-drive .cloud-sync-indicator {
  background: color-mix(in oklch, var(--integration-brand-color), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--integration-brand-color), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-3) var(--size-4) !important;
  margin: var(--size-3) 0 !important;
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
}

/* Dropbox интеграция */
.integration-dropbox {
  --integration-brand-color: #0061FF !important;
}

.integration-dropbox .cloud-file-preview {
  background: color-mix(in oklch, var(--integration-brand-color), transparent 98%) !important;
  border-left: 3px solid var(--integration-brand-color) !important;
  border-radius: var(--radius-md) !important;
  padding: var(--size-3) !important;
  margin: var(--size-2) 0 !important;
}

/* OneDrive интеграция */
.integration-onedrive {
  --integration-brand-color: #0078D4 !important;
}

/* Универсальные стили для облачных сервисов */
.cloud-integration-panel {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.cloud-service-status {
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
  padding: var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  margin-bottom: var(--size-3) !important;
}

.cloud-service-connected {
  background: color-mix(in oklch, var(--semantic-success), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-success), transparent 80%) !important;
}

.cloud-service-syncing {
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-warning), transparent 80%) !important;
  animation: sync-pulse 2s ease-in-out infinite !important;
}

@keyframes sync-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

/* ==================== AI И МАШИННОЕ ОБУЧЕНИЕ ==================== */

.integration-ai-assistant {
  --ai-brand-color: #10B981 !important;
  position: relative !important;
}

.ai-suggestion-panel {
  background: color-mix(in oklch, var(--ai-brand-color), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--ai-brand-color), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  position: relative !important;
}

.ai-suggestion-panel::before {
  content: '🤖' !important;
  position: absolute !important;
  top: -12px !important;
  left: var(--size-4) !important;
  background: var(--background-primary) !important;
  padding: 0 var(--size-2) !important;
  font-size: var(--font-size-lg) !important;
}

.ai-thinking-indicator {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-2) !important;
  color: var(--text-muted) !important;
  font-style: italic !important;
}

.ai-thinking-dots {
  display: flex !important;
  gap: 2px !important;
}

.ai-thinking-dots span {
  width: 4px !important;
  height: 4px !important;
  border-radius: 50% !important;
  background: currentColor !important;
  animation: ai-thinking 1.4s ease-in-out infinite both !important;
}

.ai-thinking-dots span:nth-child(1) { animation-delay: -0.32s !important; }
.ai-thinking-dots span:nth-child(2) { animation-delay: -0.16s !important; }

@keyframes ai-thinking {
  0%, 80%, 100% { transform: scale(0); }
  40% { transform: scale(1); }
}

/* ChatGPT/OpenAI интеграция */
.integration-openai .ai-response {
  border-left: 3px solid color-mix(in oklch, var(--ai-brand-color), transparent 70%) !important;
  padding-left: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  background: color-mix(in oklch, var(--background-primary), transparent 3%) !important;
  border-radius: 0 var(--radius-md) var(--radius-md) 0 !important;
}

/* Claude AI интеграция */
.integration-claude {
  --ai-brand-color: #FF6B35 !important;
}

/* ==================== ПРОДУКТИВНОСТЬ И ЗАДАЧИ ==================== */

/* Todoist интеграция */
.integration-todoist {
  --integration-brand-color: #E44332 !important;
}

.todoist-task-list {
  background: color-mix(in oklch, var(--integration-brand-color), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--integration-brand-color), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.todoist-task-item {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
  padding: var(--size-3) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--integration-brand-color), transparent 95%) !important;
}

.todoist-task-item:last-child {
  border-bottom: none !important;
}

/* Notion интеграция */
.integration-notion {
  --integration-brand-color: #000000 !important;
}

.notion-database-view {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.notion-property {
  display: flex !important;
  justify-content: between !important;
  padding: var(--size-2) 0 !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

/* ==================== РАЗРАБОТКА И DEVTOOLS ==================== */

.integration-github {
  --integration-brand-color: #4078c0 !important;
}

.github-integration-panel {
  background: color-mix(in oklch, var(--integration-brand-color), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--integration-brand-color), transparent 80%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.github-repo-status {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
  padding: var(--size-3) !important;
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  border-radius: var(--radius-md) !important;
  margin-bottom: var(--size-3) !important;
}

.git-branch-indicator {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  color: var(--accent-primary) !important;
  padding: var(--size-1) var(--size-2) !important;
  border-radius: var(--radius-sm) !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-xs) !important;
}

/* VS Code интеграция */
.integration-vscode {
  --integration-brand-color: #007ACC !important;
}

.vscode-theme-sync {
  background: color-mix(in oklch, var(--integration-brand-color), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--integration-brand-color), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

/* ==================== ВЕБ-КЛИППИНГ И КОНТЕНТ-ЗАХВАТ ==================== */

.web-clip-integration {
  position: relative !important;
}

.clipped-content {
  background: color-mix(in oklch, var(--accent-secondary), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-secondary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  position: relative !important;
}

.clipped-content::before {
  content: '🌐' !important;
  position: absolute !important;
  top: -12px !important;
  left: var(--size-4) !important;
  background: var(--background-primary) !important;
  padding: 0 var(--size-2) !important;
  font-size: var(--font-size-lg) !important;
}

.clip-source-info {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-2) !important;
  padding: var(--size-2) var(--size-3) !important;
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  border-radius: var(--radius-md) !important;
  margin-bottom: var(--size-3) !important;
  font-size: var(--font-size-sm) !important;
  color: var(--text-muted) !important;
}

/* ==================== API И WEBHOOK ИНТЕГРАЦИИ ==================== */

.api-integration-panel {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.webhook-configuration {
  display: grid !important;
  gap: var(--size-4) !important;
}

.webhook-endpoint {
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
}

.webhook-status {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  font-size: var(--font-size-sm) !important;
}

.webhook-active {
  background: color-mix(in oklch, var(--semantic-success), transparent 95%) !important;
  color: var(--semantic-success) !important;
}

.webhook-inactive {
  background: color-mix(in oklch, var(--semantic-error), transparent 95%) !important;
  color: var(--semantic-error) !important;
}

/* ==================== УМНЫЕ УСТРОЙСТВА И IOT ==================== */

.iot-integration {
  --iot-brand-color: #8B5CF6 !important;
}

.iot-device-panel {
  background: color-mix(in oklch, var(--iot-brand-color), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--iot-brand-color), transparent 80%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.iot-device-grid {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
  gap: var(--size-4) !important;
  margin-top: var(--size-4) !important;
}

.iot-device-card {
  background: color-mix(in oklch, var(--background-primary), transparent 10%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  text-align: center !important;
  cursor: pointer !important;
  transition: all 0.3s ease !important;
}

.iot-device-card:hover {
  transform: translateY(-2px) !important;
  box-shadow: var(--shadow-md) !important;
}

.iot-device-status {
  width: 12px !important;
  height: 12px !important;
  border-radius: 50% !important;
  margin: 0 auto var(--size-2) !important;
}

.iot-device-online {
  background: var(--semantic-success) !important;
  animation: device-pulse 2s ease-in-out infinite !important;
}

.iot-device-offline {
  background: var(--semantic-error) !important;
}

@keyframes device-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* ==================== МЕДИА И КОНТЕНТ-СЕРВИСЫ ==================== */

.media-service-integration {
  background: color-mix(in oklch, var(--accent-tertiary), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-tertiary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.spotify-integration .media-player {
  background: color-mix(in oklch, #1DB954, transparent 95%) !important;
  border: 1px solid color-mix(in oklch, #1DB954, transparent 80%) !important;
}

.youtube-integration .media-player {
  background: color-mix(in oklch, #FF0000, transparent 95%) !important;
  border: 1px solid color-mix(in oklch, #FF0000, transparent 80%) !important;
}

/* ==================== СИСТЕМА БЕЗОПАСНОСТИ И ШИФРОВАНИЯ ==================== */

.security-integration-panel {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-warning), transparent 80%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.encryption-status {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
  padding: var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  margin-bottom: var(--size-3) !important;
}

.encryption-active {
  background: color-mix(in oklch, var(--semantic-success), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-success), transparent 80%) !important;
}

.encryption-warning {
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-warning), transparent 80%) !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА ИНТЕГРАЦИЙ ==================== */

/* CSS Layers для организации интеграций */
@layer integration-base, integration-services, integration-security, integration-ui, integration-future;

@layer integration-base {
  .integration-foundation {
    --integration-api-version: '2.1' !important;
    --integration-extensible: true !important;
  }
}

@layer integration-services {
  .integration-service-system {
    /* Система сервис-интеграций */
  }
}

@layer integration-security {
  .integration-security-system {
    /* Система безопасности интеграций */
  }
}

@layer integration-ui {
  .integration-ui-system {
    /* UI компоненты для интеграций */
  }
}

@layer integration-future {
  .integration-future-ready {
    /* Подготовка для будущих интеграций */
  }
}

/* Container Queries для адаптивных интеграций */
@container (max-width: 768px) {
  .integration-mobile-optimized {
    --integration-level: 'minimal' !important;
  }
  
  .iot-device-grid {
    grid-template-columns: 1fr !important;
  }
}

/* Система обнаружения и автоконфигурации */
.integration-auto-detect {
  position: relative !important;
}

.integration-auto-detect::after {
  content: '🔍' !important;
  position: absolute !important;
  top: var(--size-2) !important;
  right: var(--size-2) !important;
  font-size: var(--font-size-sm) !important;
  opacity: 0.7 !important;
}

/* ==================== УНИВЕРСАЛЬНЫЕ КОМПОНЕНТЫ ИНТЕГРАЦИЙ ==================== */

.integration-connector {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
  padding: var(--size-3) var(--size-4) !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  cursor: pointer !important;
  transition: all 0.3s ease !important;
  margin: var(--size-2) 0 !important;
}

.integration-connector:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  border-color: color-mix(in oklch, var(--accent-primary), transparent 60%) !important;
  transform: translateX(4px) !important;
}

.integration-status-indicator {
  width: 8px !important;
  height: 8px !important;
  border-radius: 50% !important;
  flex-shrink: 0 !important;
}

.integration-connected {
  background: var(--semantic-success) !important;
  animation: status-pulse 2s ease-in-out infinite !important;
}

.integration-disconnected {
  background: var(--semantic-error) !important;
}

.integration-connecting {
  background: var(--semantic-warning) !important;
  animation: status-pulse 1s ease-in-out infinite !important;
}

@keyframes status-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* ==================== СИСТЕМА ОШИБОК И ВОССТАНОВЛЕНИЯ ==================== */

.integration-error-panel {
  background: color-mix(in oklch, var(--semantic-error), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-error), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.integration-recovery-options {
  display: flex !important;
  gap: var(--size-3) !important;
  margin-top: var(--size-3) !important;
}

.recovery-button {
  padding: var(--size-2) var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  border: 1px solid currentColor !important;
  background: transparent !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
  font-size: var(--font-size-sm) !important;
}

.recovery-retry {
  color: var(--semantic-warning) !important;
}

.recovery-retry:hover {
  background: color-mix(in oklch, var(--semantic-warning), transparent 90%) !important;
}

.recovery-disable {
  color: var(--semantic-error) !important;
}

.recovery-disable:hover {
  background: color-mix(in oklch, var(--semantic-error), transparent 90%) !important;
}

/* ==================== СИСТЕМА ЛОГИРОВАНИЯ И МОНИТОРИНГА ==================== */

.integration-logs-panel {
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  max-height: 300px !important;
  overflow-y: auto !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-xs) !important;
}

.log-entry {
  padding: var(--size-2) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  display: flex !important;
  gap: var(--size-3) !important;
}

.log-entry:last-child {
  border-bottom: none !important;
}

.log-timestamp {
  color: var(--text-muted) !important;
  flex-shrink: 0 !important;
}

.log-level-info { color: var(--semantic-info) !important; }
.log-level-warning { color: var(--semantic-warning) !important; }
.log-level-error { color: var(--semantic-error) !important; }

/* ==========================================================================
   КОНЕЦ УНИВЕРСАЛЬНОЙ СИСТЕМЫ ВНЕШНИХ ИНТЕГРАЦИЙ
   ========================================================================== */
   
   /* ==========================================================================
   УНИВЕРСАЛЬНАЯ СИСТЕМА РАСШИРЯЕМОСТИ DARK NEBULA
   Версия: 2.1.0
   ========================================================================== */

/* ==================== СИСТЕМА РАСШИРЯЕМОСТИ И АРХИТЕКТУРА ПЛАГИНОВ ==================== */

:root {
  /* Уровни расширяемости */
  --extensibility-level: 'advanced' !important; /* basic | standard | advanced | expert */
  --extensibility-api-version: '2.1.0' !important;
  --extensibility-hooks-enabled: true !important;
  
  /* Система модулей */
  --module-system: 'css-variables' !important;
  --module-isolation: 'shadow-dom' !important;
  --module-hot-reload: true !important;
  
  /* Безопасность расширений */
  --extension-sandbox: true !important;
  --extension-permissions: 'strict' !important;
  --extension-version-check: true !important;
}

/* ==================== CSS CUSTOM PROPERTIES API ==================== */

/* Публичный API для кастомизации */
:root {
  /* Цветовая система API */
  --dn-api-color-primary: var(--accent-primary) !important;
  --dn-api-color-secondary: var(--accent-secondary) !important;
  --dn-api-color-background: var(--background-primary) !important;
  --dn-api-color-text: var(--text-normal) !important;
  
  /* Типографика API */
  --dn-api-font-family: var(--font-family-sans) !important;
  --dn-api-font-size: var(--font-size-base) !important;
  --dn-api-line-height: var(--line-height-normal) !important;
  
  /* Размеры и spacing API */
  --dn-api-spacing-unit: var(--size-4) !important;
  --dn-api-border-radius: var(--radius-md) !important;
  --dn-api-shadow: var(--shadow-md) !important;
  
  /* Анимации API */
  --dn-api-duration: var(--animation-duration-normal) !important;
  --dn-api-easing: var(--ease-in-out) !important;
}

/* ==================== СИСТЕМА HOOKS И СЛОТОВ ==================== */

/* Хуки для вставки кастомного контента */
.dn-hook-header::before,
.dn-hook-header::after {
  content: '' !important;
  display: block !important;
}

.dn-hook-sidebar::before,
.dn-hook-sidebar::after {
  content: '' !important;
  display: block !important;
}

.dn-hook-content::before,
.dn-hook-content::after {
  content: '' !important;
  display: block !important;
}

/* Слоты для динамического контента */
.dn-slot-custom-widget {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  min-height: 100px !important;
}

.dn-slot-custom-widget[data-slot-type="sidebar"] {
  margin: var(--size-2) 0 !important;
  padding: var(--size-3) !important;
}

.dn-slot-custom-widget[data-slot-type="header"] {
  margin: 0 !important;
  border-radius: 0 !important;
  border: none !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

/* ==================== СИСТЕМА МОДУЛЕЙ И КОМПОНЕНТОВ ==================== */

/* Базовый класс для всех модулей */
.dn-module {
  --module-version: '1.0' !important;
  --module-compatibility: '2.1.0' !important;
  position: relative !important;
}

/* Изоляция стилей модулей */
.dn-module-isolated {
  all: initial !important;
  contain: style layout !important;
}

.dn-module-isolated * {
  all: unset !important;
}

/* Система зависимостей модулей */
.dn-module-dependencies::before {
  content: '📦' !important;
  position: absolute !important;
  top: var(--size-2) !important;
  right: var(--size-2) !important;
  font-size: var(--font-size-sm) !important;
  opacity: 0.7 !important;
}

/* ==================== API ДЛЯ РАЗРАБОТЧИКОВ ПЛАГИНОВ ==================== */

/* JavaScript API визуализация */
.dn-api-endpoint {
  background: color-mix(in oklch, var(--accent-secondary), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-secondary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  font-family: var(--font-family-mono) !important;
}

.dn-api-method {
  display: inline-block !important;
  background: var(--accent-primary) !important;
  color: white !important;
  padding: var(--size-1) var(--size-2) !important;
  border-radius: var(--radius-sm) !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-bold) !important;
  margin-right: var(--size-2) !important;
}

.dn-api-route {
  color: var(--accent-primary) !important;
  font-weight: var(--font-weight-medium) !important;
}

/* Хуки для JavaScript */
.dn-js-hook {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 2px dashed color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  text-align: center !important;
  color: var(--text-muted) !important;
}

.dn-js-hook::before {
  content: '⚡ JavaScript Hook' !important;
  display: block !important;
  font-weight: var(--font-weight-bold) !important;
  color: var(--accent-primary) !important;
  margin-bottom: var(--size-2) !important;
}

/* ==================== СИСТЕМА ТЕМ И СКИНОВ ==================== */

/* Базовый класс для кастомных тем */
.dn-theme-base {
  /* Сброс всех наследуемых свойств */
  all: initial !important;
  
  /* Наследование только CSS переменных */
  --theme-inherit-variables: true !important;
  
  /* Изоляция темы */
  contain: style !important;
}

/* Система наследования тем */
.dn-theme-child {
  --theme-parent: 'dark-nebula' !important;
  --theme-override: false !important;
}

.dn-theme-child[data-override="true"] {
  --theme-override: true !important;
}

/* Миксины для тем */
.dn-theme-mixin {
  /* Миксин для стеклянного эффекта */
  --mixin-glass: {
    background: color-mix(in oklch, var(--background-primary), transparent 20%) !important;
    backdrop-filter: blur(20px) saturate(180%) !important;
    border: 1px solid color-mix(in oklch, white, transparent 80%) !important;
  };
  
  /* Миксин для неонового свечения */
  --mixin-neon: {
    text-shadow: 
      0 0 5px currentColor,
      0 0 10px currentColor,
      0 0 15px currentColor !important;
    box-shadow: 
      0 0 5px color-mix(in oklch, currentColor, transparent 70%),
      0 0 10px color-mix(in oklch, currentColor, transparent 80%),
      0 0 15px color-mix(in oklch, currentColor, transparent 90%) !important;
  };
}

/* ==================== СИСТЕМА КОМПОНЕНТОВ И WIDGETS ==================== */

/* Базовый класс для виджетов */
.dn-widget {
  --widget-version: '1.0' !important;
  --widget-category: 'utility' !important;
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  position: relative !important;
}

.dn-widget-header {
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
  margin-bottom: var(--size-3) !important;
  padding-bottom: var(--size-2) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
}

.dn-widget-controls {
  display: flex !important;
  gap: var(--size-2) !important;
}

.dn-widget-settings {
  position: absolute !important;
  top: var(--size-3) !important;
  right: var(--size-3) !important;
  opacity: 0 !important;
  transition: opacity 0.2s ease !important;
}

.dn-widget:hover .dn-widget-settings {
  opacity: 1 !important;
}

/* Система реестра компонентов */
.dn-component-registry {
  background: color-mix(in oklch, var(--accent-tertiary), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-tertiary), transparent 80%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.dn-registry-item {
  display: flex !important;
  align-items: center !important;
  gap: var(--size-3) !important;
  padding: var(--size-3) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-tertiary), transparent 95%) !important;
  cursor: pointer !important;
  transition: all 0.2s ease !important;
}

.dn-registry-item:hover {
  background: color-mix(in oklch, var(--accent-tertiary), transparent 95%) !important;
  transform: translateX(4px) !important;
}

.dn-registry-item:last-child {
  border-bottom: none !important;
}

/* ==================== СИСТЕМА СОБЫТИЙ И КОММУНИКАЦИИ ==================== */

/* Визуализация системы событий */
.dn-event-bus {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-sm) !important;
}

.dn-event-listener {
  background: color-mix(in oklch, var(--accent-secondary), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-secondary), transparent 80%) !important;
  border-radius: var(--radius-md) !important;
  padding: var(--size-3) !important;
  margin: var(--size-2) 0 !important;
}

.dn-event-emitter {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  border-radius: var(--radius-md) !important;
  padding: var(--size-3) !important;
  margin: var(--size-2) 0 !important;
}

/* ==================== СИСТЕМА НАСТРОЕК И КОНФИГУРАЦИИ ==================== */

.dn-config-panel {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.dn-config-section {
  margin-bottom: var(--size-6) !important;
  padding-bottom: var(--size-4) !important;
  border-bottom: 1px solid color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

.dn-config-section:last-child {
  margin-bottom: 0 !important;
  padding-bottom: 0 !important;
  border-bottom: none !important;
}

.dn-config-option {
  display: flex !important;
  align-items: center !important;
  justify-content: between !important;
  padding: var(--size-3) !important;
  border-radius: var(--radius-md) !important;
  transition: all 0.2s ease !important;
  cursor: pointer !important;
}

.dn-config-option:hover {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
}

/* ==================== СИСТЕМА ОБНОВЛЕНИЙ И МИГРАЦИИ ==================== */

.dn-update-manager {
  background: color-mix(in oklch, var(--semantic-info), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-info), transparent 80%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.dn-update-available {
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-warning), transparent 80%) !important;
}

.dn-migration-wizard {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 80%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-6) !important;
  margin: var(--size-4) 0 !important;
  text-align: center !important;
}

.dn-migration-step {
  display: none !important;
}

.dn-migration-step.active {
  display: block !important;
  animation: migration-fade-in 0.5s ease !important;
}

@keyframes migration-fade-in {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ==================== СИСТЕМА ДОКУМЕНТАЦИИ ДЛЯ РАЗРАБОТЧИКОВ ==================== */

.dn-dev-docs {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.dn-code-example {
  background: color-mix(in oklch, var(--background-primary), black 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-sm) !important;
  overflow-x: auto !important;
}

.dn-api-reference {
  background: color-mix(in oklch, var(--accent-secondary), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-secondary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

/* ==================== МАСШТАБИРУЕМАЯ АРХИТЕКТУРА РАСШИРЯЕМОСТИ ==================== */

/* CSS Layers для организации расширяемости */
@layer extensibility-base, extensibility-api, extensibility-modules, extensibility-themes, extensibility-tools;

@layer extensibility-base {
  .extensibility-foundation {
    --extensibility-api-version: '2.1' !important;
    --extensibility-future-proof: true !important;
  }
}

@layer extensibility-api {
  .extensibility-api-system {
    /* Система API и хуков */
  }
}

@layer extensibility-modules {
  .extensibility-module-system {
    /* Система модулей и компонентов */
  }
}

@layer extensibility-themes {
  .extensibility-theme-system {
    /* Система тем и скинов */
  }
}

@layer extensibility-tools {
  .extensibility-tool-system {
    /* Инструменты для разработчиков */
  }
}

/* Container Queries для адаптивных расширений */
@container (max-width: 768px) {
  .extensibility-mobile-optimized {
    --extensibility-level: 'standard' !important;
  }
  
  .dn-widget {
    margin: var(--size-2) 0 !important;
    padding: var(--size-3) !important;
  }
}

/* Система feature flags для экспериментальных функций */
.dn-feature-flag {
  --feature-enabled: false !important;
  --feature-stage: 'experimental' !important;
}

.dn-feature-flag[data-enabled="true"] {
  --feature-enabled: true !important;
}

.dn-feature-flag[data-stage="beta"] {
  --feature-stage: 'beta' !important;
  border: 2px dashed color-mix(in oklch, var(--semantic-warning), transparent 70%) !important;
}

.dn-feature-flag[data-stage="stable"] {
  --feature-stage: 'stable' !important;
  border: 2px solid color-mix(in oklch, var(--semantic-success), transparent 70%) !important;
}

/* ==================== СИСТЕМА БЕЗОПАСНОСТИ И САНДБОКСИНГ ==================== */

.dn-sandboxed-environment {
  /* Изоляция ненадежного кода */
  all: initial !important;
  contain: style layout paint !important;
  isolation: isolate !important;
}

.dn-permission-gate {
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-warning), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  text-align: center !important;
}

.dn-permission-request {
  display: flex !important;
  gap: var(--size-3) !important;
  justify-content: center !important;
  margin-top: var(--size-3) !important;
}

/* ==================== СИСТЕМА ТЕСТИРОВАНИЯ И ОТЛАДКИ ==================== */

.dn-testing-environment {
  background: color-mix(in oklch, var(--accent-primary), transparent 95%) !important;
  border: 2px dashed color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.dn-debug-panel {
  position: fixed !important;
  bottom: var(--size-4) !important;
  left: var(--size-4) !important;
  background: color-mix(in oklch, var(--background-primary), black 10%) !important;
  backdrop-filter: blur(40px) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  z-index: 10000 !important;
  font-family: var(--font-family-mono) !important;
  font-size: var(--font-size-xs) !important;
}

.dn-performance-monitor {
  background: color-mix(in oklch, var(--semantic-info), transparent 95%) !important;
  border: 1px solid color-mix(in oklch, var(--semantic-info), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-3) !important;
  margin: var(--size-2) 0 !important;
}

/* ==================== СИСТЕМА СООБЩЕСТВА И КОНТРИБЬЮШЕНА ==================== */

.dn-community-hub {
  background: color-mix(in oklch, var(--accent-tertiary), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-tertiary), transparent 80%) !important;
  border-radius: var(--radius-xl) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.dn-contribution-guide {
  background: color-mix(in oklch, var(--accent-secondary), transparent 98%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-secondary), transparent 80%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.dn-marketplace {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
  gap: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
}

.dn-marketplace-item {
  background: color-mix(in oklch, var(--background-primary), transparent 5%) !important;
  border: 1px solid color-mix(in oklch, var(--accent-primary), transparent 90%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  cursor: pointer !important;
  transition: all 0.3s ease !important;
}

.dn-marketplace-item:hover {
  transform: translateY(-2px) !important;
  box-shadow: var(--shadow-lg) !important;
  border-color: color-mix(in oklch, var(--accent-primary), transparent 70%) !important;
}

/* ==================== СИСТЕМА МИГРАЦИИ И ОБРАТНОЙ СОВМЕСТИМОСТИ ==================== */

.dn-compatibility-layer {
  /* Слой для обратной совместимости */
  --legacy-support: true !important;
}

.dn-deprecation-warning {
  background: color-mix(in oklch, var(--semantic-warning), transparent 95%) !important;
  border: 2px dashed color-mix(in oklch, var(--semantic-warning), transparent 70%) !important;
  border-radius: var(--radius-lg) !important;
  padding: var(--size-4) !important;
  margin: var(--size-4) 0 !important;
  position: relative !important;
}

.dn-deprecation-warning::before {
  content: '⚠️ DEPRECATED' !important;
  position: absolute !important;
  top: -10px !important;
  left: var(--size-4) !important;
  background: var(--background-primary) !important;
  padding: 0 var(--size-2) !important;
  font-size: var(--font-size-xs) !important;
  font-weight: var(--font-weight-bold) !important;
  color: var(--semantic-warning) !important;
}

/* ==========================================================================
   КОНЕЦ УНИВЕРСАЛЬНОЙ СИСТЕМЫ РАСШИРЯЕМОСТИ
   ========================================================================== */
